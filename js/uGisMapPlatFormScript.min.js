/*
 Author: LeeJaeHyuk
 Date: 2019-01-14 
*/

!function(e,t){"use strict";if(void 0===t)return alert("need for jQuery !");e._$=t,e.ugmp={version:"1.4.0",toc:{},util:{},layer:{},control:{},service:{},manager:{},baseMap:{},animation:{}};var i=location.href.indexOf(location.host)+location.host.length,a=location.href.substring(i,location.href.indexOf("/",i+1));e.ugmp.contextPath=a,_$(document).ready(function(){e.uGisMapPlatForm=e.ugmp})}(window,jQuery),function(){"use strict";ol.layer.Vector.prototype.animateFeature=function(e){var a=this,o=e,r=0,t=a.on("postcompose",function(e){if(a.isStop)return o.extent=!1,void(e.frameState.animate=!0);var t=a.animations[r],i=t.getProperties();e.frameState.extent;o.vectorContext=e.vectorContext,o.frameState=e.frameState,o.extent||(o.extent=e.frameState.extent,o.start=e.frameState.time-o.interval,o.context=e.context);o.time=e.frameState.time-o.start,o.elapsed=o.time/i.duration,1<o.elapsed&&(o.elapsed=1);t.animate(o)||(o.nowNB++,o.nowNB<i.repeat?o.extent=!1:r<a.animations.length-1&&(r++,o.nowNB=0,o.extent=!1));e.frameState.animate=!0});return a.changed&&a.changed(),t}}(),function(){"use strict";ol.interaction.MouseWheelZoom.handleEvent=function(e){var t=this.getMap(),i=e.type;if(i!==ol.events.EventType.WHEEL&&i!==ol.events.EventType.MOUSEWHEEL)return!0;if(t.scrollCallBack){if(t.scrollCallBack.getAltKeyOnly()&&!ol.events.condition.altKeyOnly(e))return t.scrollCallBack.run(),!0;t.scrollCallBack.clear(),e.originalEvent.preventDefault(),e.originalEvent.stopPropagation()}else e.originalEvent.preventDefault(),e.originalEvent.stopPropagation();var a,o=e.map,r=e.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=e.coordinate),e.type==ol.events.EventType.WHEEL?(a=r.deltaY,ol.has.FIREFOX&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(a/=ol.has.DEVICE_PIXEL_RATIO),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(a*=40)):e.type==ol.events.EventType.MOUSEWHEEL&&(a=-r.wheelDeltaY,ol.has.SAFARI&&(a/=3)),0===a)return!1;var n=Date.now();if(void 0===this.startTime_&&(this.startTime_=n),(!this.mode_||n-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(a)<4?ol.interaction.MouseWheelZoom.Mode_.TRACKPAD:ol.interaction.MouseWheelZoom.Mode_.WHEEL),this.mode_===ol.interaction.MouseWheelZoom.Mode_.TRACKPAD){var s=o.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):s.setHint(ol.ViewHint.INTERACTING,1),this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);var u=s.getResolution()*Math.pow(2,a/this.trackpadDeltaPerZoom_),l=s.getMinResolution(),p=s.getMaxResolution(),c=0;if(u<l?(u=Math.max(u,l/this.trackpadZoomBuffer_),c=1):p<u&&(u=Math.min(u,p*this.trackpadZoomBuffer_),c=-1),this.lastAnchor_){var g=s.calculateCenterZoom(u,this.lastAnchor_);s.setCenter(s.constrainCenter(g))}return s.setResolution(u),0===c&&this.constrainResolution_&&s.animate({resolution:s.constrainResolution(u,0<a?-1:1),easing:ol.easing.easeOut,anchor:this.lastAnchor_,duration:this.duration_}),0<c?s.animate({resolution:l,easing:ol.easing.easeOut,anchor:this.lastAnchor_,duration:500}):c<0&&s.animate({resolution:p,easing:ol.easing.easeOut,anchor:this.lastAnchor_,duration:500}),this.startTime_=n,!1}this.delta_+=a;var m=Math.max(this.timeout_-(n-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,o),m),!1}}(),function(){"use strict";ugmp.uGisCapture=function(i){var a=this;return this.useSync=null,this.origin_ugMap=null,this.appendElement=null,this.origin_ugBaseMap=null,this.origin_ugLayerManager=null,this.captureDivId=null,this.captureMapId=null,this.readyFunction=null,this.captureUgMap=null,this.captureElement=null,this.arrDeferred_ready=null,this.captureBaseMapId=null,this.captureUgBaseMap=null,this.captureLayerManager=null,function(){var e=i||{};if(a.useSync="boolean"==typeof e.useSync&&e.useSync,a.origin_ugMap=void 0!==e.uGisMap?e.uGisMap:void 0,a.origin_ugBaseMap=void 0!==e.uGisBaseMap?e.uGisBaseMap:void 0,a.origin_ugLayerManager=void 0!==e.uGisLayerManager?e.uGisLayerManager:void 0,a.appendElement=void 0!==e.appendElement?e.appendElement:void 0,a.readyFunction="function"==typeof e.readyFunction?e.readyFunction:void 0,a.arrDeferred_ready=[],!a.origin_ugMap)return ugmp.uGisConfig.alert_Error("uGisMap undefined");var t=ugmp.util.uGisUtil.generateUUID().split("-")[0];a.captureDivId="captureDiv_"+t,a.captureMapId="captureMap_"+t,a.captureBaseMapId="captureBaseMap_"+t,a._createCaptureElement(),a._setCaptureMap(),a._setCaptureLayer()}(),{_this:a,ready:a.ready,destroy:a.destroy,runCapture:a.runCapture,getUgisMap:a.getUgisMap,getUgisBaseMap:a.getUgisBaseMap,setBaseMapVisible:a.setBaseMapVisible,getUgisLayerManager:a.getUgisLayerManager,baseMapVisibleToggle:a.baseMapVisibleToggle}},ugmp.uGisCapture.prototype._createCaptureElement=function(){var e=this._this||this,t=document.createElement("div");t.id=e.captureDivId,t.style.width="100%",t.style.height="100%",t.style.position="relative";var i=document.createElement("div");i.id=e.captureBaseMapId,ugmp.util.uGisUtil.setCssTextStyle(i,"z-Index","20"),ugmp.util.uGisUtil.setCssTextStyle(i,"width","100%"),ugmp.util.uGisUtil.setCssTextStyle(i,"height","100%"),ugmp.util.uGisUtil.setCssTextStyle(i,"position","absolute !important"),ugmp.util.uGisUtil.setCssTextStyle(i,"background-color","rgb(255, 255, 254)");var a=document.createElement("div");a.id=e.captureMapId,ugmp.util.uGisUtil.setCssTextStyle(a,"z-Index","30"),ugmp.util.uGisUtil.setCssTextStyle(a,"width","100%"),ugmp.util.uGisUtil.setCssTextStyle(a,"height","100%"),ugmp.util.uGisUtil.setCssTextStyle(a,"position","absolute !important"),t.appendChild(i),t.appendChild(a),e.captureElement=t},ugmp.uGisCapture.prototype._setCaptureMap=function(){var e=this._this||this;e.appendElement.insertBefore(e.captureElement,e.appendElement.firstChild),e.captureUgMap=new ugmp.uGisMap({target:document.getElementById(e.captureMapId),crs:e.origin_ugMap.getCRS(),center:e.origin_ugMap.getMap().getView().getCenter(),useMaxExtent:!0,useAltKeyOnly:!1});for(var t=e.captureUgMap.getMap().getControls().getArray(),i=t.length-1;0<=i;i--)e.captureUgMap.getMap().removeControl(t[i]);if(e.origin_ugBaseMap){e.captureUgBaseMap=new ugmp.baseMap.uGisBaseMap({target:e.captureBaseMapId,uGisMap:e.captureUgMap,baseMapKey:"osm_none"}),e.captureUgBaseMap.setVisible(e.origin_ugBaseMap.getVisible()),e.captureUgBaseMap.setOpacity(e.origin_ugBaseMap.getOpacity());var a=e.origin_ugBaseMap.getSelectedBaseMap();if("custom"!==a.split("_")[0]){if(e.captureUgBaseMap.changeBaseMap(a),"osm_gray"===a){var o=e.captureUgBaseMap._this.baseMapList.osm.object,r=o._this.apiMap.getLayers().getArray();for(var i in r)o._this.apiMap.removeLayer(r[i]);o._this.apiMap.addLayer(new ol.layer.Tile({source:new ol.source.XYZ({url:ugmp.uGisConfig.getProxy()+"http://{a-c}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png"})}))}}else{var n=e.origin_ugBaseMap._this.baseMapList[a].object,s=n._this.uWMTSLayer,u=new ugmp.layer.uGisWMTSLayer({useProxy:!0,serviceURL:s.getServiceURL(),layer:s.layer,version:s.version,matrixSet:s.matrixSet,wmtsCapabilities:s.getWmtsCapabilities(),originExtent:s.getOriginExtent()}),l="custom_"+ugmp.util.uGisUtil.generateUUID().split("-")[0],p=new ugmp.baseMap.uGisBaseMapCustom({baseMapKey:l,uWMTSLayer:u,capabilities:s.getWmtsCapabilities(),isWorld:n.isWorlds(),isFactor:n.isFactors()});p._this.resolutions=n._this.resolutions,p._this.mapTypes[l].maxZoom=n._this.mapTypes[a].maxZoom,p._this.mapTypes[l].resolutions=n._this.mapTypes[a].resolutions,e.captureUgBaseMap.addBaseMapType(l,p),e.captureUgBaseMap.changeBaseMap(l)}}var c=e.origin_ugMap.getMap().getView();e.captureUgMap.getMap().setView(new ol.View({zoom:c.getZoom(),center:c.getCenter(),extent:ol.proj.get(e.origin_ugMap.getCRS()).getExtent(),projection:c.getProjection().getCode(),maxZoom:c.getMaxZoom(),minZoom:c.getMinZoom(),resolution:c.getResolution(),resolutions:c.getResolutions(),rotation:c.getRotation()})),e.useSync&&e.captureUgMap.getMap().setView(c)},ugmp.uGisCapture.prototype._setCaptureLayer=function(){var u=this._this||this,l=[];if(u.origin_ugLayerManager)u.captureLayerManager=new ugmp.manager.uGisLayerManager({uGisMap:u.captureUgMap,useMinMaxZoom:!0}),l=u.origin_ugLayerManager.getAll(!0);else{var e=u.origin_ugMap.getLayers();for(var t in e)l.push({uGisLayer:e[t]})}!function t(i){if(i<l.length){var a,e=l[i].uGisLayer;if(!e.getVisible())return t(i+1),!1;"WMS"===e.getLayerType()?a=u._addUGisLayer().addWMSLayer:"WFS"===e.getLayerType()?a=u._addUGisLayer().addWFSLayer:"Vector"===e.getLayerType()?a=u._addUGisLayer().addVectorLayer:"Cluster"===e.getLayerType()?a=u._addUGisLayer().addClusterLayer:"WMTS"===e.getLayerType()?a=u._addUGisLayer().addWMTSLayer:"WCS"===e.getLayerType()&&(a=u._addUGisLayer().addWCSLayer);var o=a.create(e);if(o.setLayerVisible(e.getVisible()),o.getOlLayer().setZIndex(e.getOlLayer().getZIndex()),o.getOlLayer().setOpacity(e.getOlLayer().getOpacity()),u.captureLayerManager&&(o.setMinZoom(e.getMinZoom()),o.setMaxZoom(e.getMaxZoom())),u.origin_ugLayerManager&&"WMS"===o.getLayerType()){var r=l[i].uGisToc,n=new ugmp.service.uGisGetCapabilitiesWMS({useProxy:!0,version:"1.3.0",serviceURL:o.getServiceURL(),dataViewId:u.captureUgMap.getDataViewId()});u.arrDeferred_ready.push(n),n.then(function(){var e=a.toc({key:r.tocKey,addLayer:o,saveData:JSON.parse(JSON.stringify(r.getSaveData())),capabilities:n.data});u.captureLayerManager&&u.captureLayerManager.add({uGisToc:e,uGisLayer:o})})}else u.captureLayerManager&&u.captureLayerManager.add({uGisLayer:o});var s=a.add(o);u.arrDeferred_ready.push(s),s.then(function(e){t(i+1)})}else u.ready()}(0)},ugmp.uGisCapture.prototype._addUGisLayer=function(e){var t=this._this||this;return{addWFSLayer:{create:function(e){return new ugmp.layer.uGisWFSLayer({useProxy:!0,serviceURL:e.getServiceURL(),layerName:e.layerName,srsName:t.captureUgMap.getCRS(),maxFeatures:e._this.maxFeatures,dataViewId:t.captureUgMap.getDataViewId()})},add:function(e){return t.captureUgMap.addWFSLayer({uWFSLayer:e,useExtent:!1})}},addWCSLayer:{create:function(e){return new ugmp.layer.uGisWCSLayer({useProxy:!0,version:e.version,identifier:e.identifier,projection:e.projection,serviceURL:e.getServiceURL(),boundingBox:e.getBoundingBox()})},add:function(e){return t.captureUgMap.addWCSLayer({uWCSLayer:e,useExtent:!1,extent:null})}},addWMSLayer:{create:function(e){return new ugmp.layer.uGisWMSLayer({useProxy:!0,singleTile:e._this.singleTile,serviceURL:e.getServiceURL(),ogcParams:e.getOlLayer().getSource().getParams()})},add:function(e){return t.captureUgMap.addWMSLayer({uWMSLayer:e,useExtent:!1,extent:null,resolution:null})},toc:function(e){return new ugmp.toc.uGisWMSToc({tocKey:e.key,uGisMap:t.captureUgMap,uGisLayer:e.addLayer,loadData:e.saveData,capabilities:e.capabilities})}},addWMTSLayer:{create:function(e){return new ugmp.layer.uGisWMTSLayer({useProxy:!0,serviceURL:e.getServiceURL(),layer:e.layer,version:e.version,matrixSet:e.matrixSet,wmtsCapabilities:e.getWmtsCapabilities(),originExtent:e.getOriginExtent()})},add:function(e){return t.captureUgMap.addWMTSLayer({uWMTSLayer:e,useExtent:!1,extent:null})}},addVectorLayer:{create:function(e){var t=e._this.style;return"function"!=typeof t&&void 0!==t&&(t=ugmp.util.uGisUtil.cloneStyle(t)),new ugmp.layer.uGisVectorLayer({style:t,features:e.getOlLayer().getSource().getFeatures(),srsName:e._this.srsName})},add:function(e){return t.captureUgMap.addVectorLayer({uVectorLayer:e,useExtent:!1})}},addClusterLayer:{create:function(e){var t=e._this.style;return new ugmp.layer.uGisClusterLayer({style:"function"==typeof t?t:ugmp.util.uGisUtil.cloneStyle(t),features:ugmp.util.uGisUtil.cloneFeatures(e._this.features),distance:e._this.distance,useAnimation:e._this.useAnimation})},add:function(e){return t.captureUgMap.addClusterLayer({uClusterLayer:e,useExtent:!1})}}}},ugmp.uGisCapture.prototype.getUgisMap=function(){return(this._this||this).captureUgMap},ugmp.uGisCapture.prototype.getUgisBaseMap=function(){return(this._this||this).captureUgBaseMap},ugmp.uGisCapture.prototype.getUgisLayerManager=function(){return(this._this||this).captureLayerManager},ugmp.uGisCapture.prototype.setBaseMapVisible=function(e){var t=this._this||this;t.captureUgBaseMap&&t.captureUgBaseMap.setVisible(e)},ugmp.uGisCapture.prototype.baseMapVisibleToggle=function(){var e=this._this||this;e.captureUgBaseMap&&e.captureUgBaseMap.visibleToggle()},ugmp.uGisCapture.prototype.runCapture=function(t){var e=this._this||this;if("function"!=typeof t)return!1;var i="none";e.origin_ugBaseMap&&(i=e.origin_ugBaseMap.getSelectedBaseMap().split("_")[0]),-1<i.indexOf("google")?html2canvas_google(document.getElementById(e.captureDivId),{useCORS:!0,proxy:ugmp.uGisConfig.getProxy(),onrendered:function(e){t.call(this,e)}}):html2canvas_etc(document.getElementById(e.captureDivId),{useCORS:!0,proxy:ugmp.uGisConfig.getProxy()}).then(function(e){t.call(this,e)})},ugmp.uGisCapture.prototype.destroy=function(e){var t=this._this||this;_$("#"+t.captureBaseMapId).empty(),t.captureUgMap.getMap().setTarget(null)},ugmp.uGisCapture.prototype.ready=function(){var e=this._this||this;$.when.apply($,e.arrDeferred_ready).then(function(){e.readyFunction&&e.readyFunction.call(e),e.captureUgMap.refresh()})}}(),function(){"use strict";ugmp.uGisConfig=function(e){return this.proxy=null,this.mobile=null,this.loading=null,this.browser=null,this.progress=null,this.flag_Proxy=null,this.alert_Error=null,this.loadingImg=null,this.useLoading=null,this.useMapProxy=null,this.progressObj={},this._checkMobile(),this._checkBrowser(),{_this:this,init:this.init,isMobile:this.isMobile,getProxy:this.getProxy,loading:this.getLoading,isMapProxy:this.isMapProxy,getBrowser:this.getBrowser,alert_Error:this.getAlert_Error,addProgress:this.addProgress,resetLoading:this.resetLoading,isUseLoading:this.isUseLoading,getLoadingImg:this.getLoadingImg,addLoadEventListener:this.addLoadEventListener}},ugmp.uGisConfig.prototype.init=function(e){var t=this._this||this,i=e||{};if(void 0!==i.proxy&&"string"==typeof i.proxy?(t.proxy=i.proxy,t.flag_Proxy=!0):(t.proxy="",t.flag_Proxy=!1),void 0!==i.alert_Error&&"function"==typeof i.alert_Error?t.alert_Error=i.alert_Error:t.alert_Error=t._defaultAlert_Error,void 0!==i.loadingImg&&"string"==typeof i.loadingImg)t.loadingImg=i.loadingImg;else{ugmp.contextPath;t.loadingImg=t.defaultLoadingImg}t.useLoading=void 0===i.useLoading||i.useLoading,t.useMapProxy=void 0!==i.useMapProxy&&i.useMapProxy},ugmp.uGisConfig.prototype.isMobile=function(){return(this._this||this).mobile},ugmp.uGisConfig.prototype.isMapProxy=function(){return(this._this||this).useMapProxy},ugmp.uGisConfig.prototype.getBrowser=function(){return(this._this||this).browser},ugmp.uGisConfig.prototype.getProxy=function(){var e=this._this||this;return void 0!==e.flag_Proxy?e.proxy:""},ugmp.uGisConfig.prototype.getAlert_Error=function(e){(this._this||this).alert_Error(e)},ugmp.uGisConfig.prototype._defaultAlert_Error=function(e){alert(e)},ugmp.uGisConfig.prototype.isUseLoading=function(){return(this._this||this).useLoading},ugmp.uGisConfig.prototype.resetLoading=function(e){var t=this._this||this;t.progressObj[e]&&t.progressObj[e].reset()},ugmp.uGisConfig.prototype.getLoading=function(e,t){var i=this._this||this;t?i.progressObj[e]&&i.progressObj[e].addLoading():i.progressObj[e]&&i.progressObj[e].addLoaded()},ugmp.uGisConfig.prototype._Progress=function(e,t){var i=this;return this.key=null,this.loaded=null,this.loading=null,this.interval=null,this.timeOut=null,this.loadingFunc=null,i.key=e,i.loading=0,i.loaded=0,i.loadingFunc=t,this.addLoading=function(){0===i.loading&&(i.loadingFunc(!0),_$(document).trigger("loadChangeEvent_"+i.key,!1)),++i.loading,i.update()},this.addLoaded=function(){setTimeout(function(){++i.loaded,i.update()},100)},this.update=function(){i.loading===i.loaded?(i.loading=0,i.loaded=0,clearInterval(i.interval),i.timeOut=setTimeout(function(){i.loadingFunc(!1),$(document).trigger("loadChangeEvent_"+i.key,!0)},999)):clearTimeout(i.timeOut)},this.reset=function(){clearInterval(i.interval),i.interval=setInterval(i.update,1e3)},{reset:i.reset,addLoading:i.addLoading,addLoaded:i.addLoaded}},ugmp.uGisConfig.prototype._checkMobile=function(){var e=this._this||this;navigator.platform&&("win16|win32|win64|mac".indexOf(navigator.platform.toLowerCase())<0?e.mobile=!0:e.mobile=!1)},ugmp.uGisConfig.prototype._checkBrowser=function(){var e,t=this._this||this,i=navigator.appName,a=navigator.userAgent.toLowerCase();"Microsoft Internet Explorer"===i||-1<a.indexOf("trident")||-1<a.indexOf("edge/")?(e="ie","Microsoft Internet Explorer"===i?(a=/msie ([0-9]{1,}[\.0-9]{0,})/.exec(a),e+=parseInt(a[1])):-1<a.indexOf("trident")?e+=11:-1<a.indexOf("edge/")&&(e="edge")):-1<a.indexOf("safari")?e=-1<a.indexOf("opr")?"opera":-1<a.indexOf("chrome")?"chrome":"safari":-1<a.indexOf("firefox")&&(e="firefox"),t.browser=e},ugmp.uGisConfig.prototype.getLoadingImg=function(){var e=this._this||this;if(!e.loadingImg){var t=ugmp.contextPath+"/uGisMapPlatForm/images/icon_loading.gif";e.loadingImg=t}return e.loadingImg},ugmp.uGisConfig.prototype.addProgress=function(e,t){var i=this._this||this;i.progressObj[e]=new i._Progress(e,t)},ugmp.uGisConfig.prototype.addLoadEventListener=function(e,t){this._this;$(document).on("loadChangeEvent_"+e,t)},ugmp.uGisConfig=new ugmp.uGisConfig}(),function(){"use strict";ugmp.uGisHttp=function(){return{requestData:this.requestData}},ugmp.uGisHttp.prototype.requestData=function(e){var t=this,i=e||{};return this.isUseLoading=ugmp.uGisConfig.isUseLoading(),this.deferred=_$.Deferred(),this.url=void 0!==i.url?i.url:"",this.type=void 0!==i.type?i.type:"GET",this.data=void 0!==i.data?i.data:{},this.contentType=void 0!==i.contentType?i.contentType:"application/x-www-form-urlencoded; charset=UTF-8",this.dataType=void 0!==i.dataType?i.dataType:"XML",this.dataViewId=void 0!==i.dataViewId?i.dataViewId:"",_$.ajax({url:t.url,type:t.type,data:t.data,dataType:t.dataType,contentType:t.contentType,beforeSend:function(){t.isUseLoading&&ugmp.uGisConfig.loading(t.dataViewId,!0)},complete:function(){t.isUseLoading&&ugmp.uGisConfig.loading(t.dataViewId,!1)},success:function(e){t.deferred.resolve(e)},error:function(e){t.deferred.reject(e)}}),t.deferred.promise()},ugmp.uGisHttp=new ugmp.uGisHttp}(),function(){"use strict";ugmp.uGisMap=function(r){var n=this;return this.olMap=null,this.mapCRS=null,this.useAltKeyOnly=null,this.layers=null,this.dataViewId=null,this.loadingSrcDiv=null,function(){var e=r||{};n.layers=[],n.mapCRS=void 0!==e.crs?e.crs.toUpperCase():"EPSG:3857",n.useAltKeyOnly="boolean"==typeof e.useAltKeyOnly&&e.useAltKeyOnly;var t=e.center;Array.isArray(t)||(t=[0,0]);var i=e.useMaxExtent?ol.proj.get(n.mapCRS).getExtent():void 0,a=new ol.View({zoom:2,center:t,extent:i,projection:n.mapCRS});n.dataViewId=ol.getUid(a),n.olMap=new ol.Map({target:e.target,layers:[],renderer:"canvas",controls:n._createDefaultControls(),interactions:n._createDefaultInteractions(),view:a}),n._createScrollElement(),n._createLoadingElement(),n.olMap.on("change:view",function(){var e=n.olMap.getView().getProjection().getCode();n.mapCRS=e;for(var t=n.olMap.getOverlays().getArray(),i=t.length-1;0<=i;i--){var a=t[i].get("origin");if(a){var o=ol.proj.transform(a.position,a.projection,n.mapCRS);t[i].setPosition(o),t[i].set("CRS",n.mapCRS)}}ugmp.uGisConfig.resetLoading(n.dataViewId)});var o=e.target instanceof Element?e.target:"#"+e.target;_$(o).resize(function(){n.refresh()}),_$(window).resize(function(){n.refresh()}),console.log("####### uGisMap Init #######"),console.log("openLayers Map : "),console.log(n.olMap),console.log("Projection : "+n.mapCRS)}(),{_this:n,refresh:n.refresh,getCRS:n.getCRS,getMap:n.getMap,setExtent:n.setExtent,getLayers:n.getLayers,setAltKeyOnly:n.setAltKeyOnly,removeLayer:n.removeLayer,addWMSLayer:n.addWMSLayer,addWFSLayer:n.addWFSLayer,addWCSLayer:n.addWCSLayer,addWMTSLayer:n.addWMTSLayer,addVectorLayer:n.addVectorLayer,addClusterLayer:n.addClusterLayer,calculateScale:n.calculateScale,getDataViewId:n.getDataViewId,getScaleForZoom:n.getScaleForZoom,setLoadingVisible:n.setLoadingVisible,removeAllListener:n.removeAllListener,removeAllInteraction:n.removeAllInteraction,setActiveAllInteraction:n.setActiveAllInteraction}},ugmp.uGisMap.prototype._createScrollElement=function(){var e=this._this||this,t='.ol-viewport[data-view="'+e.dataViewId+'"]',i=document.querySelector(t),a=document.createElement("div");a.setAttribute("altText",""),a.style.top="0px",a.style.zIndex=2,a.style.opacity=0,a.style.width="100%",a.style.height="100%",a.style.position="absolute",a.style.pointerEvents="none",a.style.transitionDuration="1s",a.style.backgroundColor="rgba( 0, 0, 0, 0.5 )";var o=document.createElement("p");o.textContent="지도를 확대/축소하려면 Alt를 누른 채 스크롤하세요.",o.style.left="0px",o.style.right="0px",o.style.top="50%",o.style.color="white",o.style.fontSize="25px",o.style.margin="0 auto",o.style.textAlign="center",o.style.position="absolute",o.style.transform="translateY(-50%)",a.appendChild(o),i.insertBefore(a,i.firstChild),e.olMap.scrollCallBack=new function(e,t){var i=this;function a(){i.altElement.style.opacity=0,i.altElement.style.transitionDuration="0.8s"}return this.tId=null,this.altElement=null,this.getAltKeyOnly=null,o=e,r=t,i.altElement=o,i.getAltKeyOnly=r,this.run=function(){i.altElement.style.opacity=1,i.altElement.style.transitionDuration="0.3s",window.clearTimeout(i.tId),i.tId=window.setTimeout(function(){a()},1500)},this.clear=function(){window.clearTimeout(i.tId),a()},{run:i.run,clear:i.clear,getAltKeyOnly:i.getAltKeyOnly};var o,r}(a,function(){return e.useAltKeyOnly})},ugmp.uGisMap.prototype._createLoadingElement=function(){var t=this._this||this,e='.ol-viewport[data-view="'+t.dataViewId+'"]',i=document.querySelector(e),a=document.createElement("div");a.id="loadingDIV",a.style.zIndex=1,a.style.top="0px",a.style.left="0px",a.style.right="0px",a.style.bottom="0px",a.style.display="none",a.style.margin="auto",a.style.position="absolute",a.style.pointerEvents="none",t.loadingSrcDiv=new Image,t.loadingSrcDiv.src=ugmp.uGisConfig.getLoadingImg(),t.loadingSrcDiv.onload=function(e){a.style.width=e.target.width+"px",a.style.height=e.target.height+"px",a.appendChild(t.loadingSrcDiv),i.insertBefore(a,i.firstChild)},ugmp.uGisConfig.addProgress(t.dataViewId,function(e){a.style.display=e?"block":"none"})},ugmp.uGisMap.prototype._createDefaultInteractions=function(){var e=[new ol.interaction.DragRotate,new ol.interaction.DoubleClickZoom({duration:0}),new ol.interaction.PinchZoom({duration:0,constrainResolution:!0}),new ol.interaction.MouseWheelZoom({constrainResolution:!0,duration:0}),new ol.interaction.DragZoom({duration:0,condition:ol.events.condition.shiftKeyOnly}),new ol.interaction.DragPan({kinetic:!1})];for(var t in e)e[t].set("necessary",!0);return e},ugmp.uGisMap.prototype._createDefaultControls=function(){var e=[new ol.control.Attribution({collapsible:!1}),new ol.control.Rotate,new ol.control.Zoom({duration:0})];for(var t in e)e[t].set("necessary",!0);return e},ugmp.uGisMap.prototype.getMap=function(){return(this._this||this).olMap},ugmp.uGisMap.prototype.getCRS=function(){return(this._this||this).mapCRS},ugmp.uGisMap.prototype.setExtent=function(e){(this._this||this).olMap.getView().fit(e)},ugmp.uGisMap.prototype.getLayers=function(e){var t=this._this||this,i=[];if(t.layers&&e)for(var a in t.layers){var o=t.layers[a];o.getLayerType()===e&&i.push(o)}else i=t.layers;return i},ugmp.uGisMap.prototype.addWMSLayer=function(e){var i=this._this||this,t=e||{},a=void 0!==t.uWMSLayer?t.uWMSLayer:void 0,o=void 0!==t.useExtent&&t.useExtent,r=void 0!==t.extent?t.extent:void 0,n=void 0!==t.resolution?t.resolution:void 0,s=_$.Deferred();try{i.olMap.addLayer(a.getOlLayer()),i.layers.push(a);var u=a.getOlLayer().getSource();if(u.on(["imageloadstart","tileloadstart"],function(e){ugmp.uGisConfig.isUseLoading()&&ugmp.uGisConfig.loading(i.dataViewId,!0)}),u.on(["imageloadend","tileloadend"],function(){ugmp.uGisConfig.isUseLoading()&&ugmp.uGisConfig.loading(i.dataViewId,!1)}),u.on(["imageloaderror","tileloaderror"],function(){ugmp.uGisConfig.isUseLoading()&&ugmp.uGisConfig.loading(i.dataViewId,!1)}),o)if(Array.isArray(r)){for(var l in r)r[l]=parseFloat(r[l]);i.setExtent(r),n&&_olMap.getView().setResolution(n)}else{var p=new ugmp.service.uGisGetCapabilitiesWMS({useProxy:!0,version:"1.3.0",serviceURL:a.getServiceURL(),dataViewId:i.dataViewId});p.then(function(e){if(!e.state)return ugmp.uGisConfig.alert_Error(e.message),s.reject(e.message),s.promise();var t=ol.proj.transformExtent(p.data.serviceMetaData.maxExtent,p.data.serviceMetaData.crs,i.mapCRS);i.setExtent(t)}).fail(function(e){return ugmp.uGisConfig.alert_Error("Error : "+e),s.reject(!1),s.promise()})}s.resolve(!0)}catch(e){return ugmp.uGisConfig.alert_Error("Error : "+e),s.reject(!1),s.promise()}return s.promise()},ugmp.uGisMap.prototype.addWFSLayer=function(e){var i=this._this||this,t=e||{},a=void 0!==t.uWFSLayer?t.uWFSLayer:void 0,o=void 0!==t.useExtent&&t.useExtent,r=_$.Deferred();try{var n=a.getOlLayer();i.olMap.addLayer(n),i.layers.push(a),a.getFeatures(void 0,i.dataViewId).then(function(e){if(!e.state)return ugmp.uGisConfig.alert_Error(e.message),r.reject(e.message),r.promise();if(n.getSource().addFeatures(e.features),o){var t=ol.proj.transformExtent(n.getSource().getExtent(),a.srsName,i.mapCRS);i.setExtent(t)}r.resolve(!0)}).fail(function(e){return ugmp.uGisConfig.alert_Error("Error : "+e),r.reject(!1),r.promise()})}catch(e){return ugmp.uGisConfig.alert_Error("Error : "+e),r.reject(!1),r.promise()}return r.promise()},ugmp.uGisMap.prototype.addWCSLayer=function(e){var o=this._this||this,t=e||{},r=void 0!==t.uWCSLayer?t.uWCSLayer:void 0,i=void 0!==t.useExtent&&t.useExtent,n=(void 0!==t.extent&&t.extent,_$.Deferred());try{var s=r.getOlLayer();if(r.getBoundingBox()&&3<r.getBoundingBox().length){o.olMap.addLayer(s),o.layers.push(r),r.setMap(o.olMap,p),l(ol.proj.transformExtent(r.getBoundingBox(),"EPSG:4326",o.getCRS())),n.resolve(!0)}else{var u=new ugmp.service.uGisGetCapabilitiesWCS({useProxy:!0,version:r.version,serviceURL:r.getServiceURL(),dataViewId:o.dataViewId});u.then(function(e){if(!e.state)return ugmp.uGisConfig.alert_Error(e.message),o.deferred.reject(e.message),n.promise();var t=u.data.serviceMetaData.coverages;for(var i in t)if(t[i].Identifier===r.identifier){r.setBoundingBox(t[i].BBOX);break}if(o.olMap.addLayer(s),o.layers.push(r),r.setMap(o.olMap,p),a&&Array.isArray(a))l(a);else{var a=ol.proj.transformExtent(r.getBoundingBox(),"EPSG:4326",o.getCRS());l(a)}n.resolve(!0)})}n.resolve(!0)}catch(e){return ugmp.uGisConfig.alert_Error("Error : "+e),n.reject(!1),n.promise()}function l(e){if(i&&Array.isArray(e)){for(var t in e)e[t]=parseFloat(e[t]);o.setExtent(e)}}function p(e){ugmp.uGisConfig.isUseLoading()&&ugmp.uGisConfig.loading(o.dataViewId,e)}return n.promise()},ugmp.uGisMap.prototype.addWMTSLayer=function(e){var o=this._this||this,t=e||{},r=void 0!==t.uWMTSLayer?t.uWMTSLayer:void 0,i=void 0!==t.useExtent&&t.useExtent,n=(void 0!==t.extent&&t.extent,_$.Deferred());try{var s=r.getOlLayer();if(r.getWmtsCapabilities()&&r.getOriginExtent()){r.update(!0),o.olMap.addLayer(s),o.layers.push(r),l(ol.proj.transformExtent(r.getOriginExtent(),"EPSG:4326",o.getCRS())),p(),n.resolve(!0)}else{var u=new ugmp.service.uGisGetCapabilitiesWMTS({useProxy:!0,version:r.version,serviceURL:r.getServiceURL(),dataViewId:o.dataViewId});u.then(function(e){if(!e.state)return ugmp.uGisConfig.alert_Error(e.message),o.deferred.reject(e.message),n.promise();var t=u.data.olJson.Contents.Layer;for(var i in t)if(t[i].Identifier===r.layer){r.setOriginExtent(t[i].WGS84BoundingBox);break}if(r.setWmtsCapabilities(u.data),r.update(!0),o.olMap.addLayer(s),o.layers.push(r),a&&Array.isArray(a))l(a);else{var a=ol.proj.transformExtent(r.getOriginExtent(),"EPSG:4326",o.getCRS());l(a)}p(),n.resolve(!0)})}}catch(e){return ugmp.uGisConfig.alert_Error("Error : "+e),n.reject(!1),n.promise()}function l(e){if(i&&Array.isArray(e)){for(var t in e)e[t]=parseFloat(e[t]);o.setExtent(e)}}function p(){var e=r.getOlLayer().getSource();e.on("tileloadstart",function(e){ugmp.uGisConfig.isUseLoading()&&ugmp.uGisConfig.loading(o.dataViewId,!0)}),e.on("tileloadend",function(){ugmp.uGisConfig.isUseLoading()&&ugmp.uGisConfig.loading(o.dataViewId,!1)}),e.on("tileloaderror",function(){ugmp.uGisConfig.isUseLoading()&&ugmp.uGisConfig.loading(o.dataViewId,!1)})}return n.promise()},ugmp.uGisMap.prototype.addVectorLayer=function(e){var t=this._this||this,i=e||{},a=void 0!==i.uVectorLayer?i.uVectorLayer:void 0,o=void 0!==i.useExtent&&i.useExtent,r=_$.Deferred();try{var n=a.getOlLayer();if(t.olMap.addLayer(n),t.layers.push(a),o){var s=n.getSource().getExtent();if(s&&s[0]!==1/0){var u=ol.proj.transformExtent(n.getSource().getExtent(),a.srsName,t.mapCRS);t.setExtent(u)}}r.resolve(!0)}catch(e){return ugmp.uGisConfig.alert_Error("Error : "+e),r.reject(!1),r.promise()}return r.promise()},ugmp.uGisMap.prototype.addClusterLayer=function(e){var t=this._this||this,i=e||{},a=void 0!==i.uClusterLayer?i.uClusterLayer:void 0,o=_$.Deferred();try{var r=a.getOlLayer();t.olMap.addLayer(r),t.layers.push(a),o.resolve(!0)}catch(e){return ugmp.uGisConfig.alert_Error("Error : "+e),o.reject(!1),o.promise()}return o.promise()},ugmp.uGisMap.prototype.refresh=function(){var e=this._this||this;if(e.olMap){var t=e.olMap.getView();t.setCenter([t.getCenter()[0]+1e-4,t.getCenter()[1]]),window.setTimeout(function(){t.setCenter([t.getCenter()[0]-1e-4,t.getCenter()[1]])},1),e.olMap.updateSize()}},ugmp.uGisMap.prototype.removeLayer=function(e){for(var t=this._this||this,i=0;i<t.layers.length;i++){var a=t.layers[i];a.getLayerKey()===e&&(a.destroy(),t.olMap.removeLayer(a.getOlLayer()),t.layers.splice(i,1))}},ugmp.uGisMap.prototype.getResolutionFromScale=function(e){return e/(39.37*_self.olMap.getView().getProjection().getMetersPerUnit()*96)},ugmp.uGisMap.prototype.getScaleFromResolution=function(e){return e*(39.37*_self.olMap.getView().getProjection().getMetersPerUnit()*96)},ugmp.uGisMap.prototype.calculateScale=function(c){var g=this._this||this,m=null,y=null,d=null,h=null,f=264583e-9;function v(e,t){var i=n(e),a=n(t),o=a[0]-i[0],r=a[1]-i[1];return Math.sqrt(Math.pow(o,2)+Math.pow(r,2))}function n(e){var t=new Array(2);if(null===d||d===h)return t[0]=e[0],t[1]=e[1],t;try{var i=ol.proj.transform(e,d,h);return t[0]=i[0],t[1]=i[1],t}catch(e){}}return function(e){var t,i=c||{};d=g.mapCRS,h=void 0!==i.originCRS?i.originCRS:g.getCRS(),y=void 0!==i.extent?i.extent:g.olMap.getView().calculateExtent(g.olMap.getSize());var a,o,r,n,s=ol.extent.getWidth(y),u=ol.extent.getHeight(y),l=g.olMap.getSize()[0],p=g.olMap.getSize()[1];u/p<=s/l?(r=[y[0],y[1]],n=[y[2],y[1]],t=v(r,n),m=t/(l*f)):(a=[y[0],y[1]],o=[y[0],y[3]],t=v(a,o),m=t/(p*f))}(),m},ugmp.uGisMap.prototype.getScaleForZoom=function(e){var t=this._this||this,i=t.olMap.getView().getResolutionForZoom(e),a=[0,0,i*t.olMap.getSize()[0],i*t.olMap.getSize()[1]];return t.calculateScale({extent:a,originCRS:t.getCRS()})},ugmp.uGisMap.prototype.removeAllListener=function(e){for(var t=this._this||this,i=ol.events.getListeners(t.olMap,e),a=i.length-1;0<=a;a--)ol.Observable.unByKey(i[a])},ugmp.uGisMap.prototype.removeAllInteraction=function(){for(var e=this._this||this,t=e.olMap.getInteractions().getArray(),i=t.length-1;0<=i;i--)t[i].get("necessary")||e.olMap.removeInteraction(t[i])},ugmp.uGisMap.prototype.setActiveAllInteraction=function(e){for(var t=(this._this||this).olMap.getInteractions().getArray(),i=t.length-1;0<=i;i--)t[i].setActive(e)},ugmp.uGisMap.prototype.setAltKeyOnly=function(e){var t=this._this||this;t.useAltKeyOnly!==e&&(t.useAltKeyOnly=e)},ugmp.uGisMap.prototype.setLoadingVisible=function(e){var t=this._this||this;t.loadingSrcDiv.style.display=e?"block":"none"},ugmp.uGisMap.prototype.getDataViewId=function(){return(this._this||this).dataViewId}}(),function(){"use strict";ugmp.uGisPopup=function(r){var n=this;return this.uGisMap=null,this.closeCallBack=null,this.content=null,this.removed=null,this.container=null,function(e){var t=r||{},i=void 0!==t.content?t.content:"",a=void 0!==t.position?t.position:void 0,o="boolean"==typeof t.show&&t.show;if(n.removed=!1,n.uGisMap=void 0!==t.uGisMap?t.uGisMap:void 0,n.closeCallBack="function"==typeof t.closeCallBack?t.closeCallBack:void 0,!n.uGisMap)return ugmp.uGisConfig.alert_Error("uGisMap undefined");n._init(a,i,o)}(),{_this:n,hide:n.hide,show:n.show,remove:n.remove,setContent:n.setContent,setPosition:n.setPosition}},ugmp.uGisPopup.prototype=Object.create(ol.Overlay.prototype),ugmp.uGisPopup.prototype.constructor=ugmp.uGisPopup,ugmp.uGisPopup.prototype._init=function(e,t,i){var a=this._this||this,o=document.createElement("div");o.className="ol-popup-header";var r=document.createElement("a");r.className="ol-popup-closer",r.href="#",r.addEventListener("click",function(e){a.container.style.display="none",r.blur(),a.closeCallBack&&a.closeCallBack(),e.preventDefault()},!1),o.appendChild(r),a.container=document.createElement("div"),a.container.className="ol-popup",a.container.style.transitionDuration="0.5s",a.container.addEventListener("mouseover",function(e){this.style.zIndex=1},!1),a.container.addEventListener("mouseout",function(e){this.style.zIndex=""},!1),a.container.appendChild(o),a.content=document.createElement("div"),a.content.className="ol-popup-content",a.container.appendChild(a.content),ol.Overlay.call(a,{insertFirst:!1,element:a.container,stopEvent:!0}),a.setContent(t),a.setPosition(e),a.uGisMap.getMap().addOverlay(a),i?a._panIntoCenter():a.container.style.display="none"},ugmp.uGisPopup.prototype._panIntoCenter=function(){var e=this._this||this;e.uGisMap.getMap().getView().animate({center:e.getPosition(),duration:500})},ugmp.uGisPopup.prototype._panIntoView=function(){var e=this._this||this;if(!e.getPosition())return!1;var t=e.uGisMap.getMap(),i=t.getSize(),a=e.getElement().clientWidth+20,o=e.getElement().clientHeight+20,r=a-60,n=e.getOffset(),s=t.getPixelFromCoordinate(e.getPosition()),u=s[0]-60,l=i[0]-(s[0]+r),p=s[1]-o+n[1],c=i[1]-(s[1]+20)-n[1],g=t.getView().getCenter(),m=t.getPixelFromCoordinate(g);l<0?m[0]-=l:u<0&&(m[0]+=u),p<0?m[1]+=p:c<0&&(m[1]-=c),t.getView().animate({center:t.getCoordinateFromPixel(m),duration:500})},ugmp.uGisPopup.prototype.show=function(e){var t=this._this||this;if(t.removed)return!1;t.container.style.display="block";var i=t.content;window.setTimeout(function(){i.scrollTop=0},100),e?t._panIntoCenter():t._panIntoView()},ugmp.uGisPopup.prototype.hide=function(){var e=this._this||this;if(e.removed)return!1;e.container.style.display="none",e.closeCallBack&&e.closeCallBack()},ugmp.uGisPopup.prototype.setContent=function(e){var t=this._this||this;"string"==typeof e&&(t.content.innerHTML=e)},ugmp.uGisPopup.prototype.setPosition=function(e,t){var i=this._this||this;i.set("origin",{position:e,projection:i.uGisMap.getCRS()}),ol.Overlay.prototype.setPosition.call(i,e),t&&i.show(!0)},ugmp.uGisPopup.prototype.remove=function(){var e=this._this||this;e.hide(),e.removed=!0,e.uGisMap.getMap().removeOverlay(e)}}(),function(){"use strict";ugmp.util.uGisGeoSpatialUtil=function(){return{toRadians:this.toRadians,toDegrees:this.toDegrees,getGeomCenter:this.getGeomCenter,getLargestPolygon:this.getLargestPolygon,getLargestLineString:this.getLargestLineString,lineToArcTransForm:this.lineToArcTransForm,getRadianBtwPoints:this.getRadianBtwPoints,getDegreeBtwPoints:this.getDegreeBtwPoints,getDistanceBtwPotins:this.getDistanceBtwPotins}},ugmp.util.uGisGeoSpatialUtil.prototype.toRadians=function(e){return e/180*Math.PI},ugmp.util.uGisGeoSpatialUtil.prototype.toDegrees=function(e){return 180*e/Math.PI},ugmp.util.uGisGeoSpatialUtil.prototype.getRadianBtwPoints=function(e,t){var i=e[0],a=e[1],o=t[0],r=t[1];return Math.atan2(r-a,o-i)},ugmp.util.uGisGeoSpatialUtil.prototype.getDegreeBtwPoints=function(e,t){var i=this.getRadianBtwPoints(e,t);return this.toDegrees(i)},ugmp.util.uGisGeoSpatialUtil.prototype.getDistanceBtwPotins=function(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))},ugmp.util.uGisGeoSpatialUtil.prototype.lineToArcTransForm=function(e,r){var T=this,C=[],w=[];return function(){for(var e=r.slice(),t=0;t<e.length;t++){var i=e[t].getGeometry();if(i)if(i instanceof ol.geom.LineString)w.push(new ol.Feature({geometry:i}));else if(i instanceof ol.geom.MultiLineString)for(var a=i.getLineStrings(),o=0;o<a.length;o++)w.push(new ol.Feature({geometry:a[o]}))}!function(){for(var e=0;e<w.length;e++){for(var t=[],i=w[e].getGeometry().getCoordinates(),a=0;a<i.length-1;a++){var o=i[a],r=i[a+1],n=T.getDistanceBtwPotins(o,r),s=(g=r,m=n/5,void 0,y=(c=o)[0],d=c[1],h=g[0],f=g[1],v=y+(h-y)/5*3,M=d+(f-d)/5*3,b=(G=h-y)<0?-1:1,(S=f-d)<0?-1:1,L=Math.atan(S/G),_=b*Math.cos(L),x=b*Math.sin(L),[v-m*x,M+m*_]),u={type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[o,s,r]}},l=turf.bezier(u,3e3,1.5);t=t.concat(l.geometry.coordinates)}var p=new ol.Feature({geometry:new ol.geom.LineString(t)});C.push(p)}var c,g,m,y,d,h,f,v,M,G,S,b,L,_,x}()}(),C},ugmp.util.uGisGeoSpatialUtil.prototype.getLargestLineString=function(e){return!(!e||e.getType()!==ol.geom.GeometryType.MULTI_LINE_STRING)&&e.getLineStrings().reduce(function(e,t){return e.getLength()>t.getLength()?e:t})},ugmp.util.uGisGeoSpatialUtil.prototype.getLargestPolygon=function(e){return!(!e||e.getType()!==ol.geom.GeometryType.MULTI_POLYGON)&&e.getPolygons().reduce(function(e,t){return e.getArea()>t.getArea()?e:t})},ugmp.util.uGisGeoSpatialUtil.prototype.getGeomCenter=function(e){if(!e||!e instanceof ol.geom.Geometry)return!1;var t=[],i=e;switch(i.getType()){case ol.geom.GeometryType.POINT:case ol.geom.GeometryType.MULTI_POINT:t=i.getFlatCoordinates();break;case ol.geom.GeometryType.CIRCLE:t=i.getCenter();break;case ol.geom.GeometryType.LINE_STRING:t=i.getFlatMidpoint();break;case ol.geom.GeometryType.MULTI_LINE_STRING:t=this.getLargestLineString(i).getFlatMidpoint();break;case ol.geom.GeometryType.POLYGON:t=i.getFlatInteriorPoint();break;case ol.geom.GeometryType.MULTI_POLYGON:t=this.getLargestPolygon(i).getFlatInteriorPoint()}return t},ugmp.util.uGisGeoSpatialUtil=new ugmp.util.uGisGeoSpatialUtil}(),function(){"use strict";ugmp.util.uGisUtil=function(){return{isXMLDoc:this.isXMLDoc,xmlToJson:this.xmlToJson,objectMerge:this.objectMerge,cloneStyle:this.cloneStyle,cloneFeature:this.cloneFeature,cloneFeatures:this.cloneFeatures,cloneGeometry:this.cloneGeometry,generateUUID:this.generateUUID,appendParams:this.appendParams,setCssTextStyle:this.setCssTextStyle,numberWithCommas:this.numberWithCommas}},ugmp.util.uGisUtil.prototype.numberWithCommas=function(e){if(!e)return 0;var t=e.toString().split(".");return t[0].replace(/\B(?=(\d{3})+(?!\d))/g,",")+(t[1]?"."+t[1]:"")},ugmp.util.uGisUtil.prototype.xmlToJson=function(e){var t={};if(1==e.nodeType){if(0<e.attributes.length){t["@attributes"]={};for(var i=0;i<e.attributes.length;i++){var a=e.attributes.item(i);t["@attributes"][a.nodeName]=a.nodeValue}}}else 3==e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes())for(var o=0;o<e.childNodes.length;o++){var r=e.childNodes.item(o),n=r.nodeName;if(void 0===t[n])t[n]=this.xmlToJson(r);else{if(void 0===t[n].push){var s=t[n];t[n]=[],t[n].push(s)}t[n].push(this.xmlToJson(r))}}return t},ugmp.util.uGisUtil.prototype.isXMLDoc=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},ugmp.util.uGisUtil.prototype.appendParams=function(e,t){var i=[];Object.keys(t).forEach(function(e){null!==t[e]&&void 0!==t[e]&&i.push(e+"="+encodeURIComponent(t[e]))});var a=i.join("&");return(e=-1===(e=e.replace(/[?&]$/,"")).indexOf("?")?e+"?":e+"&")+a},ugmp.util.uGisUtil.prototype.generateUUID=function(){var i=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(i+16*Math.random())%16|0;return i=Math.floor(i/16),("x"==e?t:3&t|8).toString(16)})},ugmp.util.uGisUtil.prototype.objectMerge=function(){var e,t,i,a,o,r,n=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof n&&(l=n,n=arguments[s]||{},s++),"object"==typeof n||jQuery.isFunction(n)||(n={}),s===u&&(n=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)i=n[t],n!==(a=e[t])&&(l&&a&&(jQuery.isPlainObject(a)||(o=Array.isArray(a)))?(o?(o=!1,r=i&&Array.isArray(i)?i:[]):r=i&&jQuery.isPlainObject(i)?i:{},n[t]=jQuery.extend(l,r,a)):void 0!==a&&(n[t]=a));return n},ugmp.util.uGisUtil.prototype.setCssTextStyle=function(e,t,i){var a,o=e.style.cssText.match(new RegExp("(?:[;\\s]|^)("+t.replace("-","\\-")+"\\s*:(.*?)(;|$))"));o?(a=o.index+o[0].indexOf(o[1]),e.style.cssText=e.style.cssText.substring(0,a)+t+": "+i+";"+e.style.cssText.substring(a+o[1].length)):e.style.cssText+=" "+t+": "+i+";"},ugmp.util.uGisUtil.prototype.cloneGeometry=function(e){return ol.geom[e.getType()].prototype.clone.call(e)},ugmp.util.uGisUtil.prototype.cloneFeature=function(e){var t=new ol.Feature(e.getProperties());t.setGeometryName(e.getGeometryName());var i=e.getGeometry();i&&t.setGeometry(this.cloneGeometry(i));var a=e.getStyle();return a&&t.setStyle(a),t},ugmp.util.uGisUtil.prototype.cloneFeatures=function(e){if(!Array.isArray(e))return!1;var t=[];for(var i in e)t.push(this.cloneFeature(e[i]));return t},ugmp.util.uGisUtil.prototype.cloneStyle=function(e){var t=e.getGeometry();return t&&t.clone&&(t=this.cloneGeometry(t)),new ol.style.Style({geometry:t,fill:e.getFill()?e.getFill().clone():void 0,image:e.getImage()?e.getImage().clone():void 0,stroke:e.getStroke()?e.getStroke().clone():void 0,text:e.getText()?e.getText().clone():void 0,zIndex:e.getZIndex()})},ugmp.util.uGisUtil=new ugmp.util.uGisUtil}(),function(){"use strict";ol.format.filter.dwithin=function(e,t,i,a,o){function r(e,t,i,a,o){ol.format.filter.Spatial.call(this,"DWithin",e,t,i),this.distance=a,this.units=o||"m"}function n(e,t,i){i[i.length-1].srsName=t.srsName,ol.format.WFS.writeOgcPropertyName_(e,t.geometryName),ol.format.GML3.prototype.writeGeometryElement(e,t.geometry,i);var a=ol.xml.createElementNS("http://www.opengis.net/ogc","Distance");a.setAttribute("units",t.units),ol.format.XSD.writeStringTextNode(a,t.distance+""),e.appendChild(a)}return ol.format.filter.DWithin=r,ol.inherits(ol.format.filter.DWithin,ol.format.filter.Spatial),ol.format.WFS.GETFEATURE_SERIALIZERS_["http://www.opengis.net/ogc"].DWithin=ol.xml.makeChildAppender(n),new ol.format.filter.DWithin(e,t,i,a,o)}}(),function(){"use strict";ugmp.service.uGisDescribeFeatureType=function(e){var t,i=this;return this.version=null,this.useProxy=null,this.typeName=null,this.serviceURL=null,this.dataViewId=null,this.promise=null,t=e||{},i.version=void 0!==t.version?t.version:"1.1.0",i.useProxy=void 0===t.useProxy||t.useProxy,i.typeName=void 0!==t.typeName?t.typeName:"",i.dataViewId=void 0!==t.dataViewId?t.dataViewId:"",i.serviceURL="string"==typeof t.serviceURL?t.serviceURL:"",i._callAjax(),i.promise},ugmp.service.uGisDescribeFeatureType.prototype._getAttribute=function(){return{SERVICE:"WFS",VERSION:this.version,REQUEST:"DescribeFeatureType",TYPENAME:this.typeName}},ugmp.service.uGisDescribeFeatureType.prototype._callAjax=function(){var o=this;o.promise=_$.Deferred();var e=ugmp.util.uGisUtil.appendParams(o.serviceURL,o._getAttribute());o.useProxy&&(e=ugmp.uGisConfig.getProxy()+e),new ugmp.uGisHttp.requestData({url:e,type:"GET",loading:!0,contentType:"",dataType:"XML",dataViewId:o.dataViewId}).then(function(e){var t={state:!1,message:void 0,data:{xmlJson:void 0,document:e,serviceMetaData:void 0}};try{var i=ugmp.util.uGisUtil.xmlToJson(e);if("ogc:ServiceExceptionReport"===e.childNodes[0].nodeName||"ServiceExceptionReport"===e.childNodes[0].nodeName){var a=i["ogc:ServiceExceptionReport"]["ogc:ServiceException"]["#text"];t.state=!1,t.message="ServiceExceptionReport : \n"+a}else if("ows:ExceptionReport"===e.childNodes[0].nodeName||"ExceptionReport"===e.childNodes[0].nodeName){a=i["ows:ExceptionReport"]["ows:Exception"]["ows:ExceptionText"]["#text"];t.state=!1,t.message="ExceptionReport : \n"+a}else t.state=!0,t.data.xmlJson=i,t.data.serviceMetaData=o._getServiceMetaData(i);o.promise.resolveData=t,o.promise.resolve(t)}catch(e){o.promise.reject(e)}},function(e){o.promise.reject(e)})},ugmp.service.uGisDescribeFeatureType.prototype._getServiceMetaData=function(e){var t={},i=!1,a="the_geom",o=e["xsd:schema"]["xsd:complexType"]["xsd:complexContent"]["xsd:extension"]["xsd:sequence"]["xsd:element"];for(var r in o){var n=o[r]["@attributes"].name,s=o[r]["@attributes"].type;i||"gml"!==s.split(":")[0]?t[n]=s.split(":")[1]:(i=!0,a=n)}return{sequence:t,geometryName:a}}}(),function(){"use strict";ugmp.service.uGisGetFeature=function(a){var o=this;return this.filter=null,this.srsName=null,this.useProxy=null,this.serviceURL=null,this.typeName=null,this.maxFeatures=null,this.outputFormat=null,this.dataViewId=null,this.deferred=null,function(){var e=a||{};o.deferred=_$.Deferred(),o.filter=void 0!==e.filter?e.filter:void 0,o.useProxy=void 0===e.useProxy||e.useProxy,o.serviceURL=void 0!==e.serviceURL?e.serviceURL:"",o.srsName=void 0!==e.srsName?e.srsName:"EPSG:3857",o.typeName=void 0!==e.typeName?e.typeName:[],o.maxFeatures=void 0!==e.maxFeatures?e.maxFeatures:1e3,o.outputFormat=void 0!==e.outputFormat?e.outputFormat:"text/xml; subtype=gml/3.1.1",o.dataViewId=void 0!==e.dataViewId?e.dataViewId:"";var t=(new ol.format.WFS).writeGetFeature({filter:o.filter,srsName:o.srsName,featureTypes:[o.typeName],maxFeatures:o.maxFeatures,outputFormat:o.outputFormat}),i=o.serviceURL;o.useProxy&&(i=ugmp.uGisConfig.getProxy()+i),new ugmp.uGisHttp.requestData({url:i,dataType:"",type:"POST",contentType:"text/xml",dataViewId:o.dataViewId,data:(new XMLSerializer).serializeToString(t)}).then(function(e){var t={state:!1,message:null,features:null,typeName:o.typeName};try{if(ugmp.util.uGisUtil.isXMLDoc(e)){var i=ugmp.util.uGisUtil.xmlToJson(e);if("ogc:ServiceExceptionReport"===e.childNodes[0].nodeName||"ServiceExceptionReport"===e.childNodes[0].nodeName){var a=i["ogc:ServiceExceptionReport"]["ogc:ServiceException"]["#text"];t.state=!1,t.message="ServiceExceptionReport : <br>"+a}else if("ows:ExceptionReport"===e.childNodes[0].nodeName||"ExceptionReport"===e.childNodes[0].nodeName){a=i["ows:ExceptionReport"]["ows:Exception"]["ows:ExceptionText"]["#text"];t.state=!1,t.message="ExceptionReport : <br>"+a}else t.state=!0,t.features=(new ol.format.WFS).readFeatures(e)}else t.state=!0,t.features=(new ol.format.GeoJSON).readFeatures(e);o.deferred.resolve(t)}catch(e){o.deferred.reject(e)}}).fail(function(e){o.deferred.reject(e)})}(),o.deferred.promise()}}(),function(){"use strict";ugmp.service.uGisGetCapabilitiesDefault=function(e){var t,i=this;return this.service=null,this.version=null,this.useProxy=null,this.serviceURL=null,this.dataViewId=null,this.request=null,t=e||{},i.request="GetCapabilities",i.useProxy=void 0===t.useProxy||t.useProxy,i.service="string"==typeof t.service?t.service:"WMS",i.serviceURL="string"==typeof t.serviceURL?t.serviceURL:"",i._setVersion(t.version),i.dataViewId=void 0!==t.dataViewId?t.dataViewId:"",{getAttribute:i.getAttribute}},ugmp.service.uGisGetCapabilitiesDefault.prototype._setVersion=function(e){var t=this._this||this;if(e)t.version=e;else switch(t.service){case"WMS":t.version="1.3.0";break;case"WFS":t.version="1.1.0";break;case"WCS":t.version="1.1.1";break;case"WMTS":t.version="1.0.0";break;default:t.version="1.3.0"}},ugmp.service.uGisGetCapabilitiesDefault.prototype.getAttribute=function(){var e=this._this||this;return{SERVICE:e.service,VERSION:e.version,REQUEST:e.request}},ugmp.service.uGisGetCapabilitiesDefault.prototype.callAjax=function(){var e=this._this||this,o=_$.Deferred(),t=ugmp.util.uGisUtil.appendParams(e.serviceURL,e.getAttribute());return e.useProxy&&(t=ugmp.uGisConfig.getProxy()+t),new ugmp.uGisHttp.requestData({url:t,type:"GET",loading:!0,contentType:"",dataType:"XML",dataViewId:e.dataViewId}).then(function(e){var t={state:!1,message:null,xmlJson:null,document:e};try{var i=ugmp.util.uGisUtil.xmlToJson(e);if(t.xmlJson=i,"ogc:ServiceExceptionReport"===e.childNodes[0].nodeName||"ServiceExceptionReport"===e.childNodes[0].nodeName){var a=i["ogc:ServiceExceptionReport"]["ogc:ServiceException"]["#text"];t.state=!1,t.message="ServiceExceptionReport : <br>"+a}else if("ows:ExceptionReport"===e.childNodes[0].nodeName||"ExceptionReport"===e.childNodes[0].nodeName){a=i["ows:ExceptionReport"]["ows:Exception"]["ows:ExceptionText"]["#text"];t.state=!1,t.message="ExceptionReport : <br>"+a}else t.state=!0;o.resolve(t)}catch(e){o.reject(e)}}).fail(function(e){o.reject(e)}),o.promise()}}(),function(){"use strict";ugmp.service.uGisGetCapabilitiesWCS=function(e){var t,i=this;return this.promise=null,(t=e||{}).service="WCS",ugmp.service.uGisGetCapabilitiesDefault.call(i,t),i.promise=i.callAjax(),i.promise.then(function(e){(new ol.format.WMSCapabilities).read(e.document);var t={olJson:void 0,xmlJson:e.xmlJson,document:e.document,serviceMetaData:i.getServiceMetaDataWCS(e.xmlJson)};i.promise.data=t}),i.promise},ugmp.service.uGisGetCapabilitiesWCS.prototype=Object.create(ugmp.service.uGisGetCapabilitiesDefault.prototype),ugmp.service.uGisGetCapabilitiesWCS.prototype.constructor=ugmp.service.uGisGetCapabilitiesWCS,ugmp.service.uGisGetCapabilitiesWCS.prototype.getServiceMetaDataWCS=function(e){var t=e,i=t["wcs:Capabilities"]["@attributes"].version,a=t["wcs:Capabilities"]["ows:ServiceIdentification"]["ows:Title"];a=a?a["#text"]:"null";var o=t["wcs:Capabilities"]["ows:ServiceIdentification"]["ows:Abstract"];o=o?o["#text"]:"null";var r=t["wcs:Capabilities"]["ows:ServiceIdentification"]["ows:Fees"];r=r?r["#text"]:"null";var n=t["wcs:Capabilities"]["ows:ServiceIdentification"]["ows:AccessConstraints"];n=n?n["#text"]:"null";var s=[],u=t["wcs:Capabilities"]["ows:ServiceIdentification"]["ows:Keywords"];if(u)for(var l in u=u["ows:Keyword"])s.push(u[l]["#text"]);var p=t["wcs:Capabilities"]["ows:ServiceProvider"]["ows:ProviderName"];p=p?p["#text"]:"null";var c=t["wcs:Capabilities"]["ows:ServiceProvider"]["ows:ProviderSite"];c=c?c["#text"]:"null";var g=t["wcs:Capabilities"]["wcs:Contents"]["wcs:SupportedFormat"],m=[];for(var l in g)m.push(g[l]["#text"]);var y=t["wcs:Capabilities"]["wcs:Contents"]["wcs:CoverageSummary"];Array.isArray(y)||(y=[y]);var d=[];for(var l in y){var h=y[l]["ows:WGS84BoundingBox"];h=h?h["ows:LowerCorner"]["#text"]:y[l]["ows:BoundingBox"]["ows:LowerCorner"]["#text"];var f=y[l]["ows:WGS84BoundingBox"];f=f?f["ows:UpperCorner"]["#text"]:y[l]["ows:BoundingBox"]["ows:UpperCorner"]["#text"];var v,M=[];M[0]=parseFloat(h.split(" ")[0]),M[1]=parseFloat(h.split(" ")[1]),M[2]=parseFloat(f.split(" ")[0]),M[3]=parseFloat(f.split(" ")[1]),v="2.0.1"===i?(v=y[l]["wcs:CoverageId"])?v["#text"]:y[l].CoverageId["#text"]:(v=y[l]["wcs:Identifier"])?v["#text"]:y[l].Identifier["#text"],d.push({Identifier:v,BBOX:M})}return{crs:"EPSG:4326",fees:r,title:a,abstract:o,coverages:d,keywords:s,providerSite:c,providerName:p,accessconstraints:n,supportedFormats:m}}}(),function(){"use strict";ugmp.service.uGisGetCapabilitiesWFS=function(e){var t,i=this;return this.promise=null,(t=e||{}).service="WFS",ugmp.service.uGisGetCapabilitiesDefault.call(i,t),i.promise=i.callAjax(),i.promise.then(function(e){(new ol.format.WMSCapabilities).read(e.document);var t={xmlJson:e.xmlJson,document:e.document,serviceMetaData:i.getServiceMetaDataWFS(e.xmlJson)};i.promise.data=t}),i.promise},ugmp.service.uGisGetCapabilitiesWFS.prototype=Object.create(ugmp.service.uGisGetCapabilitiesDefault.prototype),ugmp.service.uGisGetCapabilitiesWFS.prototype.constructor=ugmp.service.uGisGetCapabilitiesWFS,ugmp.service.uGisGetCapabilitiesWFS.prototype.getServiceMetaDataWFS=function(e){var t=e,i=t["wfs:WFS_Capabilities"]["ows:ServiceIdentification"]["ows:Title"]["#text"],a=t["wfs:WFS_Capabilities"]["ows:ServiceIdentification"]["ows:Abstract"]["#text"],o=t["wfs:WFS_Capabilities"]["ows:ServiceIdentification"]["ows:Fees"]["#text"],r=t["wfs:WFS_Capabilities"]["ows:ServiceIdentification"]["ows:AccessConstraints"]["#text"],n="EPSG:4326",s=[],u=t["wfs:WFS_Capabilities"]["ows:ServiceIdentification"]["ows:Keywords"]["ows:Keyword"];for(var l in u)s.push(u[l]["#text"]);var p=t["wfs:WFS_Capabilities"]["ows:ServiceProvider"]["ows:ProviderName"],c=t["wfs:WFS_Capabilities"]["ows:ServiceProvider"]["ows:ProviderSite"];void 0!==p&&(p=p["#text"]),void 0!==c&&(c=c["#text"]);var g=t["wfs:WFS_Capabilities"].FeatureTypeList.FeatureType,m=[];if(Array.isArray(g))for(var l in n=g[0].DefaultSRS["#text"],g){var y={Title:g[l].Title["#text"],Name:g[l].Name["#text"]};m.push(y)}else{n=g.DefaultSRS["#text"];y={Title:g.Title["#text"],Name:g.Name["#text"]};m.push(y)}return{crs:n,fees:o,title:i,abstract:a,keywords:s,providerSite:c,providerName:p,accessconstraints:r,layers:m}}}(),function(){"use strict";ugmp.service.uGisGetCapabilitiesWMS=function(e){var t,a=this;return this.promise=null,(t=e||{}).service="WMS",ugmp.service.uGisGetCapabilitiesDefault.call(a,t),a.promise=a.callAjax(),a.promise.then(function(e){var t=(new ol.format.WMSCapabilities).read(e.document),i={olJson:t,xmlJson:e.xmlJson,document:e.document,serviceMetaData:a.getServiceMetaDataWMS(t)};a.promise.data=i}),a.promise},ugmp.service.uGisGetCapabilitiesWMS.prototype=Object.create(ugmp.service.uGisGetCapabilitiesDefault.prototype),ugmp.service.uGisGetCapabilitiesWMS.prototype.constructor=ugmp.service.uGisGetCapabilitiesWMS,ugmp.service.uGisGetCapabilitiesWMS.prototype.getServiceMetaDataWMS=function(e){var t=e,i=t.Service.Name,a=t.version,o="",r=t.Capability.Request.GetCapabilities.Format;for(var n in r)o+=r[n]+(r.length-1==n?"":", ");var s="",u=t.Capability.Request.GetMap.Format;for(var n in u)s+=u[n]+(u.length-1==n?"":", ");var l="",p=t.Capability.Request.GetFeatureInfo.Format;for(var n in p)l+=p[n]+(p.length-1==n?"":", ");var c="",g=t.Capability.Exception;for(var n in g)c+=g[n]+(g.length-1==n?"":", ");var m,y,d=t.Capability.Layer.EX_GeographicBoundingBox,h=t.Capability.Layer.BoundingBox[0].extent,f=t.Capability.Layer.BoundingBox[0].crs,v=t.Service.Title,M=t.Service.OnlineResource,G=t.Service.Abstract,S=t.Service.Fees,b=t.Service.AccessConstraints;return void 0!==t.Service.ContactInformation&&(m=t.Service.ContactInformation.ContactPersonPrimary.ContactPerson,y=t.Service.ContactInformation.ContactPersonPrimary.ContactOrganization),"CRS:84"!==f&&"EPSG:4326"!==f||(h=[-185.8007812499999,-46.07323062540835,472.67578125000006,65.94647177615741]),{crs:f,fees:S,title:v,WGS84:d,service:i,version:a,keywordList:t.Service.KeywordList,abstract:G,maxExtent:h,getMapFormat:s,contactPerson:m,onlineResource:M,exceptionFormat:c,accessConstraints:b,contactOrganization:y,getFeatureInfoFormat:l,getCapabilitiesFormat:o}}}(),function(){"use strict";ugmp.service.uGisGetCapabilitiesWMTS=function(e){var t,c=this;return this.promise=null,(t=e||{}).service="WMTS",ugmp.service.uGisGetCapabilitiesDefault.call(c,t),c.promise=c.callAjax(),c.promise.then(function(e){var t=(new ol.format.WMTSCapabilities).read(e.document),i=e.xmlJson,a=c.getServiceMetaDataWMTS(t),o=i.Capabilities.Contents.Layer.Style;if(void 0!==o){var r=o["ows:LegendURL"];void 0!==r&&(r=r["ows:OnlineResource"]["@attributes"]["xlink:href"],a.legendURL=r)}var n=i.Capabilities["ows:ServiceIdentification"];if(void 0!==n&&(n["ows:Abstract"]&&(a.abstract=n["ows:Abstract"]["#text"]),n["ows:AccessConstraints"]&&(a.accessconstraints=n["ows:AccessConstraints"]["#text"]),n["ows:Fees"]&&(a.fees=n["ows:Fees"]["#text"]),n["ows:Keywords"])){var s=n["ows:Keywords"]["ows:Keyword"],u=[];if(void 0!==s)if(Array.isArray(s))for(var l in s)u.push(s[l]["#text"]);else u.push(s["#text"]);a.keywords=u}var p={olJson:t,xmlJson:e.xmlJson,document:e.document,serviceMetaData:a};c.promise.data=p}),c.promise},ugmp.service.uGisGetCapabilitiesWMTS.prototype=Object.create(ugmp.service.uGisGetCapabilitiesDefault.prototype),ugmp.service.uGisGetCapabilitiesWMTS.prototype.constructor=ugmp.service.uGisGetCapabilitiesWMTS,ugmp.service.uGisGetCapabilitiesWMTS.prototype.getServiceMetaDataWMTS=function(e){var t=e,i=t.Contents.TileMatrixSet;i=Array.isArray(i)?i[0].SupportedCRS:i.SupportedCRS;var a=t.ServiceIdentification.Title,o=t.ServiceIdentification.Abstract,r=t.ServiceIdentification.Fees,n=t.ServiceIdentification.AccessConstraints,s=[],u=t.ServiceIdentification.Keywords;if(void 0!==u)if(Array.isArray(u))for(var l in u)s.push(u[l].Keyword);else s.push(u.Keyword);return{crs:i,fees:r,title:a,abstract:o,keywords:s,accessconstraints:n}}}(),function(){"use strict";ugmp.layer.uGisLayerDefault=function(e){var t,i=this;return this.useProxy=null,this.serviceURL=null,this.useGetFeature=null,this.olLayer=null,this.layerKey=null,this.layerType=null,this.isUseLoading=null,this.tocVisibleFlag=null,this.layerVisibleFlag=null,this.scaleVisibleFlag=null,this.minZoom=null,this.maxZoom=null,t=e||{},i.isUseLoading=ugmp.uGisConfig.isUseLoading(),i.useProxy=void 0!==t.useProxy&&t.useProxy,i.serviceURL=void 0!==t.serviceURL?t.serviceURL:"",i.useGetFeature=void 0!==t.useGetFeature&&t.useGetFeature,i.layerKey=ugmp.util.uGisUtil.generateUUID(),i.layerType=void 0!==t.layerType?t.layerType:"",i.tocVisibleFlag=!0,i.layerVisibleFlag=!0,i.scaleVisibleFlag=!0,i.minZoom=0,i.maxZoom=21,{destroy:i.destroy,setMinZoom:i.setMinZoom,setMaxZoom:i.setMaxZoom,getMinZoom:i.getMinZoom,getMaxZoom:i.getMaxZoom,getVisible:i.getVisible,getOlLayer:i.getOlLayer,getLayerKey:i.getLayerKey,getLayerType:i.getLayerType,getServiceURL:i.getServiceURL,visibleToggle:i.visibleToggle,setTocVisible:i.setTocVisible,setScaleVisible:i.setScaleVisible,setLayerVisible:i.setLayerVisible,getUseGetFeature:i.getUseGetFeature,setUseGetFeature:i.setUseGetFeature}},ugmp.layer.uGisLayerDefault.prototype.getServiceURL=function(){return(this._this||this).serviceURL},ugmp.layer.uGisLayerDefault.prototype.getLayerKey=function(){return(this._this||this).layerKey},ugmp.layer.uGisLayerDefault.prototype.getLayerType=function(){return(this._this||this).layerType},ugmp.layer.uGisLayerDefault.prototype.getOlLayer=function(){return(this._this||this).olLayer},ugmp.layer.uGisLayerDefault.prototype.getVisible=function(){var e=this._this||this;return e.olLayer.getVisible()&&e.layerVisibleFlag&&e.tocVisibleFlag&&e.scaleVisibleFlag},ugmp.layer.uGisLayerDefault.prototype.setLayerVisible=function(e){var t=this._this||this;return"boolean"==typeof e&&(e?t.tocVisibleFlag&&t.scaleVisibleFlag&&t.olLayer.setVisible(!0):t.olLayer.setVisible(!1),t.layerVisibleFlag=e,{OpenLayersVisible:t.olLayer.getVisible(),LayerVisible:t.layerVisibleFlag,TocVisible:t.tocVisibleFlag,ScaleVisible:t.scaleVisibleFlag})},ugmp.layer.uGisLayerDefault.prototype.visibleToggle=function(){var e=this._this||this;e.setLayerVisible(!e.layerVisibleFlag)},ugmp.layer.uGisLayerDefault.prototype.setTocVisible=function(e){var t=this._this||this;return"boolean"==typeof e&&(e?t.layerVisibleFlag&&t.scaleVisibleFlag&&t.olLayer.setVisible(!0):t.olLayer.setVisible(!1),t.tocVisibleFlag=e,{OpenLayersVisible:t.olLayer.getVisible(),LayerVisible:t.layerVisibleFlag,TocVisible:t.tocVisibleFlag,ScaleVisible:t.scaleVisibleFlag})},ugmp.layer.uGisLayerDefault.prototype.setScaleVisible=function(e){var t=this._this||this;return"boolean"==typeof e&&(e?t.layerVisibleFlag&&t.tocVisibleFlag&&t.olLayer.setVisible(!0):t.olLayer.setVisible(!1),t.scaleVisibleFlag=e,{OpenLayersVisible:t.olLayer.getVisible(),LayerVisible:t.layerVisibleFlag,TocVisible:t.tocVisibleFlag,ScaleVisible:t.scaleVisibleFlag})},ugmp.layer.uGisLayerDefault.prototype.setMinZoom=function(e){var t=this._this||this;t.minZoom=e,t.olLayer.dispatchEvent({type:"change:zoom"})},ugmp.layer.uGisLayerDefault.prototype.setMaxZoom=function(e){var t=this._this||this;t.maxZoom=e,t.olLayer.dispatchEvent({type:"change:zoom"})},ugmp.layer.uGisLayerDefault.prototype.getMinZoom=function(){return(this._this||this).minZoom},ugmp.layer.uGisLayerDefault.prototype.getMaxZoom=function(){return(this._this||this).maxZoom},ugmp.layer.uGisLayerDefault.prototype.getUseGetFeature=function(){return(this._this||this).useGetFeature},ugmp.layer.uGisLayerDefault.prototype.setUseGetFeature=function(e){var t=this._this||this;t.useGetFeature="boolean"==typeof e&&e},ugmp.layer.uGisLayerDefault.prototype.destroy=function(){this._this}}(),function(){"use strict";ugmp.layer.uGisClusterLayer=function(e){var t,i=this,a=null;return this.style=null,this.distance=null,this.features=null,this.clusters=null,this.animation=null,this.oldcluster=null,this.useAnimation=null,(t=e||{}).layerType="Cluster",t.useGetFeature=!1,a=ugmp.layer.uGisLayerDefault.call(i,t),i.clusters=[],i.oldcluster=new ol.source.Vector,i.animation={start:!1},i.style=void 0!==t.style?t.style:i._defaultStyle,i.features=void 0!==t.features?t.features:[],i.distance="number"==typeof t.distance?t.distance:50,i.useAnimation="boolean"!=typeof t.useAnimation||t.useAnimation,i._init(),ugmp.util.uGisUtil.objectMerge(a,{_this:i,setDistance:i.setDistance,setUseAnimation:i.setUseAnimation})},ugmp.layer.uGisClusterLayer.prototype=Object.create(ugmp.layer.uGisLayerDefault.prototype),ugmp.layer.uGisClusterLayer.prototype.constructor=ugmp.layer.uGisClusterLayer,ugmp.layer.uGisClusterLayer.prototype._init=function(e){var o=this._this||this;o.olLayer=new ol.layer.Vector({source:new ol.source.Cluster({distance:o.distance,source:new ol.source.Vector({features:o.features})}),style:function(e,t){var i=e.get("features").length,a=r[i];a||(a="function"==typeof o.style?o.style.call(this,e,t):o.style,r[i]=a);return[a]}}),o.setUseAnimation(o.useAnimation),o.olLayer.set("animationMethod",ol.easing.easeOut),o.olLayer.getSource().on("change",o._saveCluster,o),o.olLayer.on("precompose",o._animate,o),o.olLayer.on("postcompose",o._postanimate,o);var r={}},ugmp.layer.uGisClusterLayer.prototype._defaultStyle=function(e,t){var i=e.get("features").length,a=25<i?"192,0,0":8<i?"255,128,0":"0,128,0",o=Math.max(8,Math.min(.75*i,20)),r=[0,r=2*Math.PI*o/6,r,r,r,r,r];return new ol.style.Style({image:new ol.style.Circle({radius:o,stroke:new ol.style.Stroke({color:"rgba("+a+",0.5)",width:15,lineDash:r,lineCap:"butt"}),fill:new ol.style.Fill({color:"rgba("+a+",1)"})}),text:new ol.style.Text({text:i.toString(),fill:new ol.style.Fill({color:"#fff"})})})},ugmp.layer.uGisClusterLayer.prototype.setUseAnimation=function(e){(this._this||this).olLayer.set("animationDuration",e?700:0)},ugmp.layer.uGisClusterLayer.prototype.setDistance=function(e){var t=(this._this||this).olLayer.getSource();ol.source.Cluster.prototype.setDistance.call(t,e)},ugmp.layer.uGisClusterLayer.prototype._saveCluster=function(){var e=this._this||this;if(e.oldcluster.clear(),e.olLayer.get("animationDuration")){var t=e.olLayer.getSource().getFeatures();t.length&&t[0].get("features")&&(e.oldcluster.addFeatures(e.clusters),e.clusters=t.slice(0),e.sourceChanged=!0)}},ugmp.layer.uGisClusterLayer.prototype._getClusterForFeature=function(e,t){this._this;for(var i=0;t[i];i++){var a=t[i].get("features");if(a&&a.length)for(var o,r=0;o=a[r];r++)if(e===o)return t[i]}return!1},ugmp.layer.uGisClusterLayer.prototype._stopAnimation=function(){var e=this._this||this;e.animation.start=!1,e.animation.cA=[],e.animation.cB=[]},ugmp.layer.uGisClusterLayer.prototype._animate=function(e){var t=this._this||this,i=t.olLayer.get("animationDuration");if(i){var a=e.frameState.viewState.resolution,o=t.animation,r=e.frameState.time;if(o.resolution!=a&&t.sourceChanged){var n=e.frameState.extent;o.resolution<a?(n=ol.extent.buffer(n,100*a),o.cA=t.oldcluster.getFeaturesInExtent(n),o.cB=t.olLayer.getSource().getFeaturesInExtent(n),o.revers=!1):(n=ol.extent.buffer(n,100*a),o.cA=t.olLayer.getSource().getFeaturesInExtent(n),o.cB=t.oldcluster.getFeaturesInExtent(n),o.revers=!0),o.clusters=[];for(var s,u=0;s=o.cA[u];u++){var l=s.get("features");if(l&&l.length)(y=t._getClusterForFeature(l[0],o.cB))&&o.clusters.push({f:s,pt:y.getGeometry().getCoordinates()})}if(o.resolution=a,t.sourceChanged=!1,!o.clusters.length||1e3<o.clusters.length)return void t._stopAnimation();r=o.start=(new Date).getTime()}if(o.start){var p=e.vectorContext,c=(r-o.start)/i;1<c&&(t._stopAnimation(),c=1),c=t.olLayer.get("animationMethod")(c);var g=t.olLayer.getStyle(),m="function"==typeof g?g:g.length?function(){return g}:function(){return[g]};e.context.save(),e.context.globalAlpha=t.olLayer.getOpacity();var y,d=e.frameState.pixelRatio;for(u=0;y=o.clusters[u];u++){var h=y.f.getGeometry().getCoordinates();o.revers?(h[0]=y.pt[0]+c*(h[0]-y.pt[0]),h[1]=y.pt[1]+c*(h[1]-y.pt[1])):(h[0]=h[0]+c*(y.pt[0]-h[0]),h[1]=h[1]+c*(y.pt[1]-h[1]));for(var f,v=m(y.f,a),M=new ol.geom.Point(h),G=0;f=v[G];G++){var S,b=!ol.Map.prototype.getFeaturesAtPixel&&f.getImage();b&&(S=b.getScale(),b.setScale(S*d)),p.setStyle?(p.setStyle(f),p.drawGeometry(M)):(p.setImageStyle(b),p.setTextStyle(f.getText()),p.drawPointGeometry(M)),b&&b.setScale(S)}}e.context.restore(),e.frameState.animate=!0,e.context.save(),e.context.beginPath(),e.context.rect(0,0,0,0),e.context.clip(),t.clip_=!0}}},ugmp.layer.uGisClusterLayer.prototype._postanimate=function(e){var t=this._this||this;t.clip_&&(e.context.restore(),t.clip_=!1)}}(),function(){"use strict";ugmp.layer.uGisVectorLayer=function(e){var t,i=this,a=null;return this.style=null,this.srsName=null,this.features=null,(t=e||{}).layerType="Vector",t.useGetFeature=!0,a=ugmp.layer.uGisLayerDefault.call(i,t),i.style=void 0!==t.style?t.style:void 0,i.srsName=void 0!==t.srsName?t.srsName:"EPSG:3857",i.features=void 0!==t.features?t.features:[],i.olLayer=new ol.layer.Vector({style:i.style,source:new ol.source.Vector({features:i.features})}),ugmp.util.uGisUtil.objectMerge(a,{_this:i,clear:i.clear,srsName:i.srsName,addFeatures:i.addFeatures})},ugmp.layer.uGisVectorLayer.prototype=Object.create(ugmp.layer.uGisLayerDefault.prototype),ugmp.layer.uGisVectorLayer.prototype.constructor=ugmp.layer.uGisVectorLayer,ugmp.layer.uGisVectorLayer.prototype.addFeatures=function(e){(this._this||this).olLayer.getSource().addFeatures(e)},ugmp.layer.uGisVectorLayer.prototype.clear=function(){(this._this||this).olLayer.getSource().clear()}}(),function(){"use strict";ugmp.layer.uGisWCSLayer=function(e){var t,i=this,a=null;return this.format=null,this.version=null,this.identifier=null,this.projection=null,this.coverageId=null,this.boundingBox=null,this.key_moveEnd=null,this.key_changeView=null,(t=e||{}).layerType="WCS",t.useGetFeature=!1,a=ugmp.layer.uGisLayerDefault.call(i,t),i.version=void 0!==t.version?t.version:"1.1.1",i.format=void 0!==t.format?t.format:"image/jpeg",i.identifier=void 0!==t.identifier?t.identifier:"",i.coverageId=void 0!==t.coverageId?t.coverageId:"",i.projection=void 0!==t.projection?t.projection:"EPSG:3857",i.boundingBox=i._setBoundingBox(t.boundingBox),i.olLayer=new ol.layer.Image({}),ugmp.util.uGisUtil.objectMerge(a,{_this:i,setMap:i.setMap,update:i._update,version:i.version,identifier:i.identifier,projection:i.projection,setBoundingBox:i._setBoundingBox,getBoundingBox:i.getBoundingBox})},ugmp.layer.uGisWCSLayer.prototype=Object.create(ugmp.layer.uGisLayerDefault.prototype),ugmp.layer.uGisWCSLayer.prototype.constructor=ugmp.layer.uGisWCSLayer,ugmp.layer.uGisWCSLayer.prototype._setBoundingBox=function(e){var t=this._this||this;return e&&3<e.length?(t.boundingBox=e.slice(),e[4]||t.boundingBox.push("EPSG:4326")):t.boundingBox=void 0,t.boundingBox},ugmp.layer.uGisWCSLayer.prototype.setMap=function(e,t){var i=this._this||this;e&&(ol.Observable.unByKey(i.key_moveEnd),i.key_moveEnd=e.on("moveend",function(){i._update(e.getView(),t)})),i.key_changeView=e.once("change:view",function(){i.setMap(e,t)})},ugmp.layer.uGisWCSLayer.prototype._update=function(e,a){var t=this._this||this,i=e.calculateExtent();if(i=ol.proj.transformExtent(i,e.getProjection(),"EPSG:4326"),!ol.extent.intersects(i,t.boundingBox))return!1;var o={SERVICE:"WCS",REQUEST:"GetCoverage",FORMAT:t.format,VERSION:t.version,IDENTIFIER:t.identifier,COVERAGEID:t.identifier,BOUNDINGBOX:t.boundingBox};"2.0.1"===t.version?delete o.IDENTIFIER:delete o.COVERAGEID;var r=turf.polygon([[[i[0],i[1]],[i[0],i[3]],[i[2],i[3]],[i[2],i[1]],[i[0],i[1]]]]),n=turf.polygon([[[t.boundingBox[0],t.boundingBox[1]],[t.boundingBox[0],t.boundingBox[3]],[t.boundingBox[2],t.boundingBox[3]],[t.boundingBox[2],t.boundingBox[1]],[t.boundingBox[0],t.boundingBox[1]]]]),s=turf.intersect(r,n).geometry.coordinates[0],u=[s[0][0],s[0][1],s[2][0],s[2][1]];o.BOUNDINGBOX=ol.proj.transformExtent(u,"EPSG:4326",e.getProjection()),o.BOUNDINGBOX.push(e.getProjection().getCode()),t.useProxy?t.getGetCoverageURL=ugmp.uGisConfig.getProxy()+ugmp.util.uGisUtil.appendParams(t.getServiceURL(),o):t.getGetCoverageURL=ugmp.util.uGisUtil.appendParams(t.getServiceURL(),o),a(!0),t.olLayer.setSource(new ol.source.ImageStatic({url:t.getGetCoverageURL,projection:e.getProjection(),imageExtent:o.BOUNDINGBOX,imageLoadFunction:function(e,t){var i=e.getImage();i.onload=function(){a(!1)},i.onerror=function(){a(!1)},i.src=t}}))},ugmp.layer.uGisWCSLayer.prototype.getBoundingBox=function(){return(this._this||this).boundingBox},ugmp.layer.uGisWCSLayer.prototype.setUseGetFeature=function(){(this._this||this).useGetFeature=!1},ugmp.layer.uGisWCSLayer.prototype.destroy=function(){var e=this._this||this;ol.Observable.unByKey(e.key_moveEnd),ol.Observable.unByKey(e.key_changeView)}}(),function(){"use strict";ugmp.layer.uGisWFSLayer=function(e){var t,i=this,a=null;return this.srsName=null,this.layerName=null,this.maxFeatures=null,this.dataViewId=null,(t=e||{}).layerType="WFS",t.useGetFeature=!0,a=ugmp.layer.uGisLayerDefault.call(i,t),i.layerName=void 0!==t.layerName?t.layerName:"",i.srsName=void 0!==t.srsName?t.srsName:"EPSG:3857",i.maxFeatures=void 0!==t.maxFeatures?t.maxFeatures:1e3,i.olLayer=new ol.layer.Vector({source:new ol.source.Vector}),ugmp.util.uGisUtil.objectMerge(a,{_this:i,srsName:i.srsName,layerName:i.layerName,getFeatures:i.getFeatures})},ugmp.layer.uGisWFSLayer.prototype=Object.create(ugmp.layer.uGisLayerDefault.prototype),ugmp.layer.uGisWFSLayer.prototype.constructor=ugmp.layer.uGisWFSLayer,ugmp.layer.uGisWFSLayer.prototype.getFeatures=function(e,t){var i=this._this||this;return new ugmp.service.uGisGetFeature({srsName:i.srsName,useProxy:i.useProxy,serviceURL:i.getServiceURL(),typeName:i.layerName,maxFeatures:i.maxFeatures,outputFormat:"application/json",filter:void 0!==e?e:void 0,dataViewId:t})}}(),function(){"use strict";ugmp.layer.uGisWMSLayer=function(a){var o=this,r=null;return this.singleTile=null,this.ogcParams=null,this.wfsServiceURL=null,function(){var e=a||{};e.layerType="WMS",e.useGetFeature=!0,r=ugmp.layer.uGisLayerDefault.call(o,e),e.wfsServiceURL?o.wfsServiceURL=e.wfsServiceURL:o.wfsServiceURL=o.serviceURL.replace("/wms","/wfs"),o.singleTile=void 0!==e.singleTile&&e.singleTile,o.ogcParams=void 0!==e.ogcParams?e.ogcParams:{};var t=o.serviceURL;if(o.useProxy&&(-1===t.indexOf("?")?t+="??":t.indexOf("?")===t.length-1&&(t=t.replace("?","??")),t=ugmp.uGisConfig.getProxy()+t),o.singleTile){var i=new ol.source.ImageWMS({url:t,params:o.ogcParams});o.olLayer=new ol.layer.Image({source:i})}else{i=new ol.source.TileWMS({url:t,params:o.ogcParams});o.olLayer=new ol.layer.Tile({source:i})}}(),ugmp.util.uGisUtil.objectMerge(r,{_this:o,ogcParams:o.ogcParams,getWFSServiceURL:o.getWFSServiceURL})},ugmp.layer.uGisWMSLayer.prototype=Object.create(ugmp.layer.uGisLayerDefault.prototype),ugmp.layer.uGisWMSLayer.prototype.constructor=ugmp.layer.uGisWMSLayer,ugmp.layer.uGisWMSLayer.prototype.getWFSServiceURL=function(){return(this._this||this).wfsServiceURL}}(),function(){"use strict";ugmp.layer.uGisWMTSLayer=function(e){var t,i=this,a=null;return this.layer=null,this.version=null,this.matrixSet=null,this.originExtent=null,this.wmtsCapabilities=null,(t=e||{}).layerType="WMTS",t.useGetFeature=!1,a=ugmp.layer.uGisLayerDefault.call(i,t),i.version=void 0!==t.version?t.version:"1.0.0",i.layer=void 0!==t.layer?t.layer:"",i.matrixSet=void 0!==t.matrixSet?t.matrixSet:"",i.originExtent=i._setOriginExtent(t.originExtent),i.wmtsCapabilities=i._setWmtsCapabilities(t.wmtsCapabilities),i._update(!1),i.olLayer=new ol.layer.Tile({source:null}),ugmp.util.uGisUtil.objectMerge(a,{_this:i,layer:i.layer,version:i.version,update:i._update,matrixSet:i.matrixSet,getOriginExtent:i.getOriginExtent,setOriginExtent:i._setOriginExtent,getWmtsCapabilities:i.getWmtsCapabilities,setWmtsCapabilities:i._setWmtsCapabilities})};var e=ugmp.layer.uGisWMTSLayer;e.prototype=Object.create(ugmp.layer.uGisLayerDefault.prototype),(e.prototype.constructor=e).prototype._setOriginExtent=function(e){var t=this._this||this;return e&&3<e.length?t.originExtent=e:t.originExtent=void 0,t.originExtent},e.prototype._setWmtsCapabilities=function(e){var t=this._this||this;return t.wmtsCapabilities=e||void 0,t.wmtsCapabilities},e.prototype._update=function(e){var t=this._this||this;if(t.olLayer&&e){var i=new ol.source.WMTS.optionsFromCapabilities(t.wmtsCapabilities.olJson,{layer:t.layer,matrixSet:t.matrixSet});if(t.useProxy)for(var a in i.urls)i.urls[a]=ugmp.uGisConfig.getProxy()+i.urls[a];t.olLayer.setSource(new ol.source.WMTS(i))}},e.prototype.getOriginExtent=function(){return(this._this||this).originExtent},e.prototype.getWmtsCapabilities=function(){return(this._this||this).wmtsCapabilities},e.prototype.setUseGetFeature=function(){(this._this||this).useGetFeature=!1}}(),function(){"use strict";ugmp.toc.uGisTocDefault=function(e){var t,i=this;return this.tocKey=null,this.tocTitle=null,this.uGisMap=null,this.uGisLayer=null,this.groupOpen=null,this.legendOpen=null,this.tocListDivId=null,this.tocDivId=null,this.tocAccorId=null,this.zTreeAttribute=null,t=e||{},i.uGisMap=void 0!==t.uGisMap?t.uGisMap:void 0,i.uGisLayer=void 0!==t.uGisLayer?t.uGisLayer:void 0,i.tocKey=void 0!==t.tocKey?t.tocKey:void 0,i.tocTitle=void 0!==t.tocTitle?t.tocTitle:void 0,i.tocListDivId=void 0!==t.tocListDivId?t.tocListDivId:void 0,i.groupOpen="boolean"!=typeof t.groupOpen||t.groupOpen,i.legendOpen="boolean"!=typeof t.legendOpen||t.legendOpen,i.uGisMap?i.uGisLayer?i.tocListDivId||(i.tocListDivId=ugmp.util.uGisUtil.generateUUID().split("-")[0],_$("body").append(_$("<div/>",{id:i.tocListDivId,css:{display:"none"}}))):ugmp.uGisConfig.alert_Error("uGisLayer undefined"):ugmp.uGisConfig.alert_Error("uGisMap undefined"),{tocKey:i.tocKey,remove:i.remove,uGisMap:i.uGisMap,uGisLayer:i.uGisLayer,getTocDivId:i.getTocDivId,tocExpandAll:i.tocExpandAll,tocCheckAllNodes:i.tocCheckAllNodes}},ugmp.toc.uGisTocDefault.prototype.createTocDiv=function(e,t){var i,a,o=this._this||this,r=null,n=null;o.tocDivId="TOC_"+ugmp.util.uGisUtil.generateUUID().split("-")[0],o.tocAccorId="accor_"+ugmp.util.uGisUtil.generateUUID().split("-")[0],a="collapse_"+ugmp.util.uGisUtil.generateUUID().split("-")[0],i='<img class="tocIMG_'+e+'">',(r=_$("<div/>",{id:o.tocAccorId})).addClass("panel-group"),r.html('<div class="panel-group" ><div class="panel panel-default"><div class="panel-heading" onclick="javascript:_$(\'#collapseOne\').collapse(\'toggle\');"><h4 class="panel-title"><a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#accordion1" href="#collapseOne" aria-expanded="false">sampleTOC_1</a><i class="indicator glyphicon glyphicon-chevron-down pull-right"></i></h4></div><div id="collapseOne" class="panel-collapse collapse" aria-expanded="false" style="height: 0px;"><div class="panel-body" style="padding: 5px;"><div style="overflow: auto; width: 100%;" class="ztree" id="TOC_1"></div><div class="tocEventDIV"><div class="tocEventDIV sub"><a onclick="javascript:_$.fn.zTree.getZTreeObj(\''+o.tocDivId+"').checkAllNodes("+!0+');"><span class="glyphicon glyphicon-check"></span></a><a onclick="javascript:_$.fn.zTree.getZTreeObj(\''+o.tocDivId+"').checkAllNodes("+!1+');"><span class="glyphicon glyphicon-unchecked"></span></a><a onclick="javascript:_$.fn.zTree.getZTreeObj(\''+o.tocDivId+"').expandAll("+!0+');"><span class="glyphicon glyphicon-resize-full"></span></a><a onclick="javascript:_$.fn.zTree.getZTreeObj(\''+o.tocDivId+"').expandAll("+!1+');"><span class="glyphicon glyphicon-resize-small"></span></a></div></div></div></div></div></div>');"WMS"!==e&&"WebWMS"!==e||r.find(".panel-body").prepend('<table class="table" style="border: 1px solid #cecece; margin-bottom: 10px;"><tbody><tr><td>CRS</td><td id="CRS_TEXT"></td></tr><tr><td>BBOX</td><td id="BBOX_TEXT" style="word-break: break-all; white-space:pre-line;"></td></tr></tbody></table>'),(n=r.find(".panel-heading")).attr("onclick",n.attr("onclick").replace("collapseOne",a)),n.find(".accordion-toggle").attr("data-parent","#"+o.tocAccorId),n.find(".accordion-toggle").attr("href","#"+a),n.find(".accordion-toggle").text(" "+t),n.find(".accordion-toggle").prepend(_$(i)),r.find(".panel-collapse").attr("id",a).find(".ztree").attr("id",o.tocDivId),_$("#"+o.tocListDivId).prepend(r)},ugmp.toc.uGisTocDefault.prototype.zTreeAttribute_Legend=function(e){var t=new(this._this||this)._zTreeFuncs;return{view:{selectedMulti:!1,expandSpeed:"fast",addDiyDom:t.addDIYDom_Legend},check:{autoCheckTrigger:!0,enable:!0,chkboxType:{Y:"",N:""}},data:{simpleData:{enable:!0}},edit:{enable:!0,showRemoveBtn:!1,showRenameBtn:!1,drag:{autoExpandTrigger:!0,prev:t.dropPrev,inner:t.dropInner,next:t.dropNext}},callback:{onCheck:e.layerSetVisible,beforeDrop:e.layerOrderChange,beforeDrag:t.beforeDrag},async:{enable:!0}}},ugmp.toc.uGisTocDefault.prototype.tocExpandAll=function(e){var t=this._this||this;_$.fn.zTree.getZTreeObj(t.tocDivId).expandAll(e)},ugmp.toc.uGisTocDefault.prototype.tocCheckAllNodes=function(e){var t=this._this||this;_$.fn.zTree.getZTreeObj(t.tocDivId).checkAllNodes(e)},ugmp.toc.uGisTocDefault.prototype.getTocDivId=function(){return(this._this||this).tocDivId},ugmp.toc.uGisTocDefault.prototype.remove=function(){var e=this._this||this;_$.fn.zTree.destroy(e.tocDivId),_$("#"+e.tocAccorId).remove()},ugmp.toc.uGisTocDefault.prototype._zTreeFuncs=function(){var s=this;return s.curDragNodes=null,{dropPrev:function(e,t,i){var a=i.getParentNode();if(a&&!1===a.dropInner)return!1;for(var o=0,r=s.curDragNodes.length;o<r;o++){var n=s.curDragNodes[o].getParentNode();if(n&&n!==i.getParentNode()&&!1===n.childOuter)return!1}return!0},dropInner:function(e,t,i){if(i&&!1===i.dropInner)return!1;for(var a=0,o=s.curDragNodes.length;a<o;a++){if(!i&&!1===s.curDragNodes[a].dropRoot)return!1;if(s.curDragNodes[a].parentTId&&s.curDragNodes[a].getParentNode()!==i&&!1===s.curDragNodes[a].getParentNode().childOuter)return!1}return!0},dropNext:function(e,t,i){var a=i.getParentNode();if(a&&!1===a.dropInner)return!1;for(var o=0,r=s.curDragNodes.length;o<r;o++){var n=s.curDragNodes[o].getParentNode();if(n&&n!==i.getParentNode()&&!1===n.childOuter)return!1}return!0},beforeDrag:function(e,t){for(var i=0,a=t.length;i<a;i++){if(!1===t[i].drag)return s.curDragNodes=null,!1;if(t[i].parentTId&&!1===t[i].getParentNode().childDrag)return s.curDragNodes=null,!1}return s.curDragNodes=t,!0},addDIYDom_Legend:function(e,t){if(!t.parentNode||2===t.parentNode.id){var i=_$("#"+t.tId+"_a");t.isLegend&&t.LegendURL&&(i.empty(),i.css("height","auto"),i.append("<img src='"+t.LegendURL+"'>"))}}}}}(),function(){"use strict";ugmp.toc.uGisWCSToc=function(e){var t,o=this,i=null;function a(e,t,i){var a;a=i.isGroupLayer?!(!i.checked||!i.children[0].checked):!(!i.checked||!i.getParentNode().checked),o.uGisLayer.setTocVisible(a)}return this.coverage=null,t=e||{},i=ugmp.toc.uGisTocDefault.call(o,t),o.coverage=void 0!==t.coverage?t.coverage:"",o.createTocDiv("WCS",o.tocTitle),o.zTreeAttribute=o.zTreeAttribute_Legend(a),o._createWCSToc(),ugmp.util.uGisUtil.objectMerge(i,{_this:o})},ugmp.toc.uGisWCSToc.prototype=Object.create(ugmp.toc.uGisTocDefault.prototype),ugmp.toc.uGisWCSToc.prototype.constructor=ugmp.toc.uGisWCSToc,ugmp.toc.uGisWCSToc.prototype._createWCSToc=function(){var e,t=this._this||this,i=t._getWCSNodeTozTree(t._getWCSLayerData());return e=(t.isWebMap,i),_$.fn.zTree.init(_$("#"+t.tocDivId),t.zTreeAttribute,e),e},ugmp.toc.uGisWCSToc.prototype._getWCSNodeTozTree=function(e){var t={id:e.Coverage,name:e.Coverage,children:[],open:!0,drop:!1,inner:!1,checked:!0,Coverage:e.Coverage,isGroupLayer:!1,Extent:null,chkDisabled:!1};return{id:"root",name:e.Coverage,children:[t],open:!0,drop:!1,inner:!1,checked:!0,isGroupLayer:!0,Extent:null,chkDisabled:!1}},ugmp.toc.uGisWCSToc.prototype._getWCSLayerData=function(){var e=this._this||this;return{KEY:e.tocKey,Coverage:e.coverage}}}(),function(){"use strict";ugmp.toc.uGisWFSToc=function(e){var t,o=this,i=null;function a(e,t,i){var a;a=i.isGroupLayer?!(!i.checked||!i.children[0].checked):!(!i.checked||!i.getParentNode().checked),o.uGisLayer.setTocVisible(a)}return this.layerTitle=null,this.layerName=null,t=e||{},i=ugmp.toc.uGisTocDefault.call(o,t),o.layerTitle=void 0!==t.layerTitle?t.layerTitle:"",o.layerName=void 0!==t.layerName?t.layerName:"",o.createTocDiv("WFS",o.tocTitle),o.zTreeAttribute=o.zTreeAttribute_Legend({layerSetVisible:a}),o._createWFSToc(),ugmp.util.uGisUtil.objectMerge(i,{_this:o})},ugmp.toc.uGisWFSToc.prototype=Object.create(ugmp.toc.uGisTocDefault.prototype),ugmp.toc.uGisWFSToc.prototype.constructor=ugmp.toc.uGisWFSToc,ugmp.toc.uGisWFSToc.prototype._createWFSToc=function(){var e,t=this._this||this,i=t._getWFSNodeTozTree(t._getWFSLayerData());return e=(t.isWebMap,i),_$.fn.zTree.init(_$("#"+t.tocDivId),t.zTreeAttribute,e),e},ugmp.toc.uGisWFSToc.prototype._getWFSNodeTozTree=function(e){var t={id:e.LayerName,name:e.LayerTitle,open:!0,drag:!1,drop:!1,checked:!0,LayerName:e.LayerName,isGroupLayer:!1,Extent:null,chkDisabled:!1};return{id:"ROOT",name:e.LayerTitle,children:[t],open:!0,drag:!1,drop:!1,checked:!0,LayerName:e.LayerName,isGroupLayer:!0,Extent:null,chkDisabled:!1,iconSkin:"pIconFeatureLayer"}},ugmp.toc.uGisWFSToc.prototype._getWFSLayerData=function(){var e=this._this||this;return{KEY:e.tocKey,LayerName:e.layerName,LayerTitle:e.layerTitle}}}(),function(){"use strict";ugmp.toc.uGisWMSToc=function(a){var n=this,o=null;function r(e,t,i){n._olWMSLayerRefresh(!1)}function s(e,t,i,a){var o=!1;if(!t[0])return!1;var r=t[0].tId.split("_")[1];return e.split("_")[1]===r&&(i.isGroupLayer?(o=!!i.drop,"ROOT"===i.LayerName&&"inner"!==a&&(o=!1)):o="inner"!==a,n._layerOrderChangeListener(o))}return this.loadData=null,this.symbolSize=null,this.capabilities=null,this.visibleState=null,this.key_zoomEnd=null,this.showLayerNames=null,this.key_changeResolution=null,function(e){var t=a||{};o=ugmp.toc.uGisTocDefault.call(n,t);var i=t.symbolSize;if(Array.isArray(i)?n.symbolSize=i:n.symbolSize=[20,20],n.loadData=void 0!==t.loadData?t.loadData:void 0,n.visibleState=void 0!==t.visibleState?t.visibleState:{},n.capabilities=void 0!==t.capabilities?t.capabilities:void 0,!n.capabilities)return ugmp.uGisConfig.alert_Error("capabilities undefined");n.createTocDiv("WMS",n.tocTitle),n.zTreeAttribute=n.zTreeAttribute_Legend({layerSetVisible:r,layerOrderChange:s}),n._createWMSToc(!1),n._createReloadBtn(),n._activeChangeResolution(),_$("#"+n.tocAccorId).find("#CRS_TEXT").text(n.capabilities.serviceMetaData.crs),_$("#"+n.tocAccorId).find("#BBOX_TEXT").text(n.capabilities.serviceMetaData.maxExtent.toString()),n.uGisMap.getMap().getView().dispatchEvent({type:"change:resolution"})}(),ugmp.util.uGisUtil.objectMerge(o,{_this:n,reLoad:n.reLoad,getSaveData:n.getSaveData,getShowLayerNames:n.getShowLayerNames})},ugmp.toc.uGisWMSToc.prototype=Object.create(ugmp.toc.uGisTocDefault.prototype),ugmp.toc.uGisWMSToc.prototype.constructor=ugmp.toc.uGisWMSToc,ugmp.toc.uGisWMSToc.prototype._layerOrderChangeListener=function(e){var t=this._this||this;return e&&(t._olWMSLayerRefresh(!0),setTimeout(function(){t._olWMSLayerRefresh(!0)},100)),e},ugmp.toc.uGisWMSToc.prototype._createWMSToc=function(e){var t=this._this||this,i=t._getWMSNodeTozTree(t._getWMSLayerData().Layers);if(!e&&t.loadData){var a=t._getLayerDataObject(i,{});i=t._setLoadData(a,_$.extend(!0,{},t.loadData))}return _$.fn.zTree.init(_$("#"+t.tocDivId),t.zTreeAttribute,i),i},ugmp.toc.uGisWMSToc.prototype._getWMSNodeTozTree=function(e){for(var t=this._this||this,i={id:null,name:null,children:[],drop:!0,drag:!0,open:!0,checked:!0,dropInner:!0,chkDisabled:!1,Extent:null,LayerName:null,LegendURL:null,MinScale:0,MaxScale:1/0,scaleVisible:!0,isGroupLayer:!1},a=0;a<e.length;a++){i.name=e[a].Title,i.id=e[a].LayerName,i.LayerName=e[a].LayerName,"boolean"==typeof t.visibleState[i.LayerName]&&(i.checked=t.visibleState[i.LayerName]),i.LegendURL=e[a].LegendURL;var o=e[a].MinScale;void 0!==o&&(i.MinScale=o);var r=e[a].MaxScale;void 0!==r&&(i.MaxScale=r),i.Extent=e[a].Extent,i.isGroupLayer=e[a].isGroupLayer,i.isGroupLayer&&(i.open=!!t.groupOpen),"ROOT"===i.id&&(i.open=!0,i.drag=!1);var n=e[a].ChildLayers;if(0<n.length)for(var s=0;s<n.length;s++)i.children.push(t._getWMSNodeTozTree([n[s]]));else i.drop=!1,i.dropInner=!1,i.iconSkin="pIconFeatureLayer",t.legendOpen||(i.open=!1),i.children.push({drag:!1,drop:!1,open:!1,nocheck:!0,isLegend:!0,dropInner:!1,LayerName:"leg_"+i.LayerName,LegendURL:i.LegendURL})}return i},ugmp.toc.uGisWMSToc.prototype._getWMSLayerData=function(){var e=this._this||this,t={CRS:e.capabilities.serviceMetaData.crs,MaxExtent:e.capabilities.serviceMetaData.maxExtent,Layers:[]},i=e.capabilities.xmlJson.WMS_Capabilities.Capability.Layer,a=e._getWMSCapabilitieLayerData([i]);return t.Layers.push(a),t},ugmp.toc.uGisWMSToc.prototype._getWMSCapabilitieLayerData=function(e){var t=this._this||this,i={LayerName:null,Title:null,Extent:null,MinScale:null,MaxScale:null,LegendURL:null,isGroupLayer:!1,isVisible:!0,ChildLayers:[]};for(var a in e){var o=e[a].Title;void 0!==o&&(o=o["#text"]);var r=e[a].Name;void 0!==r&&(r=r["#text"]);var n=e[a].BoundingBox;void 0!==n&&(Array.isArray(n)&&(n=n[0]),n=n["@attributes"],n=[parseFloat(n.minx),parseFloat(n.miny),parseFloat(n.maxx),parseFloat(n.maxy)]);var s=e[a].MinScaleDenominator;void 0!==s&&(s=parseFloat(s["#text"]));var u=e[a].MaxScaleDenominator;void 0!==u&&(u=parseFloat(u["#text"]));var l,p=e[a].Style;void 0!==p&&(Array.isArray(p)&&(p=p[0]),void 0!==p.LegendURL&&(l=p.LegendURL.OnlineResource["@attributes"]["xlink:href"],l+="&SYMBOL_WIDTH="+t.symbolSize[0],l+="&SYMBOL_HEIGHT="+t.symbolSize[1]));var c=e[a].Layer;if(Array.isArray(c)||void 0===c||(c=[c]),Array.isArray(c)){i.isGroupLayer=!0;for(var g=c.length;0<=--g;)i.ChildLayers.push(t._getWMSCapabilitieLayerData([c[g]]))}i.LayerName=r,i.Title=o,i.Extent=n,i.MinScale=s,i.MaxScale=u,i.LegendURL=l}return i},ugmp.toc.uGisWMSToc.prototype._getNoneGroupLayers=function(e,t){var i=this._this||this;for(var a in e=[e]){var o=e[a];if(o.isGroupLayer){var r=o.children;for(var n in r){var s=r[n];i._getNoneGroupLayers(s,t)}}else t.push(o)}return t},ugmp.toc.uGisWMSToc.prototype._activeChangeResolution=function(e){var t=this._this||this,i=t.uGisMap.getMap().getView();function a(e){t.key_changeResolution=e.on("change:resolution",function(){o()})}function o(){var e=t.uGisMap.calculateScale({extent:t.uGisMap.getMap().getView().calculateExtent(t.uGisMap.getMap().getSize()),originCRS:t.capabilities.serviceMetaData.crs});e=Math.ceil(e),function e(t,i){t.isLegend||(t.MinScale<=i&&i<t.MaxScale?(t.scaleVisible=!0,t.chkDisabled=!1):(t.scaleVisible=!1,t.chkDisabled=!0));var a=t.children;if(Array.isArray(a))for(var o=0;o<a.length;o++){var r=a[o];e(r,i)}}(_$.fn.zTree.getZTreeObj(t.tocDivId).getNodes()[0],e),_$.fn.zTree.getZTreeObj(t.tocDivId).refresh(),t._olWMSLayerRefresh(!1)}t.uGisMap.getMap().on("change:view",function(e){ol.Observable.unByKey(t.key_zoomEnd),ol.Observable.unByKey(t.key_changeResolution),a(e.target.getView())}),a(i)},ugmp.toc.uGisWMSToc.prototype.setZtreeLayerData=function(){var e=this._this||this,t=[],i=_$.fn.zTree.getZTreeObj(e.tocDivId).getNodes()[0];return t=void 0===(t=e._getZtreeLayerData(i,t,"show"))?"":t.toString(),e.showLayerNames=t},ugmp.toc.uGisWMSToc.prototype._getZtreeLayerData=function(e,t,i){var a=this._this||this,o=[e];for(var r in o){var n=o[r];if("show"===i&&!1===n.checked||"show"===i&&!0===n.chkDisabled)return;if(n.isGroupLayer)for(var s=n.children,u=s.length;0<=--u;){var l=s[u];a._getZtreeLayerData(l,t,i)}else t.push(n.LayerName)}return t},ugmp.toc.uGisWMSToc.prototype._olWMSLayerRefresh=function(e){var t=this._this||this,i=t.uGisLayer.getOlLayer();i.getSource().getParams().LAYERS=t.setZtreeLayerData(),e&&(i.getSource().getParams().refTime=(new Date).getMilliseconds()),i.getSource().updateParams(i.getSource().getParams()),""===i.getSource().getParams().LAYERS?t.uGisLayer.setTocVisible(!1):t.uGisLayer.getVisible()||t.uGisLayer.setTocVisible(!0)},ugmp.toc.uGisWMSToc.prototype._getLayerDataObject=function(e,t){var i=this._this||this,a=e.children;if(Array.isArray(a))for(var o=0;o<a.length;o++){var r=a[o];t[e.LayerName]=e,i._getLayerDataObject(r,t)}else t[e.LayerName]=e;return t},ugmp.toc.uGisWMSToc.prototype.getSaveData=function(){var e=this._this||this,t=$.fn.zTree.getZTreeObj(e.tocDivId).getNodes()[0];return e._getSaveData(_$.extend(!0,{},t))},ugmp.toc.uGisWMSToc.prototype._getSaveData=function(e){var t=this._this||this,i=["open","checked","children","LayerName"];for(var a in e)e.hasOwnProperty(a)&&-1===_$.inArray(a,i)&&delete e[a];var o=e.children;if(Array.isArray(o))for(var r=0;r<o.length;r++){var n=o[r];t._getSaveData(n)}return e},ugmp.toc.uGisWMSToc.prototype._setLoadData=function(e,t){var i=this._this||this,a=["open","checked","children"],o=e[t.LayerName];for(var r in o)o.hasOwnProperty(r)&&-1===$.inArray(r,a)&&(t[r]=o[r]);var n=t.children;if(Array.isArray(n))for(var s=0;s<n.length;s++){var u=n[s];i._setLoadData(e,u)}return t},ugmp.toc.uGisWMSToc.prototype._createReloadBtn=function(){var e=this._this||this,t=$("<a/>",{click:function(){e.reLoad()}}).append($("<span/>",{class:"glyphicon glyphicon-refresh",title:"새로고침"}));_$("#"+e.tocDivId).parent().find(".tocEventDIV.sub").prepend(t)},ugmp.toc.uGisWMSToc.prototype.getShowLayerNames=function(e){var t=(this._this||this).showLayerNames.split(",");return e&&(t=t.reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[])),t},ugmp.toc.uGisWMSToc.prototype.reLoad=function(){var e=this._this||this;$.fn.zTree.destroy(e.tocDivId),e._createWMSToc(!0),e.uGisMap.getMap().getView().dispatchEvent({type:"change:resolution"})},ugmp.toc.uGisWMSToc.prototype.remove=function(){var e=this._this||this;ugmp.toc.uGisTocDefault.prototype.remove.call(this),ol.Observable.unByKey(e.key_changeResolution)}}(),function(){"use strict";ugmp.toc.uGisWMTSToc=function(e){var t,o=this,i=null;function a(e,t,i){var a;a=i.isGroupLayer?!(!i.checked||!i.children[0].checked):!(!i.checked||!i.getParentNode().checked),o.uGisLayer.setTocVisible(a)}return this.matrixSet=null,this.layerName=null,this.legendURL=null,t=e||{},i=ugmp.toc.uGisTocDefault.call(o,t),o.layerName=void 0!==t.layerName?t.layerName:"",o.matrixSet=void 0!==t.matrixSet?t.matrixSet:"",o.legendURL=void 0!==t.legendURL?t.legendURL:"",o.createTocDiv("WMTS",o.tocTitle),o.zTreeAttribute=o.zTreeAttribute_Legend({layerSetVisible:a}),o._createWMTSToc(),ugmp.util.uGisUtil.objectMerge(i,{_this:o})},ugmp.toc.uGisWMTSToc.prototype=Object.create(ugmp.toc.uGisTocDefault.prototype),ugmp.toc.uGisWMTSToc.prototype.constructor=ugmp.toc.uGisWMTSToc,ugmp.toc.uGisWMTSToc.prototype._createWMTSToc=function(){var e,t=this._this||this,i=t._getWMTSNodeTozTree(t._getWMTSLayerData());return e=(t.isWebMap,i),_$.fn.zTree.init(_$("#"+t.tocDivId),t.zTreeAttribute,e),e},ugmp.toc.uGisWMTSToc.prototype._getWMTSNodeTozTree=function(e){var t={id:e.LayerName,name:e.LayerName,open:!0,drag:!1,drop:!1,checked:!0,LayerName:e.LayerName,MatrixSet:e.MatrixSet,isGroupLayer:!1,Extent:null,chkDisabled:!1,LegendURL:e.LegendURL};return{id:"ROOT",name:e.LayerName,children:[t],open:!0,drag:!1,drop:!1,checked:!0,isGroupLayer:!0,LegendURL:null,Extent:null,chkDisabled:!1,iconSkin:"pIconFeatureLayer"}},ugmp.toc.uGisWMTSToc.prototype._getWMTSLayerData=function(){var e=this._this||this;return{KEY:e.tocKey,LayerName:e.layerName,LayerTitle:e.layerName,MatrixSet:e.matrixSet,LegendURL:e.legendURL}}}(),function(){"use strict";ugmp.toc.uGisWebWMSToc=function(i){var n=this,a=null;function o(e,t,i){n._olWMSLayerRefresh()}function r(e,t,i,a){var o=!1;if(!t[0])return!1;var r=t[0].tId.split("_")[1];return e.split("_")[1]===r&&(i.isGroupLayer?(o=!!i.drop,"ROOT"===i.LayerName&&"inner"!==a&&(o=!1)):o="inner"!==a,n._layerOrderChangeListener(o))}return this.symbolSize=null,this.capabilities=null,this.visibleState=null,this.selectLayers=null,this.key_zoomEnd=null,this.showLayerNames=null,this.key_changeResolution=null,function(){var e=i||{};a=ugmp.toc.uGisTocDefault.call(n,e);var t=e.symbolSize;if(Array.isArray(t)?n.symbolSize=t:n.symbolSize=[20,20],n.loadData=void 0!==e.loadData?e.loadData:void 0,n.visibleState=void 0!==e.visibleState?e.visibleState:{},n.selectLayers=void 0!==e.selectLayers?e.selectLayers:[],n.capabilities=void 0!==e.capabilities?e.capabilities:void 0,!n.capabilities)return ugmp.uGisConfig.alert_Error("capabilities undefined");n.createTocDiv("WebWMS",n.tocTitle),n.zTreeAttribute=n.zTreeAttribute_Legend({layerSetVisible:o,layerOrderChange:r}),n._createWMSToc(!1),n._createReloadBtn(),n._activeChangeResolution(),_$("#"+n.tocAccorId).find("#CRS_TEXT").text(n.capabilities.serviceMetaData.crs),_$("#"+n.tocAccorId).find("#BBOX_TEXT").text(n.capabilities.serviceMetaData.maxExtent.toString()),n.uGisMap.getMap().getView().dispatchEvent({type:"change:resolution"})}(),ugmp.util.uGisUtil.objectMerge(a,{_this:n,reLoad:n.reLoad,getSaveData:n.getSaveData,getShowLayerNames:n.getShowLayerNames})},ugmp.toc.uGisWebWMSToc.prototype=Object.create(ugmp.toc.uGisTocDefault.prototype),ugmp.toc.uGisWebWMSToc.prototype.constructor=ugmp.toc.uGisWebWMSToc,ugmp.toc.uGisWebWMSToc.prototype._layerOrderChangeListener=function(e){var t=this._this||this;return e&&(t._olWMSLayerRefresh(),setTimeout(function(){t._olWMSLayerRefresh()},100)),e},ugmp.toc.uGisWebWMSToc.prototype._createWMSToc=function(e){var t=this._this||this,i=t._getWMSNodeTozTree(t._getWMSLayerData().Layers);if(!e&&t.loadData){var a=t._getLayerDataObject(i,{});i=t._setLoadData(a,_$.extend(!0,{},t.loadData))}return void 0!==t.selectLayers&&(i=t._getSelectLayers(i,t.selectLayers)),_$.fn.zTree.init(_$("#"+t.tocDivId),t.zTreeAttribute,i),i},ugmp.toc.uGisWebWMSToc.prototype._getSelectLayers=function(e,t){var i,a=[];a=(this._this||this)._getNoneGroupLayers(e,a);var o=[];for(var r in t){var n=t[r];for(var s in a){a[s].LayerName===n&&(o.push(a.slice(s,s+1)[0]),a.splice(s,1))}}return i=o,e.children=i,e},ugmp.toc.uGisWebWMSToc.prototype._getWMSNodeTozTree=function(e){for(var t=this._this||this,i={id:null,name:null,children:[],drop:!0,drag:!0,open:!0,checked:!0,dropInner:!0,chkDisabled:!1,Extent:null,LayerName:null,LegendURL:null,MinScale:0,MaxScale:1/0,scaleVisible:!0,isGroupLayer:!1},a=0;a<e.length;a++){i.name=e[a].Title,i.id=e[a].LayerName,i.LayerName=e[a].LayerName,"boolean"==typeof t.visibleState[i.LayerName]&&(i.checked=t.visibleState[i.LayerName]),i.LegendURL=e[a].LegendURL;var o=e[a].MinScale;void 0!==o&&(i.MinScale=o);var r=e[a].MaxScale;void 0!==r&&(i.MaxScale=r),i.Extent=e[a].Extent,i.isGroupLayer=e[a].isGroupLayer,i.isGroupLayer&&(i.open=!!t.groupOpen),"ROOT"===i.id&&(i.open=!0,i.drag=!1);var n=e[a].ChildLayers;if(0<n.length)for(var s=0;s<n.length;s++)i.children.push(t._getWMSNodeTozTree([n[s]]));else i.drop=!1,i.dropInner=!1,i.iconSkin="pIconFeatureLayer",t.legendOpen||(i.open=!1),i.children.push({drag:!1,drop:!1,open:!1,nocheck:!0,isLegend:!0,dropInner:!1,LayerName:"leg_"+i.LayerName,LegendURL:i.LegendURL})}return i},ugmp.toc.uGisWebWMSToc.prototype._getWMSLayerData=function(){var e=this._this||this,t={CRS:e.capabilities.serviceMetaData.crs,MaxExtent:e.capabilities.serviceMetaData.maxExtent,Layers:[]},i=e.capabilities.xmlJson.WMS_Capabilities.Capability.Layer,a=e._getWMSCapabilitieLayerData([i]);return t.Layers.push(a),t},ugmp.toc.uGisWebWMSToc.prototype._getWMSCapabilitieLayerData=function(e){var t=this._this||this,i={LayerName:null,Title:null,Extent:null,MinScale:null,MaxScale:null,LegendURL:null,isGroupLayer:!1,isVisible:!0,ChildLayers:[]};for(var a in e){var o=e[a].Title;void 0!==o&&(o=o["#text"]);var r=e[a].Name;void 0!==r&&(r=r["#text"]);var n=e[a].BoundingBox;void 0!==n&&(Array.isArray(n)&&(n=n[0]),n=n["@attributes"],n=[parseFloat(n.minx),parseFloat(n.miny),parseFloat(n.maxx),parseFloat(n.maxy)]);var s=e[a].MinScaleDenominator;void 0!==s&&(s=parseFloat(s["#text"]));var u=e[a].MaxScaleDenominator;void 0!==u&&(u=parseFloat(u["#text"]));var l,p=e[a].Style;void 0!==p&&(Array.isArray(p)&&(p=p[0]),void 0!==p.LegendURL&&(l=p.LegendURL.OnlineResource["@attributes"]["xlink:href"],l+="&SYMBOL_WIDTH="+t.symbolSize[0],l+="&SYMBOL_HEIGHT="+t.symbolSize[1]));var c=e[a].Layer;if(Array.isArray(c)||void 0===c||(c=[c]),Array.isArray(c)){i.isGroupLayer=!0;for(var g=c.length;0<=--g;)i.ChildLayers.push(t._getWMSCapabilitieLayerData([c[g]]))}i.LayerName=r,i.Title=o,i.Extent=n,i.MinScale=s,i.MaxScale=u,i.LegendURL=l}return i},ugmp.toc.uGisWebWMSToc.prototype._getNoneGroupLayers=function(e,t){var i=this._this||this;for(var a in e=[e]){var o=e[a];if(o.isGroupLayer){var r=o.children;for(var n in r){var s=r[n];i._getNoneGroupLayers(s,t)}}else t.push(o)}return t},ugmp.toc.uGisWebWMSToc.prototype._activeChangeResolution=function(e){var t=this._this||this,i=t.uGisMap.getMap().getView();function a(e){t.key_changeResolution=e.on("change:resolution",function(){o()})}function o(){var e=t.uGisMap.calculateScale({extent:t.uGisMap.getMap().getView().calculateExtent(t.uGisMap.getMap().getSize()),originCRS:t.capabilities.serviceMetaData.crs});e=Math.ceil(e),function e(t,i){t.isLegend||(t.MinScale<=i&&i<t.MaxScale?(t.scaleVisible=!0,t.chkDisabled=!1):(t.scaleVisible=!1,t.chkDisabled=!0));var a=t.children;if(Array.isArray(a))for(var o=0;o<a.length;o++){var r=a[o];e(r,i)}}(_$.fn.zTree.getZTreeObj(t.tocDivId).getNodes()[0],e),_$.fn.zTree.getZTreeObj(t.tocDivId).refresh(),t._olWMSLayerRefresh()}t.uGisMap.getMap().on("change:view",function(e){ol.Observable.unByKey(t.key_zoomEnd),ol.Observable.unByKey(t.key_changeResolution),a(e.target.getView())}),a(i)},ugmp.toc.uGisWebWMSToc.prototype.setZtreeLayerData=function(){var e=this._this||this,t=[],i=_$.fn.zTree.getZTreeObj(e.tocDivId).getNodes()[0];return t=void 0===(t=e._getZtreeLayerData(i,t,"show"))?"":t.toString(),e.showLayerNames=t},ugmp.toc.uGisWebWMSToc.prototype._getZtreeLayerData=function(e,t,i){var a=this._this||this,o=[e];for(var r in o){var n=o[r];if("show"===i&&!1===n.checked||"show"===i&&!0===n.chkDisabled)return;if(n.isGroupLayer)for(var s=n.children,u=s.length;0<=--u;){var l=s[u];a._getZtreeLayerData(l,t,i)}else t.push(n.LayerName)}return t},ugmp.toc.uGisWebWMSToc.prototype._olWMSLayerRefresh=function(){var e=this._this||this,t=e.uGisLayer.getOlLayer();t.getSource().getParams().LAYERS=e.setZtreeLayerData(),t.getSource().getParams().refTime=(new Date).getMilliseconds(),t.getSource().updateParams(t.getSource().getParams()),""===t.getSource().getParams().LAYERS?e.uGisLayer.setTocVisible(!1):e.uGisLayer.getVisible()||e.uGisLayer.setTocVisible(!0)},ugmp.toc.uGisWebWMSToc.prototype._getLayerDataObject=function(e,t){var i=this._this||this,a=e.children;if(Array.isArray(a))for(var o=0;o<a.length;o++){var r=a[o];t[e.LayerName]=e,i._getLayerDataObject(r,t)}else t[e.LayerName]=e;return t},ugmp.toc.uGisWebWMSToc.prototype.getSaveData=function(){var e=this._this||this,t=$.fn.zTree.getZTreeObj(e.tocDivId).getNodes()[0];return e._getSaveData(_$.extend(!0,{},t))},ugmp.toc.uGisWebWMSToc.prototype._getSaveData=function(e){var t=this._this||this,i=["open","checked","children","LayerName"];for(var a in e)e.hasOwnProperty(a)&&-1===_$.inArray(a,i)&&delete e[a];var o=e.children;if(Array.isArray(o))for(var r=0;r<o.length;r++){var n=o[r];t._getSaveData(n)}return e},ugmp.toc.uGisWebWMSToc.prototype._setLoadData=function(e,t){var i=this._this||this,a=["open","checked","children"],o=e[t.LayerName];for(var r in o)o.hasOwnProperty(r)&&-1===$.inArray(r,a)&&(t[r]=o[r]);var n=t.children;if(Array.isArray(n))for(var s=0;s<n.length;s++){var u=n[s];i._setLoadData(e,u)}return t},ugmp.toc.uGisWebWMSToc.prototype._createReloadBtn=function(){var e=this._this||this,t=$("<a/>",{click:function(){e.reLoad()}}).append($("<span/>",{class:"glyphicon glyphicon-refresh",title:"새로고침"}));_$("#"+e.tocDivId).parent().find(".tocEventDIV.sub").prepend(t)},ugmp.toc.uGisWebWMSToc.prototype.getShowLayerNames=function(e){var t=(this._this||this).showLayerNames.split(",");return e&&(t=t.reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[])),t},ugmp.toc.uGisWebWMSToc.prototype.reLoad=function(){var e=this._this||this;$.fn.zTree.destroy(e.tocDivId),e._createWMSToc(!0),e.uGisMap.getMap().getView().dispatchEvent({type:"change:resolution"})},ugmp.toc.uGisWebWMSToc.prototype.remove=function(){var e=this._this||this;ugmp.toc.uGisTocDefault.prototype.remove.call(this),ol.Observable.unByKey(e.key_changeResolution)}}(),function(){"use strict";ugmp.baseMap.uGisBaseMapDefault=function(e){var t=this;return this.apiMap=null,this.isWorld=null,this.isFactor=null,this.baseCode=null,this.mapTypes=null,this.projection=null,this.maxExtent=null,this.isAvailable=null,{isWorlds:t.isWorlds,isFactors:t.isFactors,isAvailables:t.isAvailables,updateSize:t.updateSize,setMapType:t.setMapType,syncMapFunc:t.syncMapFunc,getUsableKeys:t.getUsableKeys,createBaseMap:t.createBaseMap,getTypeProperties:t.getTypeProperties}},ugmp.baseMap.uGisBaseMapDefault.prototype.init=function(e){var t=this._this||this,i=e||{};t.apiMap=void 0!==i.apiMap?i.apiMap:void 0,t.isWorld=void 0===i.isWorld||i.isWorld,t.isFactor=void 0===i.isFactor||i.isFactor,t.mapTypes=void 0!==i.mapTypes?i.mapTypes:{},t.baseCode=void 0!==i.baseCode?i.baseCode:"custom_code",t.projection=void 0!==i.projection?i.projection:"EPSG:3857",t.maxExtent=void 0!==i.maxExtent?i.maxExtent:ol.proj.get("EPSG:3857").getExtent(),"function"==typeof i.createBaseMap&&(t.createBaseMap=i.createBaseMap),"function"==typeof i.syncMapFunc&&(t.syncMapFunc=i.syncMapFunc),"function"==typeof i.setMapType&&(t.setMapType=i.setMapType),"function"==typeof i.updateSize&&(t.updateSize=i.updateSize),"function"==typeof i.getTypeProperties&&(t.getTypeProperties=i.getTypeProperties)},ugmp.baseMap.uGisBaseMapDefault.prototype.createBaseMap=function(e,t){},ugmp.baseMap.uGisBaseMapDefault.prototype.syncMapFunc=function(e){},ugmp.baseMap.uGisBaseMapDefault.prototype.setMapType=function(e){},ugmp.baseMap.uGisBaseMapDefault.prototype.updateSize=function(){},ugmp.baseMap.uGisBaseMapDefault.prototype.getTypeProperties=function(e){var t=this._this||this;return{minZoom:t.mapTypes[e].minZoom,maxZoom:t.mapTypes[e].maxZoom,baseCode:t.baseCode,projection:t.projection,maxExtent:t.maxExtent,id:t.mapTypes[e].id}},ugmp.baseMap.uGisBaseMapDefault.prototype.checkIsAvailable=function(e){var t=this._this||this;try{new Function(e.toString())(),t.isAvailable=!0}catch(e){t.isAvailable=!1}},ugmp.baseMap.uGisBaseMapDefault.prototype.getUsableKeys=function(){var e=this._this||this,t=[],i=e.mapTypes;for(var a in i)-1<a.indexOf("custom_")?t.push(e.baseCode):t.push(e.baseCode+"_"+a);return t},ugmp.baseMap.uGisBaseMapDefault.prototype.getSyncData=function(e){this._this;var t=e.target;return t instanceof ol.Map&&(t=t.getView()),{view:t,center:t.getCenter(),projection:t.getProjection(),resolution:t.getResolution(),zoom:Math.round(t.getZoom())}},ugmp.baseMap.uGisBaseMapDefault.prototype.isAvailables=function(){return(this._this||this).isAvailable},ugmp.baseMap.uGisBaseMapDefault.prototype.isWorlds=function(){return(this._this||this).isWorld},ugmp.baseMap.uGisBaseMapDefault.prototype.isFactors=function(){return(this._this||this).isFactor}}(),function(){"use strict";ugmp.baseMap.uGisBaseMap=function(t){var i=this;return this.target=null,this.uGisMap=null,this.nowMapView=null,this.baseMapList=null,this.nowBaseMapKey=null,this.key_zoomEnd=null,this.key_changeCenter=null,this.key_changeResolution=null,function(){var e=t||{};if(i.target=void 0!==e.target?e.target:void 0,i.uGisMap=void 0!==e.uGisMap?e.uGisMap:void 0,i.nowBaseMapKey=void 0!==e.baseMapKey?e.baseMapKey:"osm_normal",!i.uGisMap)return ugmp.uGisConfig.alert_Error("uGisMap undefined");i.addBaseMapType("osm",new ugmp.baseMap.uGisBaseMapOSM),i.addBaseMapType("daum",new ugmp.baseMap.uGisBaseMapDaum),i.addBaseMapType("naver",new ugmp.baseMap.uGisBaseMapNaver),i.addBaseMapType("vWorld",new ugmp.baseMap.uGisBaseMapVWorld),i.addBaseMapType("baroEmap",new ugmp.baseMap.uGisBaseMapBaroEmap),i.addBaseMapType("stamen",new ugmp.baseMap.uGisBaseMapStamen),i.addBaseMapType("google",new ugmp.baseMap.uGisBaseMapGoogle),i.callBaseMapType(i.nowBaseMapKey),i.setVisible(!0)}(),{_this:i,remove:i.remove,getVisible:i.getVisible,setVisible:i.setVisible,getOpacity:i.getOpacity,setOpacity:i.setOpacity,visibleToggle:i.visibleToggle,changeBaseMap:i.changeBaseMap,addBaseMapType:i.addBaseMapType,getSelectedBaseMap:i.getSelectedBaseMap,getUsableBaseMapList:i.getUsableBaseMapList}},ugmp.baseMap.uGisBaseMap.prototype.callBaseMapType=function(e){var t=this._this||this;if(!t._isBaseMapUsable(e))return ugmp.uGisConfig.alert_Error(e+" undefined"),!1;var i=e.split("_")[0],a=e.split("_")[1];-1<i.indexOf("custom")&&(a=i=e);var o=t.baseMapList[i].object,r=o.getTypeProperties(a);o.createBaseMap(t.target,a);var n=t._createView(o,a);t._activeChangeResolution(o),t._transformLayerProjection(t.uGisMap.getMap().getView().getProjection().getCode(),r.projection),t.uGisMap.getMap().setView(n),n.setCenter([n.getCenter()[0]+5,n.getCenter()[1]]),n.setCenter([n.getCenter()[0]-5,n.getCenter()[1]]),_$("#"+t.target).resize(function(){o.updateSize&&o.updateSize()}),_$(window).resize(function(){t._updateSize&&t._updateSize()})},ugmp.baseMap.uGisBaseMap.prototype._activeChangeResolution=function(a){var o=this._this||this,r=null,e=o.uGisMap.getMap().getView();function t(e){var t=e,i=function(e){var t=e.map.getView().getZoom();r!=t&&(r=t,a.syncMapFunc(e)),o.key_zoomEnd=o.uGisMap.getMap().once("moveend",function(e){i(e)})};o.key_changeResolution=t.once("change:resolution",function(e){o.uGisMap.getMap().once("moveend",function(e){i(e)})})}o.uGisMap.getMap().on("change:view",function(e){ol.Observable.unByKey(o.key_zoomEnd),ol.Observable.unByKey(o.key_changeCenter),ol.Observable.unByKey(o.key_changeResolution),o.key_changeCenter=e.target.getView().on("change:center",a.syncMapFunc),t(e.target.getView())}),t(e)},ugmp.baseMap.uGisBaseMap.prototype.addBaseMapType=function(e,t){var i=this._this||this;i.baseMapList=i.baseMapList||{},t&&t.isAvailables()&&(i.baseMapList[e]={code:e,object:t})},ugmp.baseMap.uGisBaseMap.prototype._createView=function(e,t){var i=this._this||this,a=e.getTypeProperties(t),o=i.uGisMap.getMap().getView(),r={projection:a.projection,extent:a.maxExtent,center:ol.proj.transform(o.getCenter(),o.getProjection(),a.projection),zoom:o.getZoom(),minZoom:a.minZoom,maxZoom:a.maxZoom};return t.indexOf("custom"),a.resolutions&&(r.resolutions=a.resolutions),i.nowMapView=new ol.View(r),i.nowMapView},ugmp.baseMap.uGisBaseMap.prototype._transformLayerProjection=function(e,t){var i=(this._this||this).uGisMap.getMap().getLayers().getArray();for(var a in i)if(i[a]instanceof ol.layer.Group){var o=i[a].getLayersArray();for(var r in o)n(o[r],e,t)}else n(i[a],e,t);function n(e,t,i){var a=e.getSource();if(a instanceof ol.source.TileWMS||a instanceof ol.source.ImageWMS)"EPSG:4326"===i&&(a.getParams().VERSION="1.1.0",a.updateParams(a.getParams()));else if(a instanceof ol.source.Vector){var o=a.getFeatures();for(var r in o)o[r].getGeometry().transform(t,i)}}},ugmp.baseMap.uGisBaseMap.prototype._updateSize=function(){var e=this._this||this,t=e.nowBaseMapKey.split("_")[0];e.nowBaseMapKey.split("_")[1];-1<t.indexOf("custom")&&(t=e.nowBaseMapKey,e.nowBaseMapKey),e.baseMapList[t].object.updateSize()},ugmp.baseMap.uGisBaseMap.prototype._isBaseMapUsable=function(e){var t=this._this||this,i=!0,a=e.split("_")[0];e.split("_")[1];(-1<a.indexOf("custom")&&(a=e),t.baseMapList[a])?-1===t.baseMapList[a].object.getUsableKeys().indexOf(e)&&(i=!1):i=!1;return i},ugmp.baseMap.uGisBaseMap.prototype.changeBaseMap=function(e){var t=this._this||this;if(e===t.nowBaseMapKey)return!1;if(!t._isBaseMapUsable(e))return ugmp.uGisConfig.alert_Error(e+" undefined"),!1;var i=t.nowBaseMapKey.split("_")[0],a=t.nowBaseMapKey.split("_")[1],o=e.split("_")[0],r=e.split("_")[1];-1<i.indexOf("custom")&&(i=t.nowBaseMapKey,a=t.nowBaseMapKey),-1<o.indexOf("custom")&&(r=o=e);var n=t.baseMapList[i].object,s=t.baseMapList[o].object,u=n.getTypeProperties(a),l=s.getTypeProperties(r);if(i===o&&a!==r){s.setMapType(r),(m=t.nowMapView).setMinZoom(l.minZoom),m.setMaxZoom(l.maxZoom)}else{var p=t.nowMapView.calculateExtent(t.uGisMap.getMap().getSize()),c=u.projection,g=l.projection;u.zoomCount,l.zoomCount;document.getElementById(t.target).innerHTML="",document.getElementById(t.target).style.background="",s.createBaseMap(t.target,r);var m=t._createView(s,r);if(t._activeChangeResolution(s),ol.proj.equivalent(ol.proj.get(c),ol.proj.get(g))||t._transformLayerProjection(c,g),t.uGisMap.getMap().setView(m),n.isWorlds()){if(!s.isWorlds()){var y=l.maxExtent;y=ol.proj.transformExtent(y,g,"EPSG:3857"),p=ol.proj.transformExtent(p,c,"EPSG:3857"),ol.extent.containsExtent(y,p)?(m.fit(ol.proj.transformExtent(p,"EPSG:3857",g)),s.isFactors()&&m.setZoom(m.getZoom()+1)):m.fit(l.maxExtent)}}else m.fit(ol.proj.transformExtent(p,c,g)),s.isFactors()&&m.setZoom(m.getZoom()+1)}m.setCenter([m.getCenter()[0]+5,m.getCenter()[1]]),m.setCenter([m.getCenter()[0]-5,m.getCenter()[1]]),t.nowBaseMapKey=e,console.log("### changeBaseMap ###"),console.log("baseMapType : "+t.nowBaseMapKey),console.log("View : "),console.log(m)},ugmp.baseMap.uGisBaseMap.prototype.getUsableBaseMapList=function(){var e=this._this||this,t=[];for(var i in e.baseMapList)t=t.concat(e.baseMapList[i].object.getUsableKeys());return t},ugmp.baseMap.uGisBaseMap.prototype.remove=function(e){var t=this._this||this;if(-1<e.split("_")[0].indexOf("custom")){if(t.nowBaseMapKey===e)for(var i in t.baseMapList)if(t.baseMapList.hasOwnProperty(i)){var a=t.baseMapList[i].object.getUsableKeys()[0];t.changeBaseMap(a);break}delete t.baseMapList[e]}return t.getUsableBaseMapList()},ugmp.baseMap.uGisBaseMap.prototype.getSelectedBaseMap=function(){return(this._this||this).nowBaseMapKey},ugmp.baseMap.uGisBaseMap.prototype.getOpacity=function(e){var t=this._this||this;return document.getElementById(t.target).style.opacity},ugmp.baseMap.uGisBaseMap.prototype.setOpacity=function(e){var t=this._this||this,i=document.getElementById(t.target);"number"==typeof e&&(i.style.opacity=e)},ugmp.baseMap.uGisBaseMap.prototype.getVisible=function(){var e=this._this||this;return"visible"===document.getElementById(e.target).style.visibility},ugmp.baseMap.uGisBaseMap.prototype.setVisible=function(e){var t=this._this||this,i="visible";"boolean"==typeof e&&(e||(i="hidden")),document.getElementById(t.target).style.visibility=i},ugmp.baseMap.uGisBaseMap.prototype.visibleToggle=function(){var e=this._this||this;"visible"===document.getElementById(e.target).style.visibility?e.setVisible(!1):e.setVisible(!0)}}(),function(){"use strict";ugmp.baseMap.uGisBaseMapBaroEmap=function(t){var o=this,i=null;return this.resolutions=null,function(){var e=t||{};if(i=ugmp.baseMap.uGisBaseMapDefault.call(o,e),o.checkIsAvailable("ngii.version"),!o.isAvailables())return;o.resolutions=[1954.597389,977.2986945,488.64934725,244.324673625,122.1623368125,61.08116840625,30.540584203125,15.2702921015625,7.63514605078125,3.817573025390625,1.9087865126953125,.9543932563476563,.47719662817382813,.23859831408691407],e.isWorld=!1,e.isFactor=!1,e.baseCode="baroEmap",e.projection="EPSG:5179",e.maxExtent=ol.proj.get("EPSG:5179").getExtent(),e.mapTypes={normal:{id:0,minZoom:0,maxZoom:12},white:{id:4,minZoom:0,maxZoom:12},colorVision:{id:1,minZoom:0,maxZoom:12}},o.init(e)}(),ugmp.util.uGisUtil.objectMerge(i,{_this:o,syncMapFunc:function(e){var t=o.getSyncData(e),i=new OpenLayers.LonLat(t.center[0],t.center[1]),a=t.zoom;o.apiMap.setCenter(i,a,!1,!1)}})},ugmp.baseMap.uGisBaseMapBaroEmap.prototype=Object.create(ugmp.baseMap.uGisBaseMapDefault.prototype),ugmp.baseMap.uGisBaseMapBaroEmap.prototype.constructor=ugmp.baseMap.uGisBaseMapBaroEmap,ugmp.baseMap.uGisBaseMapBaroEmap.prototype.createBaseMap=function(e,t){var i=this._this||this;i.apiMap=new ngii.map(e),i.setMapType(t)},ugmp.baseMap.uGisBaseMapBaroEmap.prototype.setMapType=function(e){var t=this._this||this,i=e;t.mapTypes[i]||(i="normal"),t.apiMap._setMapMode(t.mapTypes[i].id)},ugmp.baseMap.uGisBaseMapBaroEmap.prototype.updateSize=function(){(this._this||this).apiMap.updateSize()},ugmp.baseMap.uGisBaseMapBaroEmap.prototype.getTypeProperties=function(e){var t=this._this||this,i=ugmp.baseMap.uGisBaseMapDefault.prototype.getTypeProperties.call(this,e);return ugmp.util.uGisUtil.objectMerge(i,{resolutions:t.resolutions})}}(),function(){"use strict";ugmp.baseMap.uGisBaseMapCustom=function(n){var s=this,u=null;return this.resolutions=null,this.capabilities=null,this.uWMTSLayer=null,function(){var e=n||{};if(u=ugmp.baseMap.uGisBaseMapDefault.call(s,e),s.checkIsAvailable(""),s.capabilities=void 0!==e.capabilities?e.capabilities:void 0,s.uWMTSLayer=void 0!==e.uWMTSLayer?e.uWMTSLayer:void 0,!s.capabilities)return ugmp.uGisConfig.alert_Error("capabilities undefined"),s.isAvailable=!1;if(!s.uWMTSLayer)return ugmp.uGisConfig.alert_Error("uWMTSLayer undefined"),s.isAvailable=!1;if(!s.isAvailable)return;e.isWorld=void 0===e.isWorld||e.isWorld,e.isFactor=void 0===e.isFactor||e.isFactor,e.baseCode=void 0!==e.baseMapKey?e.baseMapKey:"custom_code",e.projection=s.capabilities.serviceMetaData.crs,-1<e.projection.indexOf("urn:ogc:def:crs:EPSG:")&&(e.projection=e.projection.replace("urn:ogc:def:crs:EPSG:","EPSG"));var t=s.capabilities.olJson.Contents.Layer;for(var i in t)if(t[i].Identifier===s.uWMTSLayer.layer){e.maxExtent=ol.proj.transformExtent(t[i].WGS84BoundingBox,"EPSG:4326",e.projection);break}var a=s.capabilities.olJson.Contents.TileMatrixSet;for(var i in a)if(a[i].Identifier===s.uWMTSLayer.matrixSet){s.resolutions=[];var o=a[i].TileMatrix;for(var r in o)s.resolutions.push(264583e-9*o[r].ScaleDenominator);e.mapTypes={},e.mapTypes[e.baseCode]={id:e.baseCode,minZoom:0,resolutions:s.resolutions,maxZoom:a[i].TileMatrix.length-1};break}s.init(e)}(),ugmp.util.uGisUtil.objectMerge(u,{_this:s,syncMapFunc:function(e){var t=s.getSyncData(e),i=ol.proj.transform(t.center,t.projection,s.projection),a=t.zoom;s.apiMap.getView().setZoom(a),s.apiMap.getView().setCenter(i)}})},ugmp.baseMap.uGisBaseMapCustom.prototype=Object.create(ugmp.baseMap.uGisBaseMapDefault.prototype),ugmp.baseMap.uGisBaseMapCustom.prototype.constructor=ugmp.baseMap.uGisBaseMapCustom,ugmp.baseMap.uGisBaseMapCustom.prototype.createBaseMap=function(e,t){var i=this._this||this;i.apiMap=new ol.Map({layers:[],controls:[],interactions:[],target:e,projection:i.projection,view:new ol.View({zoom:2,center:[0,0],projection:i.projection,minZoom:i.mapTypes[t].minZoom,maxZoom:i.mapTypes[t].maxZoom,resolutions:i.mapTypes[t].resolutions})}),i.setMapType(t)},ugmp.baseMap.uGisBaseMapCustom.prototype.setMapType=function(e){var t=this._this||this;t.uWMTSLayer.setWmtsCapabilities(t.capabilities),t.uWMTSLayer.update(!0),t.apiMap.addLayer(t.uWMTSLayer.getOlLayer())},ugmp.baseMap.uGisBaseMapCustom.prototype.updateSize=function(){(this._this||this).apiMap.updateSize()},ugmp.baseMap.uGisBaseMapCustom.prototype.getTypeProperties=function(e){var t=this._this||this,i=ugmp.baseMap.uGisBaseMapDefault.prototype.getTypeProperties.call(this,e);return ugmp.util.uGisUtil.objectMerge(i,{resolutions:t.resolutions})}}(),function(){"use strict";ugmp.baseMap.uGisBaseMapDaum=function(t){var o=this,i=null;return function(){var e=t||{};if(i=ugmp.baseMap.uGisBaseMapDefault.call(o,e),o.checkIsAvailable("daum.maps.MapTypeId"),!o.isAvailable)return;e.isWorld=!1,e.isFactor=!1,e.baseCode="daum",e.projection="EPSG:5181",e.maxExtent=ol.proj.get("EPSG:5181").getExtent(),e.mapTypes={normal:{id:daum.maps.MapTypeId.NORMAL,minZoom:1,maxZoom:14},satellite:{id:daum.maps.MapTypeId.SKYVIEW,minZoom:1,maxZoom:15},hybrid:{id:daum.maps.MapTypeId.HYBRID,minZoom:1,maxZoom:15}},o.init(e)}(),ugmp.util.uGisUtil.objectMerge(i,{_this:o,syncMapFunc:function(e){var t=o.getSyncData(e),i=ol.proj.transform(t.center,t.projection,"EPSG:4326"),a=15-t.zoom;o.apiMap.setLevel(a),o.apiMap.setCenter(new daum.maps.LatLng(i[1],i[0])),o.apiMap.relayout()}})},ugmp.baseMap.uGisBaseMapDaum.prototype=Object.create(ugmp.baseMap.uGisBaseMapDefault.prototype),ugmp.baseMap.uGisBaseMapDaum.prototype.constructor=ugmp.baseMap.uGisBaseMapDaum,ugmp.baseMap.uGisBaseMapDaum.prototype.createBaseMap=function(e,t){var i=this._this||this,a=document.getElementById(e),o={center:new daum.maps.LatLng(33.450701,126.570667),level:3};i.apiMap=new daum.maps.Map(a,o),i.setMapType(t)},ugmp.baseMap.uGisBaseMapDaum.prototype.setMapType=function(e){var t=this._this||this,i=e;t.mapTypes[i]||(i="normal"),t.apiMap.setMapTypeId(t.mapTypes[i].id)},ugmp.baseMap.uGisBaseMapDaum.prototype.updateSize=function(){(this._this||this).apiMap.relayout()}}(),function(){"use strict";ugmp.baseMap.uGisBaseMapGoogle=function(t){var o=this,i=null;return function(){var e=t||{};if(i=ugmp.baseMap.uGisBaseMapDefault.call(o,e),o.checkIsAvailable("google.maps.MapTypeId"),!o.isAvailables())return;e.isWorld=!0,e.isFactor=!0,e.baseCode="google",e.projection="EPSG:900913",e.maxExtent=ol.proj.get("EPSG:900913").getExtent(),e.mapTypes={normal:{id:google.maps.MapTypeId.ROADMAP,minZoom:0,maxZoom:21},satellite:{id:google.maps.MapTypeId.SATELLITE,minZoom:0,maxZoom:19},hybrid:{id:google.maps.MapTypeId.HYBRID,minZoom:0,maxZoom:19}},o.init(e)}(),ugmp.util.uGisUtil.objectMerge(i,{_this:o,syncMapFunc:function(e){var t=o.getSyncData(e),i=ol.proj.transform(t.center,t.projection,"EPSG:4326"),a=t.zoom;o.apiMap.setZoom(a),o.apiMap.setCenter({lat:i[1],lng:i[0]})}})},ugmp.baseMap.uGisBaseMapGoogle.prototype=Object.create(ugmp.baseMap.uGisBaseMapDefault.prototype),ugmp.baseMap.uGisBaseMapGoogle.prototype.constructor=ugmp.baseMap.uGisBaseMapGoogle,ugmp.baseMap.uGisBaseMapGoogle.prototype.createBaseMap=function(e,t){var i=this._this||this;i.apiMap=new google.maps.Map(document.getElementById(e),{zoom:4,center:{lat:-33,lng:151},disableDefaultUI:!0}),i.setMapType(t)},ugmp.baseMap.uGisBaseMapGoogle.prototype.setMapType=function(e){var t=this._this||this,i=e;t.mapTypes[i]||(i="normal"),t.apiMap.setMapTypeId(t.mapTypes[i].id)},ugmp.baseMap.uGisBaseMapGoogle.prototype.updateSize=function(){var e=this._this||this;google.maps.event.trigger(e.apiMap,"resize")}}(),function(){"use strict";ugmp.baseMap.uGisBaseMapNaver=function(t){var o=this,i=null;return function(){var e=t||{};if(i=ugmp.baseMap.uGisBaseMapDefault.call(o,e),o.checkIsAvailable("naver.maps.MapTypeId"),!o.isAvailable)return;e.isWorld=!1,e.isFactor=!1,e.baseCode="naver",e.projection="EPSG:5181",e.maxExtent=ol.proj.get("EPSG:5181").getExtent(),e.mapTypes={normal:{id:naver.maps.MapTypeId.NORMAL,minZoom:1,maxZoom:14},satellite:{id:naver.maps.MapTypeId.SATELLITE,minZoom:1,maxZoom:14},hybrid:{id:naver.maps.MapTypeId.HYBRID,minZoom:1,maxZoom:14}},o.init(e)}(),ugmp.util.uGisUtil.objectMerge(i,{_this:o,syncMapFunc:function(e){var t=o.getSyncData(e),i=ol.proj.transform(t.center,t.projection,"EPSG:4326"),a=t.zoom;o.apiMap.setZoom(a,!1),o.apiMap.setCenter(new naver.maps.LatLng(i[1],i[0]))}})},ugmp.baseMap.uGisBaseMapNaver.prototype=Object.create(ugmp.baseMap.uGisBaseMapDefault.prototype),ugmp.baseMap.uGisBaseMapNaver.prototype.constructor=ugmp.baseMap.uGisBaseMapNaver,ugmp.baseMap.uGisBaseMapNaver.prototype.createBaseMap=function(e,t){var i=this._this||this,a={center:new naver.maps.LatLng(37.3595704,127.105399),level:3};i.apiMap=new naver.maps.Map(e,a),i.setMapType(t)},ugmp.baseMap.uGisBaseMapNaver.prototype.setMapType=function(e){var t=this._this||this,i=e;t.mapTypes[i]||(i="normal"),t.apiMap.setMapTypeId(t.mapTypes[i].id)},ugmp.baseMap.uGisBaseMapNaver.prototype.updateSize=function(){(this._this||this).apiMap.trigger("resize")}}(),function(){"use strict";ugmp.baseMap.uGisBaseMapOSM=function(i){var o=this,a=null;return function(){var e=i||{};a=ugmp.baseMap.uGisBaseMapDefault.call(o,e);var t="http://{a-c}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png";if(ugmp.uGisConfig.isMapProxy()&&(t=ugmp.uGisConfig.getProxy()+t),o.checkIsAvailable("new ol.layer.Tile"),!o.isAvailable)return;e.isWorld=!0,e.isFactor=!0,e.baseCode="osm",e.projection="EPSG:3857",e.maxExtent=ol.proj.get("EPSG:3857").getExtent(),e.mapTypes={normal:{id:"normal",layer:new ol.layer.Tile({source:new ol.source.OSM}),minZoom:0,maxZoom:21},gray:{id:"gray",layer:new ol.layer.Tile({source:new ol.source.XYZ({url:t})}),minZoom:0,maxZoom:18},none:{id:"none",layer:new ol.layer.Tile,minZoom:0,maxZoom:21}},o.init(e)}(),ugmp.util.uGisUtil.objectMerge(a,{_this:o,syncMapFunc:function(e){var t=o.getSyncData(e),i=ol.proj.transform(t.center,t.projection,"EPSG:3857"),a=t.zoom;o.apiMap.getView().setZoom(a),o.apiMap.getView().setCenter(i)}})},ugmp.baseMap.uGisBaseMapOSM.prototype=Object.create(ugmp.baseMap.uGisBaseMapDefault.prototype),ugmp.baseMap.uGisBaseMapOSM.prototype.constructor=ugmp.baseMap.uGisBaseMapOSM,ugmp.baseMap.uGisBaseMapOSM.prototype.createBaseMap=function(e,t){var i=this._this||this;i.apiMap=new ol.Map({layers:[],controls:[],interactions:[],target:e,view:new ol.View({center:[0,0],zoom:2})}),i.setMapType(t)},ugmp.baseMap.uGisBaseMapOSM.prototype.setMapType=function(e){var t=this._this||this,i=e;t.mapTypes[i]||(i="normal"),t._removeAllLayer(t.apiMap.getLayers()),t.apiMap.addLayer(t.mapTypes[i].layer)},ugmp.baseMap.uGisBaseMapOSM.prototype.updateSize=function(){(this._this||this).apiMap.updateSize()},ugmp.baseMap.uGisBaseMapOSM.prototype._removeAllLayer=function(e){var i=this._this||this;e.forEach(function(e,t){i.apiMap.removeLayer(e)}),0<i.apiMap.getLayers().getLength()&&i._removeAllLayer(i.apiMap.getLayers())}}(),function(){"use strict";ugmp.baseMap.uGisBaseMapStamen=function(t){var o=this,i=null;return function(){var e=t||{};if(i=ugmp.baseMap.uGisBaseMapDefault.call(o,e),o.checkIsAvailable("ol.source.Stamen"),!o.isAvailable)return;e.isWorld=!0,e.isFactor=!0,e.baseCode="stamen",e.projection="EPSG:3857",e.maxExtent=ol.proj.get("EPSG:3857").getExtent(),e.mapTypes={toner:{id:"toner",layer:function(){return new ol.layer.Tile({source:new ol.source.Stamen({layer:"toner"})})},minZoom:0,maxZoom:18},terrain:{id:"terrain",layer:function(){return new ol.layer.Tile({source:new ol.source.Stamen({layer:"terrain"})})},minZoom:0,maxZoom:18}},o.init(e)}(),ugmp.util.uGisUtil.objectMerge(i,{_this:o,syncMapFunc:function(e){var t=o.getSyncData(e),i=ol.proj.transform(t.center,t.projection,"EPSG:3857"),a=t.zoom;o.apiMap.getView().setZoom(a),o.apiMap.getView().setCenter(i)}})},ugmp.baseMap.uGisBaseMapStamen.prototype=Object.create(ugmp.baseMap.uGisBaseMapDefault.prototype),ugmp.baseMap.uGisBaseMapStamen.prototype.constructor=ugmp.baseMap.uGisBaseMapStamen,ugmp.baseMap.uGisBaseMapStamen.prototype.createBaseMap=function(e,t){var i=this._this||this;i.apiMap=new ol.Map({layers:[],controls:[],interactions:[],target:e,view:new ol.View({center:[0,0],zoom:2})}),i.setMapType(t)},ugmp.baseMap.uGisBaseMapStamen.prototype.setMapType=function(e){var t=this._this||this,i=e;t.mapTypes[i]||(i="toner"),t._removeAllLayer(t.apiMap.getLayers()),t.apiMap.addLayer(t.mapTypes[i].layer())},ugmp.baseMap.uGisBaseMapStamen.prototype.updateSize=function(){(this._this||this).apiMap.updateSize()},ugmp.baseMap.uGisBaseMapStamen.prototype._removeAllLayer=function(e){var i=this._this||this;e.forEach(function(e,t){i.apiMap.removeLayer(e)}),0<i.apiMap.getLayers().getLength()&&i._removeAllLayer(i.apiMap.getLayers())}}(),function(){"use strict";ugmp.baseMap.uGisBaseMapVWorld=function(t){var o=this,i=null;return function(){var e=t||{};if(i=ugmp.baseMap.uGisBaseMapDefault.call(o,e),o.checkIsAvailable("vworld.Layers.Base"),!o.isAvailable)return;e.isWorld=!1,e.isFactor=!0,e.baseCode="vWorld",e.projection="EPSG:900913",e.maxExtent=[12873319.534819111,3857406.4178978344,15494719.534819111,5166406.417897834],e.mapTypes={normal:{id:"VBASE",layer:function(){return[new vworld.Layers.Base("VBASE")]},minZoom:6,maxZoom:19},satellite:{id:"SATELLITE",layer:function(){var e=new vworld.Layers.Satellite("VSAT");return e.max_level=19,[e]},minZoom:6,maxZoom:19},hybrid:{id:"VHYBRID",layer:function(){var e=new vworld.Layers.Satellite("VSAT"),t=new vworld.Layers.Hybrid("VHYBRID");return e.max_level=19,t.max_level=19,[e,t]},minZoom:6,maxZoom:19},gray:{id:"VGRAY",layer:function(){return[new vworld.Layers.Gray("VGRAY")]},minZoom:6,maxZoom:18},midnight:{id:"VMIDNIGHT",layer:function(){return[new vworld.Layers.Midnight("VMIDNIGHT")]},minZoom:6,maxZoom:18}},o.init(e)}(),ugmp.util.uGisUtil.objectMerge(i,{_this:o,syncMapFunc:function(e){var t=o.getSyncData(e),i=ol.proj.transform(t.center,t.projection,"EPSG:900913");i=new OpenLayers.LonLat(t.center[0],t.center[1]);var a=t.zoom;o.apiMap.setCenter(i,a,!1,!1)}})},ugmp.baseMap.uGisBaseMapVWorld.prototype=Object.create(ugmp.baseMap.uGisBaseMapDefault.prototype),ugmp.baseMap.uGisBaseMapVWorld.prototype.constructor=ugmp.baseMap.uGisBaseMapVWorld,ugmp.baseMap.uGisBaseMapVWorld.prototype.createBaseMap=function(e,t){var i=this._this||this,a={units:"m",controls:[],numZoomLevels:21,projection:new OpenLayers.Projection("EPSG:900913"),displayProjection:new OpenLayers.Projection("EPSG:900913")};i.apiMap=new OpenLayers.Map(e,a),i.setMapType(t)},ugmp.baseMap.uGisBaseMapVWorld.prototype.setMapType=function(e){var t=this._this||this,i=e;t.mapTypes[i]||(i="normal"),t._removeAllLayer(t.apiMap.layers);var a=t.mapTypes[i].layer();for(var o in a)t.apiMap.addLayer(a[o])},ugmp.baseMap.uGisBaseMapVWorld.prototype.updateSize=function(){(this._this||this).apiMap.updateSize()},ugmp.baseMap.uGisBaseMapVWorld.prototype._removeAllLayer=function(e){var i=this._this||this;e.forEach(function(e,t){i.apiMap.removeLayer(e)}),0<i.apiMap.layers.length&&i._removeAllLayer(i.apiMap.layers)}}(),function(){"use strict";ugmp.animation.featureAnimationDefault=function(e){var t,i=this;return this.easing=null,this.repeat=null,this.useFade=null,this.duration=null,this.style=null,this.isStop=null,this.strokeStyle=null,this.animationType=null,t=e||{},i.animationType="string"==typeof t.animationType?t.animationType:"zoomIn",i.setEasing(t.easing),i.setRepeat(t.repeat),i.setUseFade(t.useFade),i.setDuration(t.duration),{animate:i.animate,setStyle:i.setStyle,setRepeat:i.setRepeat,setUseFade:i.setUseFade,setDuration:i.setDuration,setStrokeStyle:i.setStrokeStyle,getProperties:i.getProperties}},ugmp.animation.featureAnimationDefault.prototype.animate=function(e){return!1},ugmp.animation.featureAnimationDefault.prototype.setEasing=function(e){(this._this||this).easing="string"==typeof e?ol.easing[e]:ol.easing.linear},ugmp.animation.featureAnimationDefault.prototype.setRepeat=function(e){(this._this||this).repeat="number"==typeof e&&0<=e?e:1e4},ugmp.animation.featureAnimationDefault.prototype.setUseFade=function(e){(this._this||this).useFade="boolean"!=typeof e||e},ugmp.animation.featureAnimationDefault.prototype.setDuration=function(e){(this._this||this).duration="number"==typeof e&&0<=e?e:2e3},ugmp.animation.featureAnimationDefault.prototype.setStyle=function(e){(this._this||this).style=e},ugmp.animation.featureAnimationDefault.prototype.setStrokeStyle=function(e){var t=this._this||this,i=new ol.style.Style({stroke:e});t.strokeStyle=i},ugmp.animation.featureAnimationDefault.prototype.drawGeom=function(e,t){var i=this._this||this;i.useFade?e.context.globalAlpha=ol.easing.easeIn(e.elapsed):e.context.globalAlpha=1;for(var a=i.style,o=0;o<a.length;o++){var r=0,n=!ol.Map.prototype.getFeaturesAtPixel&&a[o].getImage();n&&(r=n.getScale(),n.setScale(e.frameState.pixelRatio*r)),e.vectorContext.setStyle(a[o]),e.vectorContext.drawGeometry(t),n&&n.setScale(r)}},ugmp.animation.featureAnimationDefault.prototype.getProperties=function(){var e=this._this||this;return{repeat:e.repeat,useFade:e.useFade,duration:e.duration,animationType:e.animationType}}}(),function(){"use strict";ugmp.animation.bounceAnimation=function(e){var t,i=this,a=null;return this.bounce=null,this.amplitude=null,(t=e||{}).animationType="bounce",i.setBounce(t.bounce),i.setAmplitude(t.amplitude),a=ugmp.animation.featureAnimationDefault.call(i,t),ugmp.util.uGisUtil.objectMerge(a,{_this:i,setBounce:i.setBounce,setAmplitude:i.setAmplitude})},ugmp.animation.bounceAnimation.prototype=Object.create(ugmp.animation.featureAnimationDefault.prototype),ugmp.animation.bounceAnimation.prototype.constructor=ugmp.animation.bounceAnimation,ugmp.animation.bounceAnimation.prototype.setBounce=function(e){(this._this||this).bounce="number"==typeof e&&0<=e?e:3},ugmp.animation.bounceAnimation.prototype.setAmplitude=function(e){(this._this||this).amplitude="number"==typeof e&&0<=e?e:40},ugmp.animation.bounceAnimation.prototype.animate=function(e){var t=this._this||this,i=e.frameState.extent;if(ol.extent.intersects(i,e.bbox)){var a=-Math.PI*t.bounce,o=e.geom.clone(),r=Math.abs(Math.sin(a*e.elapsed))*t.amplitude*(1-t.easing(e.elapsed))*e.frameState.viewState.resolution;o.translate(0,r),t.drawGeom(e,o)}return e.time<=t.duration},ugmp.animation.bounceAnimation.prototype.getProperties=function(){var e=this._this||this,t=ugmp.animation.featureAnimationDefault.prototype.getProperties.call(this);return ugmp.util.uGisUtil.objectMerge(t,{bounce:e.bounce,amplitude:e.amplitude})}}(),function(){"use strict";ugmp.animation.dropAnimation=function(e){var t,i=this,a=null;return this.side=null,(t=e||{}).animationType="drop",i.setSide(t.side),a=ugmp.animation.featureAnimationDefault.call(i,t),ugmp.util.uGisUtil.objectMerge(a,{_this:i,setSide:i.setSide})},ugmp.animation.dropAnimation.prototype=Object.create(ugmp.animation.featureAnimationDefault.prototype),ugmp.animation.dropAnimation.prototype.constructor=ugmp.animation.dropAnimation,ugmp.animation.dropAnimation.prototype.setSide=function(e){(this._this||this).side="string"==typeof e?e:"top"},ugmp.animation.dropAnimation.prototype.animate=function(e){var t=this._this||this,i=e.frameState.extent;if(ol.extent.intersects(i,e.bbox)){var a;"top"==t.side?a=e.extent[3]-e.bbox[1]:"bottom"==t.side&&(a=e.extent[1]-e.bbox[3]);var o=e.geom.clone();o.translate(0,a*(1-t.easing(e.elapsed))),t.drawGeom(e,o)}return e.time<=t.duration},ugmp.animation.dropAnimation.prototype.getProperties=function(){var e=this._this||this,t=ugmp.animation.featureAnimationDefault.prototype.getProperties.call(this);return ugmp.util.uGisUtil.objectMerge(t,{side:e.side})}}(),function(){"use strict";ugmp.animation.lineDashMoveAnimation=function(e){var t,i=this,a=null;return this.reverse=null,this.currentOffset=null,(t=e||{}).animationType="lineDashMove",i.currentOffset=0,a=ugmp.animation.featureAnimationDefault.call(i,t),ugmp.util.uGisUtil.objectMerge(a,{_this:i,setReverse:i.setReverse})},ugmp.animation.lineDashMoveAnimation.prototype=Object.create(ugmp.animation.featureAnimationDefault.prototype),ugmp.animation.lineDashMoveAnimation.prototype.constructor=ugmp.animation.lineDashMoveAnimation,ugmp.animation.lineDashMoveAnimation.prototype.animate=function(e){var t=this._this||this;if(t.repeat<e.nowNB)return!0;var i=e.frameState.extent;return ol.extent.intersects(i,e.bbox)&&(e.time<=t.duration||t.moveLineDash(),t.customDrawGeom(e,e.geom)),e.time<=t.duration},ugmp.animation.lineDashMoveAnimation.prototype.customDrawGeom=function(e,t){var i=this._this||this;i.useFade?e.context.globalAlpha=ol.easing.easeIn(e.elapsed):e.context.globalAlpha=1;var a=e.vectorContext;e.frameState;a.setStyle(i.lineDashStyle()),a.drawGeometry(t)},ugmp.animation.lineDashMoveAnimation.prototype.lineDashStyle=function(){var e=this._this||this,t=e.strokeStyle;return t.getStroke().setLineDashOffset(e.currentOffset),t},ugmp.animation.lineDashMoveAnimation.prototype.moveLineDash=function(){var e=this._this||this;e.reverse?(e.currentOffset-=10,e.currentOffset<=-100&&(e.currentOffset=0)):(e.currentOffset+=10,100<=e.currentOffset&&(e.currentOffset=0))},ugmp.animation.lineDashMoveAnimation.prototype.setReverse=function(){var e=this._this||this;e.reverse=!e.reverse},ugmp.animation.lineDashMoveAnimation.prototype.getProperties=function(){var e=this._this||this,t=ugmp.animation.featureAnimationDefault.prototype.getProperties.call(this);return ugmp.util.uGisUtil.objectMerge(t,{reverse:e.reverse})}}(),function(){"use strict";ugmp.animation.lineGradientAnimation=function(e){var t,i=this,a=null;return this.lineWidth=null,this.startColor=null,this.endColor=null,this.useSymbol=null,this.symbolIcon=null,this.uGisMap=null,this.uGSUtil=null,this.dummyContext=null,this.symbolSRC=null,this.symbolAnchor=null,(t=e||{}).animationType="lineGradient",a=ugmp.animation.featureAnimationDefault.call(i,t),i.uGisMap=void 0!==t.uGisMap?t.uGisMap:void 0,i.uGSUtil=ugmp.util.uGisGeoSpatialUtil,i.dummyContext=document.createElement("canvas").getContext("2d"),ugmp.util.uGisUtil.objectMerge(a,{_this:i,setStyle:i.setStyle,setUgisMap:i.setUgisMap})},ugmp.animation.lineGradientAnimation.prototype=Object.create(ugmp.animation.featureAnimationDefault.prototype),ugmp.animation.lineGradientAnimation.prototype.constructor=ugmp.animation.lineGradientAnimation,ugmp.animation.lineGradientAnimation.prototype.animate=function(e){var t=this._this||this;if(t.repeat<e.nowNB)return!0;var i=e.frameState.extent;return ol.extent.intersects(i,e.bbox)&&(e.time,t.duration,t.customDrawGeom(e,e.geom)),e.time<=t.duration},ugmp.animation.lineGradientAnimation.prototype.customDrawGeom=function(e,t){var i=this._this||this;i.useFade?e.context.globalAlpha=ol.easing.easeIn(e.elapsed):e.context.globalAlpha=1;for(var a=e.vectorContext,o=(e.frameState,e.cs),r=e.lens,n=e.length*e.elapsed,s=[o[0]],u=1;u<o.length;u++){if(n<=(l=r[u]))break;s.push(o[u])}if(u<o.length){var l,p=(n=(l=r[u])-n)/(l-=r[u-1]),c=o[u-1][0],g=o[u-1][1],m=o[u][0],y=o[u][1],d=[m-(m-c)*p,y-(y-g)*p];s.push(d)}var h=new ol.geom.LineString(s);void 0!==h&&(a.setStyle(i._gradientStyle(new ol.Feature({geometry:h}))),a.drawGeometry(h)),i._createSymbol(a,h)},ugmp.animation.lineGradientAnimation.prototype.setStyle=function(e){var t=this._this||this,i=e||{};if(void 0!==i.lineWidth&&(t.lineWidth=i.lineWidth),void 0!==i.startColor&&(t.startColor=i.startColor),void 0!==i.endColor&&(t.endColor=i.endColor),void 0!==i.useSymbol&&(t.useSymbol=i.useSymbol),void 0!==i.symbolSRC){var a=new Image;a.src=i.symbolSRC,a.onload=function(){var e=new ol.style.Icon({img:a,rotation:0,rotateWithView:!0,imgSize:[this.width,this.height],anchor:i.symbolAnchor});t.symbolIcon=new ol.style.Style({image:e})}}t.style=new ol.style.Style({stroke:new ol.style.Stroke({color:t.startColor,width:t.lineWidth})})},ugmp.animation.lineGradientAnimation.prototype._gradientStyle=function(e){var t,i,a=this._this||this,o=e,r=o.getGeometry().getExtent(),n=o.getGeometry().getFirstCoordinate(),s=ol.extent.getCenter(r),u=a.uGSUtil.getDegreeBtwPoints(n,s);0<=u&&u<90||-90<u&&u<0?(t=ol.extent.getTopLeft(r),i=ol.extent.getTopRight(r)):90===u?(t=ol.extent.getBottomRight(r),i=ol.extent.getTopRight(r)):90<u&&u<180||180===u||-180<u&&u<-90?(t=ol.extent.getTopRight(r),i=ol.extent.getTopLeft(r)):-90===u&&(t=ol.extent.getTopRight(r),i=ol.extent.getBottomRight(r));var l=a.uGisMap.getMap().getPixelFromCoordinate(t),p=a.uGisMap.getMap().getPixelFromCoordinate(i),c=a.dummyContext.createLinearGradient(l[0],l[1],p[0],p[1]);c.addColorStop(0,a.startColor),c.addColorStop(1,a.endColor);var g=a.style;return g.getStroke().setColor(c),g},ugmp.animation.lineGradientAnimation.prototype._createSymbol=function(e,t){var i=this._this||this;if(e&&t){var a=t.getCoordinates(),o=a[a.length-2],r=a[a.length-1],n=new ol.geom.Point(r);if(void 0!==n){if(i.useSymbol&&i.symbolIcon){var s=i.uGSUtil.getRadianBtwPoints(o,r);i.symbolIcon.getImage().setRotation(-s),e.setStyle(i.symbolIcon)}e.drawGeometry(n)}}},ugmp.animation.lineGradientAnimation.prototype.getProperties=function(){this._this;var e=ugmp.animation.featureAnimationDefault.prototype.getProperties.call(this);return ugmp.util.uGisUtil.objectMerge(e,{})},ugmp.animation.lineGradientAnimation.prototype.setUgisMap=function(e){(this._this||this).uGisMap=e}}(),function(){"use strict";ugmp.animation.showAnimation=function(e){var t,i=this,a=null;return(t=e||{}).animationType="show",a=ugmp.animation.featureAnimationDefault.call(i,t),ugmp.util.uGisUtil.objectMerge(a,{_this:i})},ugmp.animation.showAnimation.prototype=Object.create(ugmp.animation.featureAnimationDefault.prototype),ugmp.animation.showAnimation.prototype.constructor=ugmp.animation.showAnimation,ugmp.animation.showAnimation.prototype.animate=function(e){var t=this._this||this,i=e.frameState.extent;return ol.extent.intersects(i,e.bbox)&&t.drawGeom(e,e.geom),e.time<=t.duration},ugmp.animation.showAnimation.prototype.getProperties=function(){this._this;var e=ugmp.animation.featureAnimationDefault.prototype.getProperties.call(this);return ugmp.util.uGisUtil.objectMerge(e,{})}}(),function(){"use strict";ugmp.animation.teleportAnimation=function(e){var t,i=this,a=null;return(t=e||{}).animationType="teleport",a=ugmp.animation.featureAnimationDefault.call(i,t),ugmp.util.uGisUtil.objectMerge(a,{_this:i})},ugmp.animation.teleportAnimation.prototype=Object.create(ugmp.animation.featureAnimationDefault.prototype),ugmp.animation.teleportAnimation.prototype.constructor=ugmp.animation.teleportAnimation,ugmp.animation.teleportAnimation.prototype.animate=function(e){var t=this._this||this,i=t.easing(e.elapsed);if(i){e.context.save();var a=e.frameState.extent;if(ol.extent.intersects(a,e.bbox)){var o=e.frameState.pixelRatio;e.context.globalAlpha=i,e.context.scale(i,1/i);var r=e.frameState.coordinateToPixelTransform,n=(1/i-1)*o*(r[0]*e.coord[0]+r[1]*e.coord[1]+r[4]),s=(i-1)*o*(r[2]*e.coord[0]+r[3]*e.coord[1]+r[5]);e.context.translate(n,s),t.drawGeom(e,e.geom)}e.context.restore()}return e.time<=t.duration},ugmp.animation.teleportAnimation.prototype.getProperties=function(){this._this;var e=ugmp.animation.featureAnimationDefault.prototype.getProperties.call(this);return ugmp.util.uGisUtil.objectMerge(e,{})}}(),function(){"use strict";ugmp.animation.zoomInAnimation=function(e){var t,i=this,a=null;return(t=e||{}).animationType="zoomIn",a=ugmp.animation.featureAnimationDefault.call(i,t),ugmp.util.uGisUtil.objectMerge(a,{_this:i})},ugmp.animation.zoomInAnimation.prototype=Object.create(ugmp.animation.featureAnimationDefault.prototype),ugmp.animation.zoomInAnimation.prototype.constructor=ugmp.animation.zoomInAnimation,ugmp.animation.zoomInAnimation.prototype.animate=function(e){var t=this._this||this,i=t.easing(e.elapsed);if(i){for(var a,o=t.style,r=[],n=0;n<o.length;n++)(a=o[n].getImage())&&(r[n]=a.getScale(),a.setScale(r[n]*i));e.context.save();var s=e.frameState.extent;if(ol.extent.intersects(s,e.bbox)){var u=e.frameState.pixelRatio,l=e.frameState.coordinateToPixelTransform,p=(1/i-1)*u*(l[0]*e.coord[0]+l[1]*e.coord[1]+l[4]),c=(1/i-1)*u*(l[2]*e.coord[0]+l[3]*e.coord[1]+l[5]);e.context.scale(i,i),e.context.translate(p,c),t.drawGeom(e,e.geom)}e.context.restore();for(n=0;n<o.length;n++)(a=o[n].getImage())&&a.setScale(r[n])}return e.time<=t.duration},ugmp.animation.zoomInAnimation.prototype.getProperties=function(){this._this;var e=ugmp.animation.featureAnimationDefault.prototype.getProperties.call(this);return ugmp.util.uGisUtil.objectMerge(e,{})}}(),function(){"use strict";ugmp.animation.zoomOutAnimation=function(e){var t,i=this,a=null;return(t=e||{}).animationType="zoomOut",a=ugmp.animation.featureAnimationDefault.call(i,t),ugmp.util.uGisUtil.objectMerge(a,{_this:i})},ugmp.animation.zoomOutAnimation.prototype=Object.create(ugmp.animation.featureAnimationDefault.prototype),ugmp.animation.zoomOutAnimation.prototype.constructor=ugmp.animation.zoomOutAnimation,ugmp.animation.zoomOutAnimation.prototype.animate=function(e){var t=this._this||this,i=t.easing(e.elapsed);if(i){i=1/i;for(var a,o=t.style,r=[],n=0;n<o.length;n++)(a=o[n].getImage())&&(r[n]=a.getScale(),a.setScale(r[n]*i));e.context.save();var s=e.frameState.extent;if(ol.extent.intersects(s,e.bbox)){var u=e.frameState.pixelRatio,l=e.frameState.coordinateToPixelTransform,p=(1/i-1)*u*(l[0]*e.coord[0]+l[1]*e.coord[1]+l[4]),c=(1/i-1)*u*(l[2]*e.coord[0]+l[3]*e.coord[1]+l[5]);e.context.scale(i,i),e.context.translate(p,c),t.drawGeom(e,e.geom)}e.context.restore();for(n=0;n<o.length;n++)(a=o[n].getImage())&&a.setScale(r[n])}return e.time<=t.duration},ugmp.animation.zoomOutAnimation.prototype.getProperties=function(){this._this;var e=ugmp.animation.featureAnimationDefault.prototype.getProperties.call(this);return ugmp.util.uGisUtil.objectMerge(e,{})}}(),function(){"use strict";ugmp.animation.uGisShapeAnimationDefault=function(a){var u=this;return this.sync=null,this.uGisMap=null,this.features=null,this.originCRS=null,this.list_animation=null,this.isStop=null,this.vectorLayer=null,this.animationType=null,this.transFormFeatures=null,this.list_PostcomposeKey=null,function(){var e=a||{};if(u.sync="boolean"!=typeof e.sync||e.sync,u.uGisMap=void 0!==e.uGisMap?e.uGisMap:void 0,u.features=void 0!==e.features?e.features:[],u.originCRS=void 0!==e.originCRS?e.originCRS:"EPSG:4326",u.list_animation=Array.isArray(e.animations)?e.animations:[],u.animationType="string"==typeof e.animationType?e.animationType:void 0,!u.uGisMap)return ugmp.uGisConfig.alert_Error("uGisMap undefined");u.isStop=!1,u.transFormFeatures=u.features,u.vectorLayer=new ol.layer.Vector({source:new ol.source.Vector}),u.vectorLayer.isStop=u.isStop,u.vectorLayer.animations=u.list_animation,u.uGisMap.getMap().addLayer(u.vectorLayer),u.list_PostcomposeKey=[];var t=ol.proj.get(u.originCRS),i=u.uGisMap.getMap().getView().getProjection();u._transformProjection(t,i),u.uGisMap.getMap().on("change:view",function(e){var t=e.oldValue,i=e.target.getView(),a=t.getProjection(),o=i.getProjection();if(!ol.proj.equivalent(a,o)){for(var r=u.list_PostcomposeKey,n=0;n<r.length;n++){var s=r[n];ol.Observable.unByKey(s)}u._transformProjection(a,o),u.init()}})}(),{stop:u.stop,start:u.start,destroy:u.destroy,getLayer:u.getLayer,getProperties:u.getProperties}},ugmp.animation.uGisShapeAnimationDefault.prototype.init=function(){var l=this._this||this;!function(){for(var e=l.transFormFeatures,t=0;t<e.length;t++){var i=e[t];if(i instanceof ol.Feature){var a=i.getGeometry();if(a instanceof ol.geom.Point||a instanceof ol.geom.LineString||a instanceof ol.geom.Polygon)u(i);else if(a instanceof ol.geom.MultiPoint)for(var o=a.getPoints(),r=0;r<o.length;r++)u(new ol.Feature({geometry:o[r]}));else if(a instanceof ol.geom.MultiLineString){var n=a.getLineStrings();for(r=0;r<n.length;r++)u(new ol.Feature({geometry:n[r]}))}else if(a instanceof ol.geom.MultiPolygon){var s=a.getPolygons();for(r=0;r<s.length;r++)u(new ol.Feature({geometry:s[r]}))}}}function u(e){var t={vectorContext:null,frameState:null,start:0,time:0,elapsed:0,extent:!1,feature:e,geom:e.getGeometry(),typeGeom:e.getGeometry().getType(),bbox:e.getGeometry().getExtent(),coord:ol.extent.getCenter(e.getGeometry().getExtent()),nowNB:0,interval:l.sync?0:Math.floor(1001*Math.random()+500)},i=l.vectorLayer.animateFeature(t);l.list_PostcomposeKey.push(i)}}()},ugmp.animation.uGisShapeAnimationDefault.prototype._transformProjection=function(e,t){var i=this._this||this;if(!ol.proj.equivalent(e,t)){i.transFormFeatures=[];var a,o,r=i.features.slice();for(a=0,o=r.length;a<o;++a){var n=r[a].clone().getGeometry();n&&i.transFormFeatures.push(new ol.Feature({geometry:n.transform(i.originCRS,t)}))}}},ugmp.animation.uGisShapeAnimationDefault.prototype.setStyles=function(e){var t=(this._this||this).list_animation;for(var i in t)t[i].setStyle(e)},ugmp.animation.uGisShapeAnimationDefault.prototype.setStrokeStyle=function(e){var t=(this._this||this).list_animation;for(var i in t)t[i].setStrokeStyle(e)},ugmp.animation.uGisShapeAnimationDefault.prototype.start=function(){(this._this||this).vectorLayer.isStop=!1},ugmp.animation.uGisShapeAnimationDefault.prototype.stop=function(){(this._this||this).vectorLayer.isStop=!0},ugmp.animation.uGisShapeAnimationDefault.prototype.destroy=function(){for(var e=this._this||this,t=e.list_PostcomposeKey,i=0;i<t.length;i++){var a=t[i];ol.Observable.unByKey(a)}e.features=[],e.transFormFeatures=[],e.uGisMap.getMap().removeLayer(e.vectorLayer)},ugmp.animation.uGisShapeAnimationDefault.prototype.getProperties=function(){var e=this._this||this,t=[],i=e.list_animation;for(var a in i)t.push(i[a].getProperties());return{animProperties:t,animationType:e.animationType}},ugmp.animation.uGisShapeAnimationDefault.prototype.getLayer=function(){return(this._this||this).vectorLayer}}(),function(){"use strict";ugmp.animation.uGisCircleAnimation=function(e){var t,i=this,a=null;return(t=e||{}).animationType="uGisCircleAnimation",a=ugmp.animation.uGisShapeAnimationDefault.call(i,t),i.init(),i.setStyle(t.style),ugmp.util.uGisUtil.objectMerge(a,{_this:i,setStyle:i.setStyle})},ugmp.animation.uGisCircleAnimation.prototype=Object.create(ugmp.animation.uGisShapeAnimationDefault.prototype),ugmp.animation.uGisCircleAnimation.prototype.constructor=ugmp.animation.uGisCircleAnimation,ugmp.animation.uGisCircleAnimation.prototype.setStyle=function(e){var t=this._this||this,i=[new ol.style.Style({image:e})];t.setStyles(i)}}(),function(){"use strict";ugmp.animation.uGisLineAnimation=function(e){var t,i=this,a=null;return(t=e||{}).animationType="uGisLineAnimation",a=ugmp.animation.uGisShapeAnimationDefault.call(i,t),i.init(),i.setStyle(t.style),ugmp.util.uGisUtil.objectMerge(a,{_this:i,setStyle:i.setStyle})},ugmp.animation.uGisLineAnimation.prototype=Object.create(ugmp.animation.uGisShapeAnimationDefault.prototype),ugmp.animation.uGisLineAnimation.prototype.constructor=ugmp.animation.uGisLineAnimation,ugmp.animation.uGisLineAnimation.prototype.setStyle=function(e){var t=this._this||this,i=e,a=[new ol.style.Style({stroke:new ol.style.Stroke({color:[0,0,0,0],width:0})}),new ol.style.Style({image:new ol.style.RegularShape({}),stroke:i})];t.setStrokeStyle(i),t.setStyles(a)}}(),function(){"use strict";ugmp.animation.uGisLineGradientAnimation=function(a){var u=this;return this.sync=null,this.uGisMap=null,this.features=null,this.originCRS=null,this.list_animation=null,this.isStop=null,this.vectorLayer=null,this.animationType=null,this.transFormFeatures=null,this.uGSUtil=null,this.dummyContext=null,this.list_PostcomposeKey=null,this.lineWidth=null,this.startColor=null,this.endColor=null,this.useSymbol=null,this.symbolIcon=null,function(){var e=a||{};if(u.sync=void 0===e.sync||e.sync,u.uGisMap=void 0!==e.uGisMap?e.uGisMap:void 0,u.features=void 0!==e.features?e.features:[],u.originCRS=void 0!==e.originCRS?e.originCRS:"EPSG:4326",u.list_animation=Array.isArray(e.animations)?e.animations:[],u.animationType="uGisLineGradientAnimation",!u.uGisMap)return ugmp.uGisConfig.alert_Error("uGisMap undefined");u.isStop=!1,u.transFormFeatures=u.features,u.vectorLayer=new ol.layer.Vector({source:new ol.source.Vector}),u.vectorLayer.isStop=u.isStop,u.vectorLayer.animations=u.list_animation,u.uGisMap.getMap().addLayer(u.vectorLayer),u.list_PostcomposeKey=[],u.uGSUtil=ugmp.util.uGisGeoSpatialUtil,u.dummyContext=document.createElement("canvas").getContext("2d"),u.lineWidth=2,u.startColor="white",u.endColor="black",u.useSymbol=!1;var t=ol.proj.get(u.originCRS),i=u.uGisMap.getMap().getView().getProjection();u._transformProjection(t,i),u._init(),u.setStyle(e.style),u.setUgisMap(u.uGisMap),u.uGisMap.getMap().on("change:view",function(e){var t=e.oldValue,i=e.target.getView(),a=t.getProjection(),o=i.getProjection();if(!ol.proj.equivalent(a,o)){for(var r=u.list_PostcomposeKey,n=0;n<r.length;n++){var s=r[n];ol.Observable.unByKey(s)}u._transformProjection(a,o),u._init()}})}(),{_this:u,start:u.start,stop:u.stop,destroy:u.destroy,setStyle:u.setStyle,getLayer:u.getLayer,getProperties:u.getProperties}},ugmp.animation.uGisLineGradientAnimation.prototype._transformProjection=function(e,t){var i=this._this||this;if(!ol.proj.equivalent(e,t)){i.transFormFeatures=[];var a,o,r=i.features.slice();for(a=0,o=r.length;a<o;++a){var n=r[a].clone().getGeometry();n&&i.transFormFeatures.push(new ol.Feature({geometry:n.transform(i.originCRS,t)}))}}},ugmp.animation.uGisLineGradientAnimation.prototype._init=function(){var s=this._this||this;!function(){for(var e=s.transFormFeatures,t=0;t<e.length;t++){var i=e[t];if(i instanceof ol.Feature){var a=i.getGeometry();if(a instanceof ol.geom.LineString)n(i);else if(a instanceof ol.geom.MultiLineString)for(var o=a.getLineStrings(),r=0;r<o.length;r++)n(new ol.Feature({geometry:o[r]}))}}function n(e){var t={vectorContext:null,frameState:null,start:0,time:0,elapsed:0,extent:!1,feature:e,geom:e.getGeometry(),typeGeom:e.getGeometry().getType(),bbox:e.getGeometry().getExtent(),coord:ol.extent.getCenter(e.getGeometry().getExtent()),nowNB:0,interval:s.sync?0:Math.floor(1001*Math.random()+500)},i=e.getGeometry().getLength(),a=e.getGeometry().getCoordinates(),o=new Array(a.length);o[0]=0;for(var r=1;r<a.length;r++)o[r]=o[r-1]+s.uGSUtil.getDistanceBtwPotins(a[r],a[r-1]);t.length=i,t.cs=a,t.lens=o;var n=s.vectorLayer.animateFeature(t);s.list_PostcomposeKey.push(n)}}()},ugmp.animation.uGisLineGradientAnimation.prototype.setStyle=function(e){var t=(this._this||this).list_animation;for(var i in t)t[i].setStyle(e)},ugmp.animation.uGisLineGradientAnimation.prototype.setUgisMap=function(e){var t=(this._this||this).list_animation;for(var i in t)t[i].setUgisMap(e)},ugmp.animation.uGisLineGradientAnimation.prototype.start=function(){(this._this||this).vectorLayer.isStop=!1},ugmp.animation.uGisLineGradientAnimation.prototype.stop=function(){(this._this||this).vectorLayer.isStop=!0},ugmp.animation.uGisLineGradientAnimation.prototype.destroy=function(){for(var e=this._this||this,t=e.list_PostcomposeKey,i=0;i<t.length;i++){var a=t[i];ol.Observable.unByKey(a)}e.features=null,e.transFormFeatures=null,e.uGisMap.getMap().removeLayer(e.vectorLayer)},ugmp.animation.uGisLineGradientAnimation.prototype.getProperties=function(){var e=this._this||this,t=[],i=e.list_animation;for(var a in i)t.push(i[a].getProperties());return{animationType:e.animationType,animProperties:t}},ugmp.animation.uGisLineGradientAnimation.prototype.getLayer=function(){return(this._this||this).vectorLayer}}(),function(){"use strict";ugmp.animation.uGisPolygonAnimation=function(e){var t,i=this,a=null;return(t=e||{}).animationType="uGisPolygonAnimation",a=ugmp.animation.uGisShapeAnimationDefault.call(i,t),i.init(),i.setStyle(t.style),ugmp.util.uGisUtil.objectMerge(a,{_this:i,setStyle:i.setStyle})},ugmp.animation.uGisPolygonAnimation.prototype=Object.create(ugmp.animation.uGisShapeAnimationDefault.prototype),ugmp.animation.uGisPolygonAnimation.prototype.constructor=ugmp.animation.uGisPolygonAnimation,ugmp.animation.uGisPolygonAnimation.prototype.setStyle=function(e){var t=this._this||this,i=e,a=[new ol.style.Style({stroke:new ol.style.Stroke({color:[0,0,0,0],width:0}),fill:new ol.style.Fill({color:[0,0,0,0]})}),new ol.style.Style({image:new ol.style.RegularShape({}),stroke:i.getStroke(),fill:i.getFill()})];t.setStyles(a)}}(),function(){"use strict";ugmp.animation.uGisRegularShapeAnimation=function(e){var t,i=this,a=null;return(t=e||{}).animationType="uGisRegularShapeAnimation",a=ugmp.animation.uGisShapeAnimationDefault.call(i,t),i.init(),i.setStyle(t.style),ugmp.util.uGisUtil.objectMerge(a,{_this:i,setStyle:i.setStyle})},ugmp.animation.uGisRegularShapeAnimation.prototype=Object.create(ugmp.animation.uGisShapeAnimationDefault.prototype),ugmp.animation.uGisRegularShapeAnimation.prototype.constructor=ugmp.animation.uGisRegularShapeAnimation,ugmp.animation.uGisRegularShapeAnimation.prototype.setStyle=function(e){var t=this._this||this,i=e,a=[new ol.style.Style({image:i})];t.setStyles(a)}}(),function(){"use strict";ugmp.control.uGisControlDefault=function(t){var i=this;return this.uGisMap=null,this.useDragPan=null,this.cursorCssName=null,this.activeChangeListener=null,this.controlKey=null,this.interaction=null,this.compatibleDragPan=null,this.key_activeChangeListener=null,function(){var e=t||{};if(i.uGisMap=void 0!==e.uGisMap?e.uGisMap:void 0,i.useDragPan="boolean"==typeof e.useDragPan&&e.useDragPan,i.cursorCssName=void 0!==e.cursorCssName?e.cursorCssName:void 0,i.activeChangeListener="function"==typeof e.activeChangeListener?e.activeChangeListener:void 0,i.controlKey=ugmp.util.uGisUtil.generateUUID(),!i.uGisMap)ugmp.uGisConfig.alert_Error("uGisMap undefined")}(),{destroy:i.destroy,setActive:i.setActive,getActive:i.getActive,getControlKey:i.getControlKey,getInteraction:i.getInteraction,setActiveChangeListener:i.setActiveChangeListener}},ugmp.control.uGisControlDefault.prototype._init=function(){for(var e=this._this||this,t=e.uGisMap.getMap(),i=t.getInteractions().getArray(),a=i.length-1;0<=a;a--)i[a]instanceof ol.interaction.DragPan&&(i[a].get("uGisDragPan")||t.removeInteraction(i[a]));e.setActiveChangeListener(e.activeChangeListener),t.addInteraction(e.interaction)},ugmp.control.uGisControlDefault.prototype.getControlKey=function(){return(this._this||this).controlKey},ugmp.control.uGisControlDefault.prototype.getInteraction=function(){return(this._this||this).interaction},ugmp.control.uGisControlDefault.prototype.getActive=function(){return(this._this||this).interaction.getActive()},ugmp.control.uGisControlDefault.prototype.setActive=function(e){var t=this._this||this;if(t.interaction.getActive()&&!0===e)return!1;for(var i=t.uGisMap.getMap().getViewport(),a=i.classList,o=0;o<a.length;o++){var r=a[o];0===r.indexOf("cursor")&&i.classList.remove(r)}e?(i.classList.add(t.cursorCssName),t.useDragPan&&(t.compatibleDragPan?t.compatibleDragPan.setActive(!0):(t.compatibleDragPan=new ol.interaction.DragPan({kinetic:!1}),t.compatibleDragPan.set("uGisDragPan",!0),t.uGisMap.getMap().addInteraction(t.compatibleDragPan)))):(i.classList.add("cursor-default"),t.compatibleDragPan&&t.compatibleDragPan.setActive(!1)),t.interaction.setActive(e)},ugmp.control.uGisControlDefault.prototype.setActiveChangeListener=function(e){var t=this._this||this;t.interaction&&"function"==typeof e&&(ol.Observable.unByKey(t.key_activeChangeListener),t.activeChangeListener=e,t.key_activeChangeListener=t.interaction.on("change:active",function(e){t.activeChangeListener.call(this,e.target.getActive())}))},ugmp.control.uGisControlDefault.prototype.destroy=function(){var e=this._this||this;e.setActive(!1),e.uGisMap.getMap().removeInteraction(e.interaction)}}(),function(){"use strict";ugmp.control.uGisDrawFeature=function(e){var t,i,a=this;return this.useSnap=null,this.freehand=null,this.drawType=null,this.featureStyle=null,this.drawingStyle=null,this.useDrawEndDisplay=null,this.vectorLayer=null,this.snapInteraction=null,i=e||{},t=ugmp.control.uGisControlDefault.call(a,i),a.useSnap=void 0!==i.useSnap&&i.useSnap,a.freehand=void 0!==i.freehand&&i.freehand,a.featureStyle=void 0!==i.featureStyle?i.featureStyle:void 0,a.drawingStyle=void 0!==i.drawingStyle?i.drawingStyle:a.featureStyle,a.drawType=void 0!==i.drawType?i.drawType:"LineString",a.useDrawEndDisplay=void 0===i.useDrawEndDisplay||i.useDrawEndDisplay,i.noneInit||a._init(),ugmp.util.uGisUtil.objectMerge(t,{_this:a,clear:a.clear,getLayer:a.getLayer,getFeatures:a.getFeatures,removeFeature:a.removeFeature})},ugmp.control.uGisDrawFeature.prototype=Object.create(ugmp.control.uGisControlDefault.prototype),ugmp.control.uGisDrawFeature.prototype.constructor=ugmp.control.uGisDrawFeature,ugmp.control.uGisDrawFeature.prototype._init=function(){var e,t,i=this._this||this,a=new ol.source.Vector({wrapX:!1});switch(i.vectorLayer=new ol.layer.Vector({zIndex:9999,source:a,style:i.featureStyle}),i.uGisMap.getMap().addLayer(i.vectorLayer),i.drawType){case"Point":e="Point",t=null;break;case"LineString":e="LineString",t=null;break;case"Polygon":e="Polygon",t=null;break;case"Circle":e="Circle",t=null;break;case"Box":e="Circle",t=ol.interaction.Draw.createBox();break;default:e="Polygon",t=null}i.interaction=new ol.interaction.Draw({type:e,source:a,freehand:i.freehand,style:i.drawingStyle,geometryFunction:t}),i.interaction.setActive(!1),i.useDrawEndDisplay||i.interaction.on("drawend",function(e){setTimeout(function(){i.clear()},1)},this),ugmp.control.uGisControlDefault.prototype._init.call(this),i.useSnap&&(i.snapInteraction=new ol.interaction.Snap({source:a}),i.uGisMap.getMap().addInteraction(i.snapInteraction))},ugmp.control.uGisDrawFeature.prototype.getLayer=function(){return(this._this||this).vectorLayer},ugmp.control.uGisDrawFeature.prototype.getFeatures=function(){return(this._this||this).vectorLayer.getSource().getFeatures()},ugmp.control.uGisDrawFeature.prototype.clear=function(){(this._this||this).vectorLayer.getSource().clear()},ugmp.control.uGisDrawFeature.prototype.removeFeature=function(e){(this._this||this).vectorLayer.getSource().removeFeature(e)},ugmp.control.uGisDrawFeature.prototype.destroy=function(e){var t=this._this||this;ugmp.control.uGisControlDefault.prototype.destroy.call(this),t.uGisMap.getMap().removeInteraction(t.snapInteraction),e&&t.uGisMap.getMap().removeLayer(t.vectorLayer)}}(),function(){"use strict";ugmp.control.uGisMeasureDefault=function(e){var t,i=this,a=null;return this.sketch=null,this.overlays=null,this.destroyed=null,this.helpTooltip=null,this.continueMsg=null,this.measureTooltip=null,this.helpTooltipElement=null,this.measureTooltipElement=null,this.pointerMoveListener=null,this.sketchChangeListener=null,(t=e||{}).noneInit=!0,a=ugmp.control.uGisDrawFeature.call(i,t),ugmp.util.uGisUtil.objectMerge(a,{_this:i,clear:i.clear,destroy:i.destroy,setActive:i.setActive})},ugmp.control.uGisMeasureDefault.prototype=Object.create(ugmp.control.uGisDrawFeature.prototype),ugmp.control.uGisMeasureDefault.prototype.constructor=ugmp.control.uGisMeasureDefault,ugmp.control.uGisMeasureDefault.prototype._init=function(){var e=this._this||this;ugmp.control.uGisDrawFeature.prototype._init.call(this),e.overlays=[],e.destroyed=!1},ugmp.control.uGisMeasureDefault.prototype.createHelpTooltip=function(){var e=this._this||this;e.helpTooltip&&e.uGisMap.getMap().removeOverlay(e.helpTooltip),e.helpTooltipElement=document.createElement("div"),e.helpTooltipElement.className="tooltip hidden",e.helpTooltip=new ol.Overlay({element:e.helpTooltipElement,offset:[25,12],positioning:"center-left"}),e.uGisMap.getMap().addOverlay(e.helpTooltip)},ugmp.control.uGisMeasureDefault.prototype.createMeasureTooltip=function(){var e=this._this||this;e.measureTooltipElement=document.createElement("div"),e.measureTooltipElement.className="tooltip tooltip-measure",e.measureTooltip=new ol.Overlay({element:e.measureTooltipElement,offset:[0,-15],positioning:"bottom-center"}),e.overlays.push(e.measureTooltip),e.uGisMap.getMap().addOverlay(e.measureTooltip)},ugmp.control.uGisMeasureDefault.prototype.setActive=function(e){var i=this._this||this;if(i.destroyed)return!1;if(i.interaction.getActive()===e)return!1;ugmp.control.uGisDrawFeature.prototype.setActive.call(this,e),ol.Observable.unByKey(i.pointerMoveListener),e?(i.createHelpTooltip(),i.createMeasureTooltip(),i.pointerMoveListener=i.uGisMap.getMap().on("pointermove",function(e){if(e.dragging)return;var t="측정 시작할 위치 선택";i.sketch&&(t=i.continueMsg);i.helpTooltipElement.innerHTML=t,i.helpTooltip.setPosition(e.coordinate),i.helpTooltipElement.classList.remove("hidden")})):(i.helpTooltipElement&&i.helpTooltipElement.parentNode.removeChild(i.helpTooltipElement),i.measureTooltipElement&&i.measureTooltipElement.parentNode.removeChild(i.measureTooltipElement))},ugmp.control.uGisMeasureDefault.prototype.clear=function(){var e=this._this||this;for(var t in ugmp.control.uGisDrawFeature.prototype.clear.call(this),e.overlays)e.uGisMap.getMap().removeOverlay(e.overlays[t])},ugmp.control.uGisMeasureDefault.prototype.destroy=function(){var e=this._this||this;e.clear(),e.setActive(!1),e.destroyed=!0,e.uGisMap.getMap().removeOverlay(e.helpTooltip),ol.Observable.unByKey(e.pointerMoveListener),ugmp.control.uGisDrawFeature.prototype.destroy.call(this,!0)},ugmp.control.uGisMeasureDefault.prototype.removeFeature=function(e){this._this;ugmp.control.uGisDrawFeature.prototype.removeFeature.call(this,e)}}(),function(){"use strict";ugmp.control.uGisAreaMeasure=function(e){var t,i,a=this;return(i=e||{}).drawType="Polygon",i.useDrawEndDisplay=!0,i.featureStyle=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:3}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})}),i.drawingStyle=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2})}),t=ugmp.control.uGisMeasureDefault.call(a,i),a._init(),ugmp.util.uGisUtil.objectMerge(t,{_this:a})},ugmp.control.uGisAreaMeasure.prototype=Object.create(ugmp.control.uGisMeasureDefault.prototype),ugmp.control.uGisAreaMeasure.prototype.constructor=ugmp.control.uGisAreaMeasure,ugmp.control.uGisAreaMeasure.prototype._init=function(){var o=this._this||this;ugmp.control.uGisMeasureDefault.prototype._init.call(this),o.continueMsg="면적 측정",o.interaction.on("drawstart",function(e){o.sketch=e.feature;var a=e.coordinate;o.sketchChangeListener=o.sketch.getGeometry().on("change",function(e){var t=e.target,i=o._formatArea(t);a=t.getInteriorPoint().getCoordinates(),o.measureTooltipElement.innerHTML=i,o.measureTooltip.setPosition(a)})},this),o.interaction.on("drawend",function(e){var t=o.measureTooltip;o.measureTooltipElement.className="tooltip tooltip-static",o.measureTooltip.setOffset([0,-7]);var i=document.createElement("a");i.href="#",i.className="tooltip-closer",i.onclick=function(){return o.uGisMap.getMap().removeOverlay(t),o.removeFeature(e.feature),i.blur(),!1},o.measureTooltipElement.appendChild(i),o.sketch=null,o.measureTooltipElement=null,o.createMeasureTooltip(),ol.Observable.unByKey(o.sketchChangeListener)},this)},ugmp.control.uGisAreaMeasure.prototype._formatArea=function(e){var t=this._this||this,i=ol.Sphere.getArea(e,{projection:t.uGisMap.getCRS()});return 1e4<i?Math.round(i/1e6*100)/100+" km<sup>2</sup>":Math.round(100*i)/100+" m<sup>2</sup>"}}(),function(){"use strict";ugmp.control.uGisDragPan=function(e){var t,i,a=this;return this.key_pointerup=null,this.key_pointerdrag=null,i=e||{},t=ugmp.control.uGisControlDefault.call(a,i),a._init(),ugmp.util.uGisUtil.objectMerge(t,{_this:a})},ugmp.control.uGisDragPan.prototype=Object.create(ugmp.control.uGisControlDefault.prototype),ugmp.control.uGisDragPan.prototype.constructor=ugmp.control.uGisDragPan,ugmp.control.uGisDragPan.prototype._init=function(){var e=this._this||this;e.uGisMap.getMap();e.interaction=new ol.interaction.DragPan({kinetic:!1}),e.interaction.set("uGisDragPan",!0),e.interaction.setActive(!1),ugmp.control.uGisControlDefault.prototype._init.call(this)},ugmp.control.uGisDragPan.prototype.setActive=function(e){var t=this._this||this;if(t.interaction.getActive()&&!0===e)return!1;if(ugmp.control.uGisControlDefault.prototype.setActive.call(this,e),e){var i=t.uGisMap.getMap(),a=i.getViewport(),o=i.getView().getCenter();t.key_pointerdrag=i.on("pointerdrag",function(e){var t=e.frameState.viewState.center;o[0]===t[0]&&o[1]===t[1]||(a.classList.remove("cursor-default"),a.classList.add("cursor-closeHand"))}),t.key_pointerup=i.on("pointerup",function(e){a.classList.remove("cursor-closeHand"),a.classList.add("cursor-default")})}else ol.Observable.unByKey(t.key_pointerup),ol.Observable.unByKey(t.key_pointerdrag)}}(),function(){"use strict";ugmp.control.uGisDragZoomIn=function(e){var t,i,a=this;return i=e||{},t=ugmp.control.uGisControlDefault.call(a,i),a._init(),ugmp.util.uGisUtil.objectMerge(t,{_this:a})},ugmp.control.uGisDragZoomIn.prototype=Object.create(ugmp.control.uGisControlDefault.prototype),ugmp.control.uGisDragZoomIn.prototype.constructor=ugmp.control.uGisDragZoomIn,ugmp.control.uGisDragZoomIn.prototype._init=function(){var e=this._this||this;e.interaction=new ol.interaction.DragZoom({condition:ol.events.condition.always,duration:0,out:!1}),e.interaction.setActive(!1),ugmp.control.uGisControlDefault.prototype._init.call(this)}}(),function(){"use strict";ugmp.control.uGisDragZoomOut=function(e){var t,i,a=this;return i=e||{},t=ugmp.control.uGisControlDefault.call(a,i),a._init(),ugmp.util.uGisUtil.objectMerge(t,{_this:a})},ugmp.control.uGisDragZoomOut.prototype=Object.create(ugmp.control.uGisControlDefault.prototype),ugmp.control.uGisDragZoomOut.prototype.constructor=ugmp.control.uGisDragZoomOut,ugmp.control.uGisDragZoomOut.prototype._init=function(){var e=this._this||this;e.interaction=new ol.interaction.DragZoom({condition:ol.events.condition.always,duration:0,out:!0}),e.interaction.setActive(!1),ugmp.control.uGisControlDefault.prototype._init.call(this)}}(),function(){"use strict";ugmp.control.uGisLengthMeasure=function(e){var t,i,a=this;return(i=e||{}).drawType="LineString",i.useDrawEndDisplay=!0,i.featureStyle=new ol.style.Style({stroke:new ol.style.Stroke({color:"#ffcc33",width:3}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})}),i.drawingStyle=new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2})}),t=ugmp.control.uGisMeasureDefault.call(a,i),a._init(),ugmp.util.uGisUtil.objectMerge(t,{_this:a})},ugmp.control.uGisLengthMeasure.prototype=Object.create(ugmp.control.uGisMeasureDefault.prototype),ugmp.control.uGisLengthMeasure.prototype.constructor=ugmp.control.uGisLengthMeasure,ugmp.control.uGisLengthMeasure.prototype._init=function(){var o=this._this||this;ugmp.control.uGisMeasureDefault.prototype._init.call(this),o.continueMsg="길이 측정",o.interaction.on("drawstart",function(e){o.sketch=e.feature;var a=e.coordinate;o.sketchChangeListener=o.sketch.getGeometry().on("change",function(e){var t=e.target,i=o._formatLength(t);a=t.getLastCoordinate(),o.measureTooltipElement.innerHTML=i,o.measureTooltip.setPosition(a)})},this),o.interaction.on("drawend",function(e){var t=o.measureTooltip;o.measureTooltipElement.className="tooltip tooltip-static",o.measureTooltip.setOffset([0,-7]);var i=document.createElement("a");i.href="#",i.className="tooltip-closer",i.onclick=function(){return o.uGisMap.getMap().removeOverlay(t),o.removeFeature(e.feature),i.blur(),!1},o.measureTooltipElement.appendChild(i),o.sketch=null,o.measureTooltipElement=null,o.createMeasureTooltip(),ol.Observable.unByKey(o.sketchChangeListener)},this)},ugmp.control.uGisLengthMeasure.prototype._formatLength=function(e){var t=this._this||this,i=ol.Sphere.getLength(e,{projection:t.uGisMap.getCRS()});return 100<i?Math.round(i/1e3*100)/100+" km":Math.round(100*i)/100+" m"}}(),function(){"use strict";ugmp.control.uGisMapClick=function(e){var t,i,a=this;return i=e||{},t=ugmp.control.uGisControlDefault.call(a,i),a._init(),ugmp.util.uGisUtil.objectMerge(t,{_this:a})},ugmp.control.uGisMapClick.prototype=Object.create(ugmp.control.uGisControlDefault.prototype),ugmp.control.uGisMapClick.prototype.constructor=ugmp.control.uGisMapClick,ugmp.control.uGisMapClick.prototype._init=function(){var i=this._this||this;i.interaction=new ol.interaction.Interaction({handleEvent:function(e){var t=!1;e.originalEvent;if(e.type==ol.MapBrowserEventType.SINGLECLICK){e.map;e.preventDefault(),t=!0,i.interaction.dispatchEvent({type:"singleClick",coordinate:e.coordinate})}return!t}}),i.interaction.setActive(!1),ugmp.control.uGisControlDefault.prototype._init.call(this)}}(),function(){"use strict";ugmp.manager.uGisControlManager=function(t){var i=this;return this.uGisMap=null,this.activeControl=null,this.uGisContrlObjects=null,function(){var e=t||{};if(i.uGisContrlObjects={},i.uGisMap=void 0!==e.uGisMap?e.uGisMap:void 0,!i.uGisMap)return ugmp.uGisConfig.alert_Error("uGisMap undefined");i._init(e.controls)}(),{_this:i,get:i.get,add:i.add}},ugmp.manager.uGisControlManager.prototype._init=function(e){var t=this._this||this;if(Array.isArray(e))for(var i in e)t.add(e[i])},ugmp.manager.uGisControlManager.prototype.add=function(t){var i=this._this||this;if(!(t._this instanceof ugmp.control.uGisControlDefault))return!1;t.getActive()&&(i.activeControl=t),t.setActive=function(e){if(t.getInteraction().getActive()&&!0===e)return!1;e&&(i.activeControl&&i.activeControl.setActive(!1),i.activeControl=t),t._this.setActive(e)},i.uGisContrlObjects[t.getControlKey()]=t},ugmp.manager.uGisControlManager.prototype.get=function(e){return(this._this||this).uGisContrlObjects[e]}}(),function(){"use strict";ugmp.manager.uGisLayerManager=function(t){var i=this;return this.uGisMap=null,this.useMinMaxZoom=null,this.uGisLayerNTocObjects=null,function(){var e=t||{};if(i.uGisMap=void 0!==e.uGisMap?e.uGisMap:void 0,i.useMinMaxZoom=void 0===e.useMinMaxZoom||e.useMinMaxZoom,i.uGisLayerNTocObjects={},!i.uGisMap)return ugmp.uGisConfig.alert_Error("uGisMap undefined");i.useMinMaxZoom&&i._activeMinMaxZoom()}(),{_this:i,get:i.get,add:i.add,getAll:i.getAll,remove:i.remove,getUgisMap:i.getUgisMap,scaleVisibleRefresh:i._scaleVisibleRefresh}},ugmp.manager.uGisLayerManager.prototype._activeMinMaxZoom=function(){var a=this._this||this,o=null,r=null;function t(e){var i=function(e){var t=e.map.getView().getZoom();o!=t&&(o=t,a._scaleVisibleRefresh()),r=a.uGisMap.getMap().once("moveend",function(e){i(e)})};e.once("change:resolution",function(e){a.uGisMap.getMap().once("moveend",function(e){i(e)})})}a.uGisMap.getMap().on("change:view",function(e){ol.Observable.unByKey(r),t(e.target.getView())}),t(a.uGisMap.getMap().getView())},ugmp.manager.uGisLayerManager.prototype.add=function(e){var t,i=this._this||this,a=e||{},o=void 0!==a.uGisLayer?a.uGisLayer:void 0,r=void 0!==a.uGisToc?a.uGisToc:void 0,n=o.getLayerKey();i.useMinMaxZoom&&(t=o.getOlLayer().on("change:zoom",function(e){var t=i.uGisMap.getMap().getView();o.getMinZoom()<=t.getZoom()&&t.getZoom()<=o.getMaxZoom()?o.setScaleVisible(!0):o.setScaleVisible(!1)})),i.uGisLayerNTocObjects[n]={zoomChangeListenerKey:t,uGisLayer:o,uGisToc:r},i._scaleVisibleRefresh()},ugmp.manager.uGisLayerManager.prototype.get=function(e){return(this._this||this).uGisLayerNTocObjects[e]},ugmp.manager.uGisLayerManager.prototype.getAll=function(e){var t=this._this||this,i=[];for(var a in t.uGisLayerNTocObjects)t.uGisLayerNTocObjects.hasOwnProperty(a)&&(e?i.push(t.uGisLayerNTocObjects[a]):i.push(t.uGisLayerNTocObjects[a].uGisLayer));return i},ugmp.manager.uGisLayerManager.prototype.remove=function(e){var t=this._this||this,i=t.uGisLayerNTocObjects[e];t.uGisMap.removeLayer(e),i.uGisToc&&i.uGisToc.remove(),i.zoomChangeListenerKey&&ol.Observable.unByKey(i.zoomChangeListenerKey),delete t.uGisLayerNTocObjects[e]},ugmp.manager.uGisLayerManager.prototype.getUgisMap=function(){return(this._this||this).uGisMap},ugmp.manager.uGisLayerManager.prototype._scaleVisibleRefresh=function(){var e=this._this||this,t=e.uGisMap.getMap().getView();for(var i in e.uGisLayerNTocObjects)if(e.uGisLayerNTocObjects.hasOwnProperty(i)){var a=e.uGisLayerNTocObjects[i].uGisLayer;a.getMinZoom()<=t.getZoom()&&t.getZoom()<=a.getMaxZoom()?a.setScaleVisible(!0):a.setScaleVisible(!1)}}}();
//# sourceMappingURL=uGisMapPlatFormScript.min.js.map